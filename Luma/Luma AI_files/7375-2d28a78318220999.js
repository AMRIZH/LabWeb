(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7375],{73494:function(){},19459:function(o,C,M){"use strict";M.d(C,{CI:function(){return _},F8:function(){return T},G$:function(){return P},Mn:function(){return V},V5:function(){return S},WA:function(){return I},WN:function(){return D},hu:function(){return F},kz:function(){return E},me:function(){return R},sk:function(){return L}});let _=async(o,C)=>{try{await fetch("".concat("https://webapp.engineeringlumalabs.com","/api/v3/creations/like?uuid=").concat(o,"&add=").concat(C?"true":"false"),{method:"POST"}),localStorage.setItem("LUMA_GENIE_".concat(o),"true")}catch(o){console.error("Error ".concat(C?"liking":"disliking"," creation: ").concat(o))}},S=o=>{var C;return"true"===(null!==(C=localStorage.getItem("LUMA_GENIE_".concat(o)))&&void 0!==C?C:"false")},E=(o,C)=>{var M,_,S;return null!==(S=null===(_=null==o?void 0:o.output)||void 0===_?void 0:null===(M=_.find(o=>{var M;return null==o?void 0:null===(M=o.file_url)||void 0===M?void 0:M.endsWith("."+C)}))||void 0===M?void 0:M.file_url)&&void 0!==S?S:void 0},P=o=>{var C,M;return null!==(M=null==o?void 0:null===(C=o.input)||void 0===C?void 0:C.text)&&void 0!==M?M:void 0},D=o=>{var C,M;return null!==(M=null==o?void 0:null===(C=o.username)||void 0===C?void 0:C.replace("_discord",""))&&void 0!==M?M:void 0},L=async o=>{await fetch("".concat("https://webapp.engineeringlumalabs.com","/api/v3/creations/view?uuid=").concat(o),{method:"POST"})},I=async o=>{await fetch("".concat("https://webapp.engineeringlumalabs.com","/api/v3/creations/download?uuid=").concat(o),{method:"POST"})},T=async o=>{await fetch("".concat("https://webapp.engineeringlumalabs.com","/api/v3/creations/share?uuid=").concat(o),{method:"POST"})},R=async o=>{let C=await fetch("".concat("https://webapp.engineeringlumalabs.com","/api/v3/creations/uuid/").concat(o));return(await C.json()).response},V=o=>{let C=parseInt(o.replace("#",""),16);return"#"+((Math.round(.8*(C>>16&255))<<16)+(Math.round(.8*(C>>8&255))<<8)+Math.round(.8*(255&C))).toString(16).padStart(6,"0")},F=[{title:".fbx",config:{export_fbx:!0}},{title:".obj",config:{export_obj:!0}},{title:".glb",config:{}},{title:".usdz",config:{export_usdz:!0}},{title:".blend",config:{export_blend:!0}},{title:".stl",config:{export_stl:!0}}]},76464:function(o,C,M){"use strict";var _=M(5833),S=M(93369),E=M(12499);let P=o=>{let{children:C,className:M,style:P,show:D=!0,exitZeroDur:L=!1,...I}=o;return(0,_.jsx)(S.M,{initial:!1,exitBeforeEnter:!1,children:D&&(0,_.jsx)(E.E.div,{...I,className:M,style:P,initial:{scale:0,opacity:0},animate:{scale:1,opacity:1,transition:{duration:.25}},exit:{scale:0,opacity:0,transition:{duration:L?0:.25}},children:C})})};C.Z=P},20117:function(o,C,M){"use strict";var _=M(5833),S=M(53961),E=M(76961),P=M(56531),D=M(38386);let L=()=>{let o=()=>{let o=(0,P.jl)();(0,D.Cv)("Checking if logged in:",o),E.Mz.loggedIn=o};return(0,S.useEffect)(()=>{o()}),(0,S.useEffect)(()=>(window.addEventListener("focus",o),window.addEventListener("blur",o),document.addEventListener("visibilitychange",o),()=>{window.removeEventListener("focus",o),window.removeEventListener("blur",o),document.removeEventListener("visibilitychange",o)}),[]),(0,_.jsx)(_.Fragment,{})};C.Z=L},35770:function(o,C,M){"use strict";M(5833),M(57224)},56764:function(o,C,M){"use strict";M.d(C,{N:function(){return D}});var _=M(9781),S=M(39405),E=M(30125),P=M(9449);class D extends _.PerspectiveCamera{get focalLength(){return this.getFocalLength()}set focalLength(o){this.setFocalLength(o)}updateCartesianFromOrbit(){(0,S.Q6)(this,this.up,this)}updateOrbitFromCartesian(){(0,S.Zy)(this,this.up,this)}updateMatrix(){this.useOrbitTransform?this.updateCartesianFromOrbit():this.updateOrbitFromCartesian(),super.updateMatrix()}clone(o){let C=super.clone(o);return C.copy(this),C}setFromKeyframe(o){let C=!(arguments.length>1)||void 0===arguments[1]||arguments[1],M={azimuth:o.azimuth,elevation:o.elevation,radius:o.radius,lookAtRelativeQuaternion:o.lookAtRelativeQuaternion,focalLength:o.focalLength,position:o.position,quaternion:o.quaternion,target:o.target,smoothness:o.smoothness,keyframeType:o.keyframeType};this.position.copy(M.position),this.quaternion.copy(M.quaternion),this.target.copy(M.target),this.azimuth=M.azimuth,this.elevation=M.elevation,this.radius=M.radius,this.lookAtRelativeQuaternion.copy(M.lookAtRelativeQuaternion),C&&(this.focalLength=M.focalLength),this.animator.removeAll()}copy(o,C){return super.copy(o,C),this.aspect=o.aspect,o instanceof D&&(this.useOrbitTransform=o.useOrbitTransform,this.target.copy(o.target),this.azimuth=o.azimuth,this.elevation=o.elevation,this.radius=o.radius,this.lookAtRelativeQuaternion.copy(o.lookAtRelativeQuaternion)),this.animator.removeAll(),this.updateMatrix(),this}isEqual(o){return this.useOrbitTransform===o.useOrbitTransform&&this.fov===o.fov&&(this.useOrbitTransform?this.target.equals(o.target)&&this.azimuth===o.azimuth&&this.elevation===o.elevation&&this.radius===o.radius&&this.lookAtRelativeQuaternion.equals(o.lookAtRelativeQuaternion):this.position.equals(o.position)&&this.quaternion.equals(o.quaternion))}animationTick(){this.animator.tick()}animateTo(o,C){let M=null!=C?C>0?E.A.Exponential(C):null:this.springStyle,_=this.animator;_.springTo(this,"position",o.position,M),_.springTo(this,"target",o.target,M),_.springTo(this,"azimuth",o.azimuth,M),_.springTo(this,"elevation",o.elevation,M),_.springTo(this,"radius",o.radius,M),_.springTo(this,"fov",o.fov,M),_.springTo(this,"quaternion",o.quaternion,M,P.h.YawPitchRoll),_.springTo(this,"lookAtRelativeQuaternion",o.lookAtRelativeQuaternion,M,P.h.YawPitchRoll),this.useOrbitTransform=o.useOrbitTransform}constructor(o,C,M,S){super(o,C,M,S),this.springStyle=E.A.Exponential(.2),this.animator=new P.I,this.useOrbitTransform=!1,this.target=new _.Vector3,this.azimuth=0,this.elevation=0,this.radius=1,this.lookAtRelativeQuaternion=new _.Quaternion,this.animator.onAfterStep.addListener(o=>{this.updateMatrix()})}}},13485:function(o,C,M){"use strict";let _,S,E;M.r(C),M.d(C,{Editor:function(){return n6},SLFEditMode:function(){return O},default:function(){return n7}});var P,D,L,I,T,R,V,F,O,N=M(5833),H=M(53961),U=M(9781),G=M(78654),W=M(68457),K=M(9145),X=M(84244),Q=M(79868),Z=M(91669);class Y extends U.Loader{load(o,C,M,_){let S=this,E=""===S.path?U.LoaderUtils.extractUrlBase(o):S.path,P=new U.FileLoader(this.manager);P.setPath(S.path),P.setResponseType("arraybuffer"),P.setRequestHeader(S.requestHeader),P.setWithCredentials(S.withCredentials),P.load(o,function(M){try{C(S.parse(M,E))}catch(C){_?_(C):console.error(C),S.manager.itemError(o)}},M,_)}parse(o,C){if(eo(o))_=new er().parse(o);else{let C=ex(o);if(!es(C))throw Error("THREE.FBXLoader: Unknown format.");if(7e3>eu(C))throw Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+eu(C));_=new et().parse(C)}return{sceneGraph:new J(new U.TextureLoader(this.manager).setPath(this.resourcePath||C).setCrossOrigin(this.crossOrigin),this.manager).parse(_),fbxTree:_}}constructor(o){super(o)}}class J{parse(){S=this.parseConnections();let o=this.parseImages(),C=this.parseTextures(o),M=this.parseMaterials(C),_=this.parseDeformers(),P=new $().parse(_);return this.parseScene(_,P,M),E}parseConnections(){let o=new Map;return"Connections"in _&&_.Connections.connections.forEach(function(C){let M=C[0],_=C[1],S=C[2];o.has(M)||o.set(M,{parents:[],children:[]});let E={ID:_,relationship:S};o.get(M).parents.push(E),o.has(_)||o.set(_,{parents:[],children:[]});let P={ID:M,relationship:S};o.get(_).children.push(P)}),o}parseImages(){let o={},C={};if("Video"in _.Objects){let M=_.Objects.Video;for(let _ in M){let S=M[_];if(o[parseInt(_)]=S.RelativeFilename||S.Filename,"Content"in S){let o=S.Content instanceof ArrayBuffer&&S.Content.byteLength>0,E="string"==typeof S.Content&&""!==S.Content;if(o||E){let o=this.parseImage(M[_]);C[S.RelativeFilename||S.Filename]=o}}}}for(let M in o){let _=o[M];void 0!==C[_]?o[M]=C[_]:o[M]=o[M].split("\\").pop()}return o}parseImage(o){let C;let M=o.Content,_=o.RelativeFilename||o.Filename,S=_.slice(_.lastIndexOf(".")+1).toLowerCase();switch(S){case"bmp":C="image/bmp";break;case"jpg":case"jpeg":C="image/jpeg";break;case"png":C="image/png";break;case"tif":C="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",_),C="image/tga";break;default:console.warn('FBXLoader: Image type "'+S+'" is not supported.');return}if("string"==typeof M)return"data:"+C+";base64,"+M;{let o=new Uint8Array(M);return window.URL.createObjectURL(new Blob([o],{type:C}))}}parseTextures(o){let C=new Map;if("Texture"in _.Objects){let M=_.Objects.Texture;for(let _ in M){let S=this.parseTexture(M[_],o);C.set(parseInt(_),S)}}return C}parseTexture(o,C){let M=this.loadTexture(o,C);M.ID=o.id,M.name=o.attrName;let _=o.WrapModeU,S=o.WrapModeV,E=void 0!==_?_.value:0,P=void 0!==S?S.value:0;if(M.wrapS=0===E?U.RepeatWrapping:U.ClampToEdgeWrapping,M.wrapT=0===P?U.RepeatWrapping:U.ClampToEdgeWrapping,"Scaling"in o){let C=o.Scaling.value;M.repeat.x=C[0],M.repeat.y=C[1]}if("Translation"in o){let C=o.Translation.value;M.offset.x=C[0],M.offset.y=C[1]}return M}loadTexture(o,C){let M,_;let E=this.textureLoader.path,P=S.get(o.id).children;void 0!==P&&P.length>0&&void 0!==C[P[0].ID]&&(0===(M=C[P[0].ID]).indexOf("blob:")||0===M.indexOf("data:"))&&this.textureLoader.setPath(void 0);let D=o.FileName.slice(-3).toLowerCase();if("tga"===D){let C=this.manager.getHandler(".tga");null===C?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",o.RelativeFilename),_=new U.Texture):(C.setPath(this.textureLoader.path),_=C.load(M))}else"psd"===D?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",o.RelativeFilename),_=new U.Texture):_=this.textureLoader.load(M);return this.textureLoader.setPath(E),_}parseMaterials(o){let C=new Map;if("Material"in _.Objects){let M=_.Objects.Material;for(let _ in M){let S=this.parseMaterial(M[_],o);null!==S&&C.set(parseInt(_),S)}}return C}parseMaterial(o,C){let M;let _=o.id,E=o.attrName,P=o.ShadingModel;if("object"==typeof P&&(P=P.value),!S.has(_))return null;let D=this.parseParameters(o,C,_);switch(P.toLowerCase()){case"phong":M=new U.MeshPhongMaterial;break;case"lambert":M=new U.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',P),M=new U.MeshPhongMaterial}return M.setValues(D),M.name=E,M}parseParameters(o,C,M){let _={};o.BumpFactor&&(_.bumpScale=o.BumpFactor.value),o.Diffuse?_.color=new U.Color().fromArray(o.Diffuse.value):o.DiffuseColor&&("Color"===o.DiffuseColor.type||"ColorRGB"===o.DiffuseColor.type)&&(_.color=new U.Color().fromArray(o.DiffuseColor.value)),o.DisplacementFactor&&(_.displacementScale=o.DisplacementFactor.value),o.Emissive?_.emissive=new U.Color().fromArray(o.Emissive.value):o.EmissiveColor&&("Color"===o.EmissiveColor.type||"ColorRGB"===o.EmissiveColor.type)&&(_.emissive=new U.Color().fromArray(o.EmissiveColor.value)),o.EmissiveFactor&&(_.emissiveIntensity=parseFloat(o.EmissiveFactor.value)),o.Opacity&&(_.opacity=parseFloat(o.Opacity.value)),_.opacity<1&&(_.transparent=!0),o.ReflectionFactor&&(_.reflectivity=o.ReflectionFactor.value),o.Shininess&&(_.shininess=o.Shininess.value),o.Specular?_.specular=new U.Color().fromArray(o.Specular.value):o.SpecularColor&&"Color"===o.SpecularColor.type&&(_.specular=new U.Color().fromArray(o.SpecularColor.value));let E=this;return S.get(M).children.forEach(function(o){let M=o.relationship;switch(M){case"Bump":_.bumpMap=E.getTexture(C,o.ID);break;case"Maya|TEX_ao_map":_.aoMap=E.getTexture(C,o.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":_.map=E.getTexture(C,o.ID),void 0!==_.map&&(_.map.encoding=U.sRGBEncoding);break;case"DisplacementColor":_.displacementMap=E.getTexture(C,o.ID);break;case"EmissiveColor":_.emissiveMap=E.getTexture(C,o.ID),void 0!==_.emissiveMap&&(_.emissiveMap.encoding=U.sRGBEncoding);break;case"NormalMap":case"Maya|TEX_normal_map":_.normalMap=E.getTexture(C,o.ID);break;case"ReflectionColor":_.envMap=E.getTexture(C,o.ID),void 0!==_.envMap&&(_.envMap.mapping=U.EquirectangularReflectionMapping,_.envMap.encoding=U.sRGBEncoding);break;case"SpecularColor":_.specularMap=E.getTexture(C,o.ID),void 0!==_.specularMap&&(_.specularMap.encoding=U.sRGBEncoding);break;case"TransparentColor":case"TransparencyFactor":_.alphaMap=E.getTexture(C,o.ID),_.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",M)}}),_}getTexture(o,C){return"LayeredTexture"in _.Objects&&C in _.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),C=S.get(C).children[0].ID),o.get(C)}parseDeformers(){let o={},C={};if("Deformer"in _.Objects){let M=_.Objects.Deformer;for(let _ in M){let E=M[_],P=S.get(parseInt(_));if("Skin"===E.attrType){let C=this.parseSkeleton(P,M);C.ID=_,P.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),C.geometryID=P.parents[0].ID,o[_]=C}else if("BlendShape"===E.attrType){let o={id:_};o.rawTargets=this.parseMorphTargets(P,M),o.id=_,P.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),C[_]=o}}}return{skeletons:o,morphTargets:C}}parseSkeleton(o,C){let M=[];return o.children.forEach(function(o){let _=C[o.ID];if("Cluster"!==_.attrType)return;let S={ID:o.ID,indices:[],weights:[],transformLink:new U.Matrix4().fromArray(_.TransformLink.a)};"Indexes"in _&&(S.indices=_.Indexes.a,S.weights=_.Weights.a),M.push(S)}),{rawBones:M,bones:[]}}parseMorphTargets(o,C){let M=[];for(let _=0;_<o.children.length;_++){let E=o.children[_],P=C[E.ID],D={name:P.attrName,initialWeight:P.DeformPercent,id:P.id,fullWeights:P.FullWeights.a};if("BlendShapeChannel"!==P.attrType)return;D.geoID=S.get(parseInt(E.ID)).children.filter(function(o){return void 0===o.relationship})[0].ID,M.push(D)}return M}parseScene(o,C,M){E=new U.Group;let P=this.parseModels(o.skeletons,C,M),D=_.Objects.Model,L=this;P.forEach(function(o){let C=D[o.ID];L.setLookAtProperties(o,C),S.get(o.ID).parents.forEach(function(C){let M=P.get(C.ID);void 0!==M&&M.add(o)}),null===o.parent&&E.add(o)}),this.bindSkeleton(o.skeletons,C,P),this.createAmbientLight(),E.traverse(function(o){if(o.userData.transformData){o.parent&&(o.userData.transformData.parentMatrix=o.parent.matrix,o.userData.transformData.parentMatrixWorld=o.parent.matrixWorld);let C=eg(o.userData.transformData);o.applyMatrix4(C),o.updateWorldMatrix()}});let I=new ee().parse();1===E.children.length&&E.children[0].isGroup&&(E.children[0].animations=I,E=E.children[0]),E.animations=I}parseModels(o,C,M){let E=new Map,P=_.Objects.Model;for(let _ in P){let D=parseInt(_),L=P[_],I=S.get(D),T=this.buildSkeleton(I,o,D,L.attrName);if(!T){switch(L.attrType){case"Camera":T=this.createCamera(I);break;case"Light":T=this.createLight(I);break;case"Mesh":T=this.createMesh(I,C,M);break;case"NurbsCurve":T=this.createCurve(I,C);break;case"LimbNode":case"Root":T=new U.Bone;break;default:T=new U.Group}T.name=L.attrName?U.PropertyBinding.sanitizeNodeName(L.attrName):"",T.ID=D}this.getTransformData(T,L),E.set(D,T)}return E}buildSkeleton(o,C,M,_){let S=null;return o.parents.forEach(function(o){for(let E in C){let P=C[E];P.rawBones.forEach(function(C,E){if(C.ID===o.ID){let o=S;(S=new U.Bone).matrixWorld.copy(C.transformLink),S.name=_?U.PropertyBinding.sanitizeNodeName(_):"",S.ID=M,P.bones[E]=S,null!==o&&S.add(o)}})}}),S}createCamera(o){let C,M;if(o.children.forEach(function(o){let C=_.Objects.NodeAttribute[o.ID];void 0!==C&&(M=C)}),void 0===M)C=new U.Object3D;else{let o=0;void 0!==M.CameraProjectionType&&1===M.CameraProjectionType.value&&(o=1);let _=1;void 0!==M.NearPlane&&(_=M.NearPlane.value/1e3);let S=1e3;void 0!==M.FarPlane&&(S=M.FarPlane.value/1e3);let E=window.innerWidth,P=window.innerHeight;void 0!==M.AspectWidth&&void 0!==M.AspectHeight&&(E=M.AspectWidth.value,P=M.AspectHeight.value);let D=E/P,L=45;void 0!==M.FieldOfView&&(L=M.FieldOfView.value);let I=M.FocalLength?M.FocalLength.value:null;switch(o){case 0:C=new U.PerspectiveCamera(L,D,_,S),null!==I&&C.setFocalLength(I);break;case 1:C=new U.OrthographicCamera(-E/2,E/2,P/2,-P/2,_,S);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+o+"."),C=new U.Object3D}}return C}createLight(o){let C,M;if(o.children.forEach(function(o){let C=_.Objects.NodeAttribute[o.ID];void 0!==C&&(M=C)}),void 0===M)C=new U.Object3D;else{let o;o=void 0===M.LightType?0:M.LightType.value;let _=16777215;void 0!==M.Color&&(_=new U.Color().fromArray(M.Color.value));let S=void 0===M.Intensity?1:M.Intensity.value/100;void 0!==M.CastLightOnObject&&0===M.CastLightOnObject.value&&(S=0);let E=0;void 0!==M.FarAttenuationEnd&&(E=void 0!==M.EnableFarAttenuation&&0===M.EnableFarAttenuation.value?0:M.FarAttenuationEnd.value);let P=1;switch(o){case 0:C=new U.PointLight(_,S,E,P);break;case 1:C=new U.DirectionalLight(_,S);break;case 2:let D=Math.PI/3;void 0!==M.InnerAngle&&(D=U.MathUtils.degToRad(M.InnerAngle.value));let L=0;void 0!==M.OuterAngle&&(L=Math.max(L=U.MathUtils.degToRad(M.OuterAngle.value),1)),C=new U.SpotLight(_,S,E,D,L,P);break;default:console.warn("THREE.FBXLoader: Unknown light type "+M.LightType.value+", defaulting to a PointLight."),C=new U.PointLight(_,S)}void 0!==M.CastShadows&&1===M.CastShadows.value&&(C.castShadow=!0)}return C}createMesh(o,C,M){let _;let S=null,E=null,P=[];return o.children.forEach(function(o){C.has(o.ID)&&(S=C.get(o.ID)),M.has(o.ID)&&P.push(M.get(o.ID))}),P.length>1?E=P:P.length>0?E=P[0]:(E=new U.MeshPhongMaterial({color:13421772}),P.push(E)),"color"in S.attributes&&P.forEach(function(o){o.vertexColors=!0}),S.FBX_Deformer?(_=new U.SkinnedMesh(S,E)).normalizeSkinWeights():_=new U.Mesh(S,E),_}createCurve(o,C){let M=o.children.reduce(function(o,M){return C.has(M.ID)&&(o=C.get(M.ID)),o},null),_=new U.LineBasicMaterial({color:3342591,linewidth:1});return new U.Line(M,_)}getTransformData(o,C){let M={};"InheritType"in C&&(M.inheritType=parseInt(C.InheritType.value)),"RotationOrder"in C?M.eulerOrder=ev(C.RotationOrder.value):M.eulerOrder="ZYX","Lcl_Translation"in C&&(M.translation=C.Lcl_Translation.value),"PreRotation"in C&&(M.preRotation=C.PreRotation.value),"Lcl_Rotation"in C&&(M.rotation=C.Lcl_Rotation.value),"PostRotation"in C&&(M.postRotation=C.PostRotation.value),"Lcl_Scaling"in C&&(M.scale=C.Lcl_Scaling.value),"ScalingOffset"in C&&(M.scalingOffset=C.ScalingOffset.value),"ScalingPivot"in C&&(M.scalingPivot=C.ScalingPivot.value),"RotationOffset"in C&&(M.rotationOffset=C.RotationOffset.value),"RotationPivot"in C&&(M.rotationPivot=C.RotationPivot.value),o.userData.transformData=M}setLookAtProperties(o,C){"LookAtProperty"in C&&S.get(o.ID).children.forEach(function(C){if("LookAtProperty"===C.relationship){let M=_.Objects.Model[C.ID];if("Lcl_Translation"in M){let C=M.Lcl_Translation.value;void 0!==o.target?(o.target.position.fromArray(C),E.add(o.target)):o.lookAt(new U.Vector3().fromArray(C))}}})}bindSkeleton(o,C,M){let _=this.parsePoseNodes();for(let E in o){let P=o[E];S.get(parseInt(P.ID)).parents.forEach(function(o){if(C.has(o.ID)){let C=o.ID;S.get(C).parents.forEach(function(o){M.has(o.ID)&&M.get(o.ID).bind(new U.Skeleton(P.bones),_[o.ID])})}})}}parsePoseNodes(){let o={};if("Pose"in _.Objects){let C=_.Objects.Pose;for(let M in C)if("BindPose"===C[M].attrType&&C[M].NbPoseNodes>0){let _=C[M].PoseNode;Array.isArray(_)?_.forEach(function(C){o[C.Node]=new U.Matrix4().fromArray(C.Matrix.a)}):o[_.Node]=new U.Matrix4().fromArray(_.Matrix.a)}}return o}createAmbientLight(){if("GlobalSettings"in _&&"AmbientColor"in _.GlobalSettings){let o=_.GlobalSettings.AmbientColor.value,C=o[0],M=o[1],S=o[2];if(0!==C||0!==M||0!==S){let o=new U.Color(C,M,S);E.add(new U.AmbientLight(o,1))}}}constructor(o,C){this.textureLoader=o,this.manager=C}}class ${parse(o){let C=new Map;if("Geometry"in _.Objects){let M=_.Objects.Geometry;for(let _ in M){let E=S.get(parseInt(_)),P=this.parseGeometry(E,M[_],o);C.set(parseInt(_),P)}}return!0===this.negativeMaterialIndices&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),C}parseGeometry(o,C,M){switch(C.attrType){case"Mesh":return this.parseMeshGeometry(o,C,M);case"NurbsCurve":return this.parseNurbsGeometry(C)}}parseMeshGeometry(o,C,M){let S=M.skeletons,E=[],P=o.parents.map(function(o){return _.Objects.Model[o.ID]});if(0===P.length)return;let D=o.children.reduce(function(o,C){return void 0!==S[C.ID]&&(o=S[C.ID]),o},null);o.children.forEach(function(o){void 0!==M.morphTargets[o.ID]&&E.push(M.morphTargets[o.ID])});let L=P[0],I={};"RotationOrder"in L&&(I.eulerOrder=ev(L.RotationOrder.value)),"InheritType"in L&&(I.inheritType=parseInt(L.InheritType.value)),"GeometricTranslation"in L&&(I.translation=L.GeometricTranslation.value),"GeometricRotation"in L&&(I.rotation=L.GeometricRotation.value),"GeometricScaling"in L&&(I.scale=L.GeometricScaling.value);let T=eg(I);return this.genGeometry(C,D,E,T)}genGeometry(o,C,M,_){let S=new U.BufferGeometry;o.attrName&&(S.name=o.attrName);let E=this.parseGeoNode(o,C),P=this.genBuffers(E),D=new U.Float32BufferAttribute(P.vertex,3);if(D.applyMatrix4(_),S.setAttribute("position",D),P.colors.length>0&&S.setAttribute("color",new U.Float32BufferAttribute(P.colors,3)),C&&(S.setAttribute("skinIndex",new U.Uint16BufferAttribute(P.weightsIndices,4)),S.setAttribute("skinWeight",new U.Float32BufferAttribute(P.vertexWeights,4)),S.FBX_Deformer=C),P.normal.length>0){let o=new U.Matrix3().getNormalMatrix(_),C=new U.Float32BufferAttribute(P.normal,3);C.applyNormalMatrix(o),S.setAttribute("normal",C)}if(P.uvs.forEach(function(o,C){let M="uv"+(C+1).toString();0===C&&(M="uv"),S.setAttribute(M,new U.Float32BufferAttribute(P.uvs[C],2))}),E.material&&"AllSame"!==E.material.mappingType){let o=P.materialIndex[0],C=0;if(P.materialIndex.forEach(function(M,_){M!==o&&(S.addGroup(C,_-C,o),o=M,C=_)}),S.groups.length>0){let C=S.groups[S.groups.length-1],M=C.start+C.count;M!==P.materialIndex.length&&S.addGroup(M,P.materialIndex.length-M,o)}0===S.groups.length&&S.addGroup(0,P.materialIndex.length,P.materialIndex[0])}return this.addMorphTargets(S,o,M,_),S}parseGeoNode(o,C){let M={};if(M.vertexPositions=void 0!==o.Vertices?o.Vertices.a:[],M.vertexIndices=void 0!==o.PolygonVertexIndex?o.PolygonVertexIndex.a:[],o.LayerElementColor&&(M.color=this.parseVertexColors(o.LayerElementColor[0])),o.LayerElementMaterial&&(M.material=this.parseMaterialIndices(o.LayerElementMaterial[0])),o.LayerElementNormal&&(M.normal=this.parseNormals(o.LayerElementNormal[0])),o.LayerElementUV){M.uv=[];let C=0;for(;o.LayerElementUV[C];)o.LayerElementUV[C].UV&&M.uv.push(this.parseUVs(o.LayerElementUV[C])),C++}return M.weightTable={},null!==C&&(M.skeleton=C,C.rawBones.forEach(function(o,C){o.indices.forEach(function(_,S){void 0===M.weightTable[_]&&(M.weightTable[_]=[]),M.weightTable[_].push({id:C,weight:o.weights[S]})})})),M}genBuffers(o){let C={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},M=0,_=0,S=!1,E=[],P=[],D=[],L=[],I=[],T=[],R=this;return o.vertexIndices.forEach(function(V,F){let O;let N=!1;V<0&&(V^=-1,N=!0);let H=[],U=[];if(E.push(3*V,3*V+1,3*V+2),o.color){let C=eh(F,M,V,o.color);D.push(C[0],C[1],C[2])}if(o.skeleton){if(void 0!==o.weightTable[V]&&o.weightTable[V].forEach(function(o){U.push(o.weight),H.push(o.id)}),U.length>4){S||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),S=!0);let o=[0,0,0,0],C=[0,0,0,0];U.forEach(function(M,_){let S=M,E=H[_];C.forEach(function(C,M,_){if(S>C){_[M]=S,S=C;let P=o[M];o[M]=E,E=P}})}),H=o,U=C}for(;U.length<4;)U.push(0),H.push(0);for(let o=0;o<4;++o)I.push(U[o]),T.push(H[o])}if(o.normal){let C=eh(F,M,V,o.normal);P.push(C[0],C[1],C[2])}o.material&&"AllSame"!==o.material.mappingType&&(O=eh(F,M,V,o.material)[0])<0&&(R.negativeMaterialIndices=!0,O=0),o.uv&&o.uv.forEach(function(o,C){let _=eh(F,M,V,o);void 0===L[C]&&(L[C]=[]),L[C].push(_[0]),L[C].push(_[1])}),_++,N&&(R.genFace(C,o,E,O,P,D,L,I,T,_),M++,_=0,E=[],P=[],D=[],L=[],I=[],T=[])}),C}genFace(o,C,M,_,S,E,P,D,L,I){for(let T=2;T<I;T++)o.vertex.push(C.vertexPositions[M[0]]),o.vertex.push(C.vertexPositions[M[1]]),o.vertex.push(C.vertexPositions[M[2]]),o.vertex.push(C.vertexPositions[M[(T-1)*3]]),o.vertex.push(C.vertexPositions[M[(T-1)*3+1]]),o.vertex.push(C.vertexPositions[M[(T-1)*3+2]]),o.vertex.push(C.vertexPositions[M[3*T]]),o.vertex.push(C.vertexPositions[M[3*T+1]]),o.vertex.push(C.vertexPositions[M[3*T+2]]),C.skeleton&&(o.vertexWeights.push(D[0]),o.vertexWeights.push(D[1]),o.vertexWeights.push(D[2]),o.vertexWeights.push(D[3]),o.vertexWeights.push(D[(T-1)*4]),o.vertexWeights.push(D[(T-1)*4+1]),o.vertexWeights.push(D[(T-1)*4+2]),o.vertexWeights.push(D[(T-1)*4+3]),o.vertexWeights.push(D[4*T]),o.vertexWeights.push(D[4*T+1]),o.vertexWeights.push(D[4*T+2]),o.vertexWeights.push(D[4*T+3]),o.weightsIndices.push(L[0]),o.weightsIndices.push(L[1]),o.weightsIndices.push(L[2]),o.weightsIndices.push(L[3]),o.weightsIndices.push(L[(T-1)*4]),o.weightsIndices.push(L[(T-1)*4+1]),o.weightsIndices.push(L[(T-1)*4+2]),o.weightsIndices.push(L[(T-1)*4+3]),o.weightsIndices.push(L[4*T]),o.weightsIndices.push(L[4*T+1]),o.weightsIndices.push(L[4*T+2]),o.weightsIndices.push(L[4*T+3])),C.color&&(o.colors.push(E[0]),o.colors.push(E[1]),o.colors.push(E[2]),o.colors.push(E[(T-1)*3]),o.colors.push(E[(T-1)*3+1]),o.colors.push(E[(T-1)*3+2]),o.colors.push(E[3*T]),o.colors.push(E[3*T+1]),o.colors.push(E[3*T+2])),C.material&&"AllSame"!==C.material.mappingType&&(o.materialIndex.push(_),o.materialIndex.push(_),o.materialIndex.push(_)),C.normal&&(o.normal.push(S[0]),o.normal.push(S[1]),o.normal.push(S[2]),o.normal.push(S[(T-1)*3]),o.normal.push(S[(T-1)*3+1]),o.normal.push(S[(T-1)*3+2]),o.normal.push(S[3*T]),o.normal.push(S[3*T+1]),o.normal.push(S[3*T+2])),C.uv&&C.uv.forEach(function(C,M){void 0===o.uvs[M]&&(o.uvs[M]=[]),o.uvs[M].push(P[M][0]),o.uvs[M].push(P[M][1]),o.uvs[M].push(P[M][(T-1)*2]),o.uvs[M].push(P[M][(T-1)*2+1]),o.uvs[M].push(P[M][2*T]),o.uvs[M].push(P[M][2*T+1])})}addMorphTargets(o,C,M,S){if(0===M.length)return;o.morphTargetsRelative=!0,o.morphAttributes.position=[];let E=this;M.forEach(function(M){M.rawTargets.forEach(function(M){let P=_.Objects.Geometry[M.geoID];void 0!==P&&E.genMorphGeometry(o,C,P,S,M.name)})})}genMorphGeometry(o,C,M,_,S){let E=void 0!==C.PolygonVertexIndex?C.PolygonVertexIndex.a:[],P=void 0!==M.Vertices?M.Vertices.a:[],D=void 0!==M.Indexes?M.Indexes.a:[],L=3*o.attributes.position.count,I=new Float32Array(L);for(let o=0;o<D.length;o++){let C=3*D[o];I[C]=P[3*o],I[C+1]=P[3*o+1],I[C+2]=P[3*o+2]}let T={vertexIndices:E,vertexPositions:I},R=this.genBuffers(T),V=new U.Float32BufferAttribute(R.vertex,3);V.name=S||M.attrName,V.applyMatrix4(_),o.morphAttributes.position.push(V)}parseNormals(o){let C=o.MappingInformationType,M=o.ReferenceInformationType,_=o.Normals.a,S=[];return"IndexToDirect"===M&&("NormalIndex"in o?S=o.NormalIndex.a:"NormalsIndex"in o&&(S=o.NormalsIndex.a)),{dataSize:3,buffer:_,indices:S,mappingType:C,referenceType:M}}parseUVs(o){let C=o.MappingInformationType,M=o.ReferenceInformationType,_=o.UV.a,S=[];return"IndexToDirect"===M&&(S=o.UVIndex.a),{dataSize:2,buffer:_,indices:S,mappingType:C,referenceType:M}}parseVertexColors(o){let C=o.MappingInformationType,M=o.ReferenceInformationType,_=o.Colors.a,S=[];return"IndexToDirect"===M&&(S=o.ColorIndex.a),{dataSize:4,buffer:_,indices:S,mappingType:C,referenceType:M}}parseMaterialIndices(o){let C=o.MappingInformationType,M=o.ReferenceInformationType;if("NoMappingInformation"===C)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:M};let _=o.Materials.a,S=[];for(let o=0;o<_.length;++o)S.push(o);return{dataSize:1,buffer:_,indices:S,mappingType:C,referenceType:M}}parseNurbsGeometry(o){let C,M;if(void 0===Z.e)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new U.BufferGeometry;let _=parseInt(o.Order);if(isNaN(_))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",o.Order,o.id),new U.BufferGeometry;let S=_-1,E=o.KnotVector.a,P=[],D=o.Points.a;for(let o=0,C=D.length;o<C;o+=4)P.push(new U.Vector4().fromArray(D,o));if("Closed"===o.Form)P.push(P[0]);else if("Periodic"===o.Form){C=S,M=E.length-1-C;for(let o=0;o<S;++o)P.push(P[o])}let L=new Z.e(S,E,P,C,M).getPoints(12*P.length);return new U.BufferGeometry().setFromPoints(L)}constructor(){this.negativeMaterialIndices=!1}}class ee{parse(){let o=[],C=this.parseClips();if(void 0!==C)for(let M in C){let _=C[M],S=this.addClip(_);o.push(S)}return o}parseClips(){if(void 0===_.Objects.AnimationCurve)return;let o=this.parseAnimationCurveNodes();this.parseAnimationCurves(o);let C=this.parseAnimationLayers(o);return this.parseAnimStacks(C)}parseAnimationCurveNodes(){let o=_.Objects.AnimationCurveNode,C=new Map;for(let M in o){let _=o[M];if(null!==_.attrName.match(/S|R|T|DeformPercent|FocalLength/)){let o={id:_.id,attr:_.attrName,curves:{}};C.set(o.id,o)}}return C}parseAnimationCurves(o){let C=_.Objects.AnimationCurve;for(let M in C){let _={id:C[M].id,times:C[M].KeyTime.a.map(ec),values:C[M].KeyValueFloat.a},E=S.get(_.id);if(void 0!==E){let C=E.parents[0].ID,M=E.parents[0].relationship;M.match(/X/)?o.get(C).curves.x=_:M.match(/Y/)?o.get(C).curves.y=_:M.match(/Z/)?o.get(C).curves.z=_:"d|DeformPercent"==M&&o.has(C)?o.get(C).curves.morph=_:"d|FocalLength"==M&&(o.get(C).curves.focalLength=_)}}}parseAnimationLayers(o){let C=_.Objects.AnimationLayer,M=new Map;for(let P in C){let C=[],D=S.get(parseInt(P));void 0!==D&&(D.children.forEach(function(M,P){if(o.has(M.ID)){let D=o.get(M.ID);if(void 0!==D.curves.x||void 0!==D.curves.y||void 0!==D.curves.z){if(void 0===C[P]){let o=S.get(M.ID).parents.filter(function(o){return void 0!==o.relationship})[0].ID;if(void 0!==o){let S=_.Objects.Model[o.toString()];if(void 0===S){console.warn("THREE.FBXLoader: Encountered a unused curve.",M);return}let D={modelName:S.attrName?U.PropertyBinding.sanitizeNodeName(S.attrName):"",ID:S.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};E.traverse(function(o){o.ID===S.id&&(D.transform=o.matrix,o.userData.transformData&&(D.eulerOrder=o.userData.transformData.eulerOrder))}),D.transform||(D.transform=new U.Matrix4),"PreRotation"in S&&(D.preRotation=S.PreRotation.value),"PostRotation"in S&&(D.postRotation=S.PostRotation.value),C[P]=D}}C[P]&&(C[P][D.attr]=D)}else if(void 0!==D.curves.morph){if(void 0===C[P]){let o=S.get(M.ID).parents.filter(function(o){return void 0!==o.relationship})[0].ID,E=S.get(o).parents[0].ID,D=S.get(E).parents[0].ID,L=S.get(D).parents[0].ID,I=_.Objects.Model[L],T={modelName:I.attrName?U.PropertyBinding.sanitizeNodeName(I.attrName):"",morphName:_.Objects.Deformer[o].attrName};C[P]=T}C[P][D.attr]=D}else if(void 0!==D.curves.focalLength){if(void 0===C[P]){let o=S.get(M.ID).parents.filter(function(o){return void 0!==o.relationship})[0].ID,E=S.get(o).parents[0].ID;if(void 0!==o&&void 0!==E){let S=_.Objects.NodeAttribute[o.toString()],D=_.Objects.Model[E.toString()];if(void 0===S||void 0===D){console.warn("THREE.FBXLoader: Encountered a unused curve (focal length)",M);return}let L={modelName:D.attrName?U.PropertyBinding.sanitizeNodeName(D.attrName):"",attributeName:"FocalLength",ID:S.id,value:S.FocalLength.value};C[P]=L}else console.warn("THREE.FBXLoader: Encountered a unused curve (focal length)",M)}C[P]&&(C[P][D.attr]=D)}}}),M.set(parseInt(P),C))}return M}parseAnimStacks(o){let C=_.Objects.AnimationStack,M={};for(let _ in C){let E=S.get(parseInt(_)).children;E.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");let P=o.get(E[0].ID);M[_]={name:C[_].attrName,layer:P}}return M}addClip(o){let C=[],M=this;return o.layer.forEach(function(o){C=C.concat(M.generateTracks(o))}),new U.AnimationClip(o.name,-1,C)}generateTracks(o){let C=[],M=new U.Vector3,_=new U.Quaternion,S=new U.Vector3;if(o.transform&&o.transform.decompose(M,_,S),M=M.toArray(),_=new U.Euler().setFromQuaternion(_,o.eulerOrder).toArray(),S=S.toArray(),void 0!==o.T&&Object.keys(o.T.curves).length>0){let _=this.generateVectorTrack(o.modelName,o.T.curves,M,"position");void 0!==_&&C.push(_)}if(void 0!==o.R&&Object.keys(o.R.curves).length>0){let M=this.generateRotationTrack(o.modelName,o.R.curves,_,o.preRotation,o.postRotation,o.eulerOrder);void 0!==M&&C.push(M)}if(void 0!==o.S&&Object.keys(o.S.curves).length>0){let M=this.generateVectorTrack(o.modelName,o.S.curves,S,"scale");void 0!==M&&C.push(M)}if(void 0!==o.DeformPercent){let M=this.generateMorphTrack(o);void 0!==M&&C.push(M)}if(void 0!==o.FocalLength){let M=this.generateFocalLengthTrack(o);void 0!==M&&C.push(M)}return C}generateVectorTrack(o,C,M,_){let S=this.getTimesForAllAxes(C),E=this.getKeyframeTrackValues(S,C,M);return new U.VectorKeyframeTrack(o+"."+_,S,E)}generateRotationTrack(o,C,M,_,S,E){void 0!==C.x&&(this.interpolateRotations(C.x),C.x.values=C.x.values.map(U.MathUtils.degToRad)),void 0!==C.y&&(this.interpolateRotations(C.y),C.y.values=C.y.values.map(U.MathUtils.degToRad)),void 0!==C.z&&(this.interpolateRotations(C.z),C.z.values=C.z.values.map(U.MathUtils.degToRad));let P=this.getTimesForAllAxes(C),D=this.getKeyframeTrackValues(P,C,M);void 0!==_&&((_=_.map(U.MathUtils.degToRad)).push(E),_=new U.Euler().fromArray(_),_=new U.Quaternion().setFromEuler(_)),void 0!==S&&((S=S.map(U.MathUtils.degToRad)).push(E),S=new U.Euler().fromArray(S),S=new U.Quaternion().setFromEuler(S).invert());let L=new U.Quaternion,I=new U.Euler,T=[];for(let o=0;o<D.length;o+=3)I.set(D[o],D[o+1],D[o+2],E),L.setFromEuler(I),void 0!==_&&L.premultiply(_),void 0!==S&&L.multiply(S),L.toArray(T,o/3*4);return new U.QuaternionKeyframeTrack(o+".quaternion",P,T)}generateMorphTrack(o){let C=o.DeformPercent.curves.morph,M=C.values.map(function(o){return o/100}),_=E.getObjectByName(o.modelName).morphTargetDictionary[o.morphName];return new U.NumberKeyframeTrack(o.modelName+".morphTargetInfluences["+_+"]",C.times,M)}generateFocalLengthTrack(o){let C=o.FocalLength.curves.focalLength;return new U.NumberKeyframeTrack(o.modelName+".focalLength",C.times,C.values,U.InterpolateSmooth)}getTimesForAllAxes(o){let C=[];if(void 0!==o.x&&(C=C.concat(o.x.times)),void 0!==o.y&&(C=C.concat(o.y.times)),void 0!==o.z&&(C=C.concat(o.z.times)),(C=C.sort(function(o,C){return o-C})).length>1){let o=1,M=C[0];for(let _=1;_<C.length;_++){let S=C[_];S!==M&&(C[o]=S,M=S,o++)}C=C.slice(0,o)}return C}getKeyframeTrackValues(o,C,M){let _=M,S=[],E=-1,P=-1,D=-1;return o.forEach(function(o){if(C.x&&(E=C.x.times.indexOf(o)),C.y&&(P=C.y.times.indexOf(o)),C.z&&(D=C.z.times.indexOf(o)),-1!==E){let o=C.x.values[E];S.push(o),_[0]=o}else S.push(_[0]);if(-1!==P){let o=C.y.values[P];S.push(o),_[1]=o}else S.push(_[1]);if(-1!==D){let o=C.z.values[D];S.push(o),_[2]=o}else S.push(_[2])}),S}interpolateRotations(o){for(let C=1;C<o.values.length;C++){let M=o.values[C-1],_=o.values[C]-M,S=Math.abs(_);if(S>=180){let E=S/180,P=_/E,D=M+P,L=o.times[C-1],I=(o.times[C]-L)/E,T=L+I,R=[],V=[];for(;T<o.times[C];)R.push(T),T+=I,V.push(D),D+=P;o.times=eC(o.times,C,R),o.values=eC(o.values,C,V)}}}}class et{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(o){this.nodeStack.push(o),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(o,C){this.currentProp=o,this.currentPropName=C}parse(o){this.currentIndent=0,this.allNodes=new ea,this.nodeStack=[],this.currentProp=[],this.currentPropName="";let C=this,M=o.split(/[\r\n]+/);return M.forEach(function(o,_){let S=o.match(/^[\s\t]*;/),E=o.match(/^[\s\t]*$/);if(S||E)return;let P=o.match("^\\t{"+C.currentIndent+"}(\\w+):(.*){",""),D=o.match("^\\t{"+C.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),L=o.match("^\\t{"+(C.currentIndent-1)+"}}");P?C.parseNodeBegin(o,P):D?C.parseNodeProperty(o,D,M[++_]):L?C.popStack():o.match(/^[^\s\t}]/)&&C.parseNodePropertyContinued(o)}),this.allNodes}parseNodeBegin(o,C){let M=C[1].trim().replace(/^"/,"").replace(/"$/,""),_=C[2].split(",").map(function(o){return o.trim().replace(/^"/,"").replace(/"$/,"")}),S={name:M},E=this.parseNodeAttr(_),P=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(M,S):M in P?("PoseNode"===M?P.PoseNode.push(S):void 0!==P[M].id&&(P[M]={},P[M][P[M].id]=P[M]),""!==E.id&&(P[M][E.id]=S)):"number"==typeof E.id?(P[M]={},P[M][E.id]=S):"Properties70"!==M&&("PoseNode"===M?P[M]=[S]:P[M]=S),"number"==typeof E.id&&(S.id=E.id),""!==E.name&&(S.attrName=E.name),""!==E.type&&(S.attrType=E.type),this.pushStack(S)}parseNodeAttr(o){let C=o[0];""!==o[0]&&isNaN(C=parseInt(o[0]))&&(C=o[0]);let M="",_="";return o.length>1&&(M=o[1].replace(/^(\w+)::/,""),_=o[2]),{id:C,name:M,type:_}}parseNodeProperty(o,C,M){let _=C[1].replace(/^"/,"").replace(/"$/,"").trim(),S=C[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===_&&","===S&&(S=M.replace(/"/g,"").replace(/,$/,"").trim());let E=this.getCurrentNode();if("Properties70"===E.name){this.parseNodeSpecialProperty(o,_,S);return}if("C"===_){let o=S.split(",").slice(1),C=parseInt(o[0]),M=parseInt(o[1]),P=S.split(",").slice(3);P=P.map(function(o){return o.trim().replace(/^"/,"")}),_="connections",ew(S=[C,M],P),void 0===E[_]&&(E[_]=[])}"Node"===_&&(E.id=S),_ in E&&Array.isArray(E[_])?E[_].push(S):"a"!==_?E[_]=S:E.a=S,this.setCurrentProp(E,_),"a"===_&&","!==S.slice(-1)&&(E.a=ey(S))}parseNodePropertyContinued(o){let C=this.getCurrentNode();C.a+=o,","!==o.slice(-1)&&(C.a=ey(C.a))}parseNodeSpecialProperty(o,C,M){let _=M.split('",').map(function(o){return o.trim().replace(/^\"/,"").replace(/\s/,"_")}),S=_[0],E=_[1],P=_[2],D=_[3],L=_[4];switch(E){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":L=parseFloat(L);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":L=ey(L)}this.getPrevNode()[S]={type:E,type2:P,flag:D,value:L},this.setCurrentProp(this.getPrevNode(),S)}}class er{parse(o){let C=new ei(o);C.skip(23);let M=C.getUint32();if(M<6400)throw Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+M);let _=new ea;for(;!this.endOfContent(C);){let o=this.parseNode(C,M);null!==o&&_.add(o.name,o)}return _}endOfContent(o){return o.size()%16==0?(o.getOffset()+160+16&-16)>=o.size():o.getOffset()+160+16>=o.size()}parseNode(o,C){let M={},_=C>=7500?o.getUint64():o.getUint32(),S=C>=7500?o.getUint64():o.getUint32();C>=7500?o.getUint64():o.getUint32();let E=o.getUint8(),P=o.getString(E);if(0===_)return null;let D=[];for(let C=0;C<S;C++)D.push(this.parseProperty(o));let L=D.length>0?D[0]:"",I=D.length>1?D[1]:"",T=D.length>2?D[2]:"";for(M.singleProperty=1===S&&o.getOffset()===_;_>o.getOffset();){let _=this.parseNode(o,C);null!==_&&this.parseSubNode(P,M,_)}return M.propertyList=D,"number"==typeof L&&(M.id=L),""!==I&&(M.attrName=I),""!==T&&(M.attrType=T),""!==P&&(M.name=P),M}parseSubNode(o,C,M){if(!0===M.singleProperty){let o=M.propertyList[0];Array.isArray(o)?(C[M.name]=M,M.a=o):C[M.name]=o}else if("Connections"===o&&"C"===M.name){let o=[];M.propertyList.forEach(function(C,M){0!==M&&o.push(C)}),void 0===C.connections&&(C.connections=[]),C.connections.push(o)}else if("Properties70"===M.name)Object.keys(M).forEach(function(o){C[o]=M[o]});else if("Properties70"===o&&"P"===M.name){let o,_=M.propertyList[0],S=M.propertyList[1],E=M.propertyList[2],P=M.propertyList[3];0===_.indexOf("Lcl ")&&(_=_.replace("Lcl ","Lcl_")),0===S.indexOf("Lcl ")&&(S=S.replace("Lcl ","Lcl_")),o="Color"===S||"ColorRGB"===S||"Vector"===S||"Vector3D"===S||0===S.indexOf("Lcl_")?[M.propertyList[4],M.propertyList[5],M.propertyList[6]]:M.propertyList[4],C[_]={type:S,type2:E,flag:P,value:o}}else void 0===C[M.name]?"number"==typeof M.id?(C[M.name]={},C[M.name][M.id]=M):C[M.name]=M:"PoseNode"===M.name?(Array.isArray(C[M.name])||(C[M.name]=[C[M.name]]),C[M.name].push(M)):void 0===C[M.name][M.id]&&(C[M.name][M.id]=M)}parseProperty(o){let C;let M=o.getString(1);switch(M){case"C":return o.getBoolean();case"D":return o.getFloat64();case"F":return o.getFloat32();case"I":return o.getInt32();case"L":return o.getInt64();case"R":return C=o.getUint32(),o.getArrayBuffer(C);case"S":return C=o.getUint32(),o.getString(C);case"Y":return o.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":let _=o.getUint32(),S=o.getUint32(),E=o.getUint32();if(0===S)switch(M){case"b":case"c":return o.getBooleanArray(_);case"d":return o.getFloat64Array(_);case"f":return o.getFloat32Array(_);case"i":return o.getInt32Array(_);case"l":return o.getInt64Array(_)}void 0===Q&&console.error("THREE.FBXLoader: External library fflate.min.js required.");let P=new ei(Q.unzlibSync(new Uint8Array(o.getArrayBuffer(E))).buffer);switch(M){case"b":case"c":return P.getBooleanArray(_);case"d":return P.getFloat64Array(_);case"f":return P.getFloat32Array(_);case"i":return P.getInt32Array(_);case"l":return P.getInt64Array(_)}break;default:throw Error("THREE.FBXLoader: Unknown property type "+M)}}}class ei{getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(o){this.offset+=o}getBoolean(){return(1&this.getUint8())==1}getBooleanArray(o){let C=[];for(let M=0;M<o;M++)C.push(this.getBoolean());return C}getUint8(){let o=this.dv.getUint8(this.offset);return this.offset+=1,o}getInt16(){let o=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,o}getInt32(){let o=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,o}getInt32Array(o){let C=[];for(let M=0;M<o;M++)C.push(this.getInt32());return C}getUint32(){let o=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,o}getInt64(){let o,C;return(this.littleEndian?(o=this.getUint32(),C=this.getUint32()):(C=this.getUint32(),o=this.getUint32()),2147483648&C)?(C=4294967295&~C,4294967295==(o=4294967295&~o)&&(C=C+1&4294967295),-(4294967296*C+(o=o+1&4294967295))):4294967296*C+o}getInt64Array(o){let C=[];for(let M=0;M<o;M++)C.push(this.getInt64());return C}getUint64(){let o,C;return this.littleEndian?(o=this.getUint32(),C=this.getUint32()):(C=this.getUint32(),o=this.getUint32()),4294967296*C+o}getFloat32(){let o=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,o}getFloat32Array(o){let C=[];for(let M=0;M<o;M++)C.push(this.getFloat32());return C}getFloat64(){let o=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,o}getFloat64Array(o){let C=[];for(let M=0;M<o;M++)C.push(this.getFloat64());return C}getArrayBuffer(o){let C=this.dv.buffer.slice(this.offset,this.offset+o);return this.offset+=o,C}getString(o){let C=[];for(let M=0;M<o;M++)C[M]=this.getUint8();let M=C.indexOf(0);return M>=0&&(C=C.slice(0,M)),U.LoaderUtils.decodeText(new Uint8Array(C))}constructor(o,C){this.dv=new DataView(o),this.offset=0,this.littleEndian=void 0===C||C}}class ea{add(o,C){this[o]=C}}function eo(o){let C="Kaydara FBX Binary  \x00";return o.byteLength>=C.length&&C===ex(o,0,C.length)}function es(o){let C=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],M=0;function _(C){let _=o[C-1];return o=o.slice(M+C),M++,_}for(let o=0;o<C.length;++o)if(_(1)===C[o])return!1;return!0}function eu(o){let C=/FBXVersion: (\d+)/,M=o.match(C);if(M)return parseInt(M[1]);throw Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function ec(o){return o/46186158e3}let ed=[];function eh(o,C,M,_){let S;switch(_.mappingType){case"ByPolygonVertex":S=o;break;case"ByPolygon":S=C;break;case"ByVertice":S=M;break;case"AllSame":S=_.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+_.mappingType)}"IndexToDirect"===_.referenceType&&(S=_.indices[S]);let E=S*_.dataSize,P=E+_.dataSize;return eb(ed,_.buffer,E,P)}let em=new U.Euler,ef=new U.Vector3;function eg(o){let C=new U.Matrix4,M=new U.Matrix4,_=new U.Matrix4,S=new U.Matrix4,E=new U.Matrix4,P=new U.Matrix4,D=new U.Matrix4,L=new U.Matrix4,I=new U.Matrix4,T=new U.Matrix4,R=new U.Matrix4,V=new U.Matrix4,F=o.inheritType?o.inheritType:0;if(o.translation&&C.setPosition(ef.fromArray(o.translation)),o.preRotation){let C=o.preRotation.map(U.MathUtils.degToRad);C.push(o.eulerOrder||U.Euler.DefaultOrder),M.makeRotationFromEuler(em.fromArray(C))}if(o.rotation){let C=o.rotation.map(U.MathUtils.degToRad);C.push(o.eulerOrder||U.Euler.DefaultOrder),_.makeRotationFromEuler(em.fromArray(C))}if(o.postRotation){let C=o.postRotation.map(U.MathUtils.degToRad);C.push(o.eulerOrder||U.Euler.DefaultOrder),S.makeRotationFromEuler(em.fromArray(C)),S.invert()}o.scale&&E.scale(ef.fromArray(o.scale)),o.scalingOffset&&D.setPosition(ef.fromArray(o.scalingOffset)),o.scalingPivot&&P.setPosition(ef.fromArray(o.scalingPivot)),o.rotationOffset&&L.setPosition(ef.fromArray(o.rotationOffset)),o.rotationPivot&&I.setPosition(ef.fromArray(o.rotationPivot)),o.parentMatrixWorld&&(R.copy(o.parentMatrix),T.copy(o.parentMatrixWorld));let O=M.clone().multiply(_).multiply(S),N=new U.Matrix4;N.extractRotation(T);let H=new U.Matrix4;H.copyPosition(T);let G=H.clone().invert().multiply(T),W=N.clone().invert().multiply(G),K=E,X=new U.Matrix4;if(0===F)X.copy(N).multiply(O).multiply(W).multiply(K);else if(1===F)X.copy(N).multiply(W).multiply(O).multiply(K);else{let o=new U.Matrix4().scale(new U.Vector3().setFromMatrixScale(R)).clone().invert(),C=W.clone().multiply(o);X.copy(N).multiply(O).multiply(C).multiply(K)}let Q=I.clone().invert(),Z=P.clone().invert(),Y=C.clone().multiply(L).multiply(I).multiply(M).multiply(_).multiply(S).multiply(Q).multiply(D).multiply(P).multiply(E).multiply(Z),J=new U.Matrix4().copyPosition(Y),$=T.clone().multiply(J);return V.copyPosition($),(Y=V.clone().multiply(X)).premultiply(T.invert()),Y}function ev(o){let C=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(o=o||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),C[0]):C[o]}function ey(o){return o.split(",").map(function(o){return parseFloat(o)})}function ex(o,C,M){return void 0===C&&(C=0),void 0===M&&(M=o.byteLength),U.LoaderUtils.decodeText(new Uint8Array(o,C,M))}function ew(o,C){for(let M=0,_=o.length,S=C.length;M<S;M++,_++)o[_]=C[M]}function eb(o,C,M,_){for(let S=M,E=0;S<_;S++,E++)o[E]=C[S];return o}function eC(o,C,M){return o.slice(0,C).concat(M).concat(o.slice(C))}var eM=M(90883),e_=M.n(eM),eS=M(33677),ej=M.n(eS);let ek=(o,C)=>(o%C+C)%C;var eE=M(12837),eP=M(62704),eD=M(56764),eL=M(16147);!function(o){o.Freeform="freeform",o.Orbit="orbit"}(P||(P={})),function(o){o.Spline="Spline",o.Linear="Linear",o.TimeCurves="TimeCurves"}(D||(D={}));var eI=M(21228);!function(o){let C=4;function M(o,M,_){return{schemaVersion:C,keyframes:M.map(S),settings:o,templateState:_}}function _(o){var M,_,S,L,I,T,R,V,F,O,N,H,U,G,W,K,X,Q,Z,Y,J,$,ee,et,er,ei,ea,eo,es,eu,ec,ed,eh,em;return o.schemaVersion!==C&&console.warn("schema version mismatch, expected ".concat(C," got ").concat(o.schemaVersion,", trying to import anyway")),{keyframes:null!==(X=null===(M=o.keyframes)||void 0===M?void 0:M.map(E))&&void 0!==X?X:[],settings:{bgColor:null!==(Q=null===(_=o.settings)||void 0===_?void 0:_.bgColor)&&void 0!==Q?Q:{r:0,g:0,b:0,a:0},fov:null!==(Z=null===(S=o.settings)||void 0===S?void 0:S.fov)&&void 0!==Z?Z:60,fps:null!==(Y=null===(L=o.settings)||void 0===L?void 0:L.fps)&&void 0!==Y?Y:30,width:null!==(J=null===(I=o.settings)||void 0===I?void 0:I.width)&&void 0!==J?J:1280,height:null!==($=null===(T=o.settings)||void 0===T?void 0:T.height)&&void 0!==$?$:720,motionMode:null!==(et=null!==(ee=null===(R=o.settings)||void 0===R?void 0:R.motionMode)&&void 0!==ee?ee:null===(V=o.settings)||void 0===V?void 0:V.interpolationMode)&&void 0!==et?et:P.Freeform,interpolation:null!==(er=null===(F=o.settings)||void 0===F?void 0:F.interpolation)&&void 0!==er?er:D.Spline,tension:null!==(ei=null===(O=o.settings)||void 0===O?void 0:O.tension)&&void 0!==ei?ei:0,loop:null!==(ea=null===(N=o.settings)||void 0===N?void 0:N.loop)&&void 0!==ea&&ea,depthMaps:null!==(eo=null===(H=o.settings)||void 0===H?void 0:H.depthMaps)&&void 0!==eo&&eo,transparentBackground:null!==(es=null===(U=o.settings)||void 0===U?void 0:U.transparentBackground)&&void 0!==es&&es,segmentation:null!==(ec=null!==(eu=null===(G=o.settings)||void 0===G?void 0:G.segmentation)&&void 0!==eu?eu:o.lumaOptionSegment)&&void 0!==ec?ec:eE.A6.getValue(),fovXOverride_deg:null!==(ed=null===(W=o.settings)||void 0===W?void 0:W.fovXOverride_deg)&&void 0!==ed?ed:NaN,fovXMultiplier:null!==(eh=null===(K=o.settings)||void 0===K?void 0:K.fovXMultiplier)&&void 0!==eh?eh:1},templateState:null!==(em=o.templateState)&&void 0!==em?em:null}}function S(o){return{id:o.id,t_s:o.t_s,position:o.position.toArray(),quaternion:o.quaternion.toArray(),target:o.target.toArray(),azimuth:o.azimuth,elevation:o.elevation,radius:o.radius,lookAtRelativeQuaternion:o.lookAtRelativeQuaternion.toArray(),focalLength:o.focalLength,smoothness:o.smoothness,keyframeType:o.keyframeType}}function E(o){var C,M,_,S;return new eI.Or({t_s:o.t_s,position:new U.Vector3().fromArray(o.position),quaternion:new U.Quaternion().fromArray(null!==(C=o.quaternion)&&void 0!==C?C:o.orientation),target:new U.Vector3().fromArray(o.target),focalLength:null!==(M=o.focalLength)&&void 0!==M?M:new U.PerspectiveCamera(60,1).getFocalLength(),smoothness:null!==(_=o.smoothness)&&void 0!==_?_:1},null!==(S=o.keyframeType)&&void 0!==S?S:eI.yX.Normal)}function L(o){let C=null!=o?o:window.location.pathname;return"Luma::CurveMode/".concat(C)}o.serializeState=M,o.deserializeState=_,o.serializeKeyframe=S,o.deserializeKeyframe=E;let I=-1;function T(o,C){let M=50;clearInterval(I),I=setTimeout(()=>{R(o,C)},M)}function R(o,C){console.log("updating local storage",C),localStorage.setItem(L(o),JSON.stringify(C))}function V(o){let C=L(o),M=localStorage.getItem(C);return null==M?null:_(JSON.parse(M))}function F(o){console.warn("clearing local storage",L(o)),localStorage.removeItem(L(o))}o.writeLocalStorageDebounce=T,o.writeLocalStorage=R,o.readLocalStorage=V,o.clearLocalStorage=F}(L||(L={}));class ez extends U.Interpolant{interpolate_(o,C,M,_){let S=o-1,E=(M-C)/(_-C),{value:P,time:D}=this.getSample(S-1,this._pPrev),{value:L}=this.getSample(S,this._p0),{value:I}=this.getSample(o,this._p1),{value:T,time:R}=this.getSample(o+1,this._pNext),V=1-this.tension,F=eT(this.keyframeSmoothness[S],this.keyframeSmoothness[o],E);isFinite(F)&&(V*=F);let O=this.resultBuffer;{let M=E*E,P=M*E,D=2*P-3*M+1,T=P-2*M+E,R=-2*P+3*M,F=P-M,N=_-C,H=this.getTangentCatmullRom(S,V,this._v0),U=this.getTangentCatmullRom(o,V,this._v1),G=this.valueSize;for(let o=0;o<G;o++)O[o]=D*L[o]+T*H[o]*N+R*I[o]+F*U[o]*N}return O}getSample(o,C){let M,_=this.parameterPositions;if(o<0){if(this.closed){let o=_[_.length-1]-_[_.length-2];return M=_[0]-o,this.readValues(_.length-2,C),{time:M,value:C}}{let S=_[1]-_[0];return{time:M=_[0]-S*Math.abs(o),value:this.lerp(0,1,0-Math.abs(o),C)}}}if(!(o>=_.length))return M=_[o],this.readValues(o,C),{time:M,value:C};if(this.closed){let o=_[1]-_[0];return M=_[_.length-1]+o,this.readValues(1,C),{time:M,value:C}}{let S=_.length-1,E=_.length-2,P=_[S]-_[E];return{time:M=_[S]+P*(o-S),value:this.lerp(E,S,1+(o-S),C)}}}readValues(o,C){let M=this.sampleValues,_=this.valueSize;for(let S=0;S<_;S++)C[S]=M[o*_+S];return C}lerp(o,C,M,_){let S=this.sampleValues,E=this.valueSize;for(let P=0;P<E;P++){let D=S[o*E+P],L=S[C*E+P];_[P]=D+(L-D)*M}return _}getTangentCatmullRom(o,C,M){let{value:_,time:S}=this.getSample(o-1,this._tPrev),{value:E,time:P}=this.getSample(o,this._tCenter),{value:D,time:L}=this.getSample(o+1,this._tNext),I=P-S,T=L-P,R=L-S,V=this.valueSize;for(let o=0;o<V;o++){let S=_[o],P=E[o],L=D[o];M[o]=C*(T*(P-S)/(I*R)+I*(L-P)/(T*R))}return M}constructor(o,C,M,_,S){super(o,C,M,S),this._pPrev=[],this._p0=[],this._p1=[],this._pNext=[],this._v0=[],this._v1=[],this._tPrev=[],this._tCenter=[],this._tNext=[],this.tension=_.tension,this.closed=_.closed,this.keyframeSmoothness=_.keyframeSmoothness||[]}}function eT(o,C,M){return o+(C-o)*M}var eR=M(39405);class eA extends U.Interpolant{interpolate_(o,C,M,_){let S=new U.Vector3().fromArray(this.rollXZeroCurve.evaluate(M)).normalize(),E=this.rollCurve.evaluate(M),P=new U.Vector3().fromArray(this.zCurve.evaluate(M)).normalize();isFinite(P.x)&&isFinite(P.y)&&isFinite(P.z)||P.set(0,0,1);let D=S.clone().applyAxisAngle(P,-E),L=new U.Vector3().crossVectors(P,D).normalize();D.crossVectors(L,P);let I=this._m;return I.makeBasis(D,L,P),this._q.setFromRotationMatrix(I),this.resultBuffer[0]=this._q.x,this.resultBuffer[1]=this._q.y,this.resultBuffer[2]=this._q.z,this.resultBuffer[3]=this._q.w,this.resultBuffer}constructor(o,C,M,_){super(o,C,4,_),this.quaternions=[],this._q=new U.Quaternion,this._m=new U.Matrix4;let S=[],E=[],P=[],D=new U.Matrix4;for(let M=0;M<o.length;M++){let _=new U.Quaternion().fromArray(C,4*M);this.quaternions[M]=_,D.makeRotationFromQuaternion(_);let L=new U.Vector3,I=new U.Vector3,T=new U.Vector3;D.extractBasis(L,I,T);let R=o[M];E.push(L),P.push(T),S.push(R)}function L(o,C,_,S){return M.linear?new U.LinearInterpolant(o,C,_):new ez(o,C,_,{...M,closed:S})}this.zCurve=L(S,eV(P),3,M.closed);let I=[],T=[],R=E[0].clone();T.push(R),I.push(S[0]);for(let o=0;o<S.length-1;o++){let C=S[o],M=S[o+1],_=30,E=new U.Vector3().fromArray(this.zCurve.evaluate(C)).normalize();for(let o=1;o<=_;o++){let S=C+o/_*(M-C),P=new U.Vector3().fromArray(this.zCurve.evaluate(S)).normalize(),D=new U.Quaternion().setFromUnitVectors(E,P);R.applyQuaternion(D);let L=new U.Vector3().crossVectors(P,R).normalize();R=new U.Vector3().crossVectors(L,P).normalize(),T.push(R),I.push(S),E=P}}this.rollXZeroCurve=L(I,eV(T),3,!1);let V=[];for(let o=0;o<S.length;o++){let C=S[o],M=E[o],_=P[o],D=new U.Vector3().fromArray(this.rollXZeroCurve.evaluate(C)).normalize(),L=eF(M,D)*Math.sign(new U.Vector3().crossVectors(M,D).dot(_));L=(0,eR.SI)(L,V.length>0?V[V.length-1]:L),V.push(L)}this.rollCurve=L(S,V,1,!1)}}function eV(o){let C=new Float32Array(3*o.length);for(let M=0;M<o.length;M++)C[3*M+0]=o[M].x,C[3*M+1]=o[M].y,C[3*M+2]=o[M].z;return C}function eF(o,C){let M=o.dot(C);return M>-1&&M<1?Math.acos(o.dot(C)):M<=-1?Math.PI:0}class eO extends U.Object3D{updateAnimationFromKeyframes(o,C){var M,_,S;let E=this.animationMixer,P=null!==(S=null===(M=o[o.length-1])||void 0===M?void 0:M.t_s)&&void 0!==S?S:0,D=this.animations[0];if(null===(_=E.existingAction(D))||void 0===_||_.stop(),E.uncacheClip(D),0===o.length)D.duration=0;else{let M=new Float32Array(o.map(o=>o.t_s)),_=o.flatMap(o=>o.position.toArray()),S=o.flatMap(o=>o.quaternion.toArray()),L=o.flatMap(o=>o.target.toArray()),I=D.tracks[0],T=D.tracks[1],R=D.tracks[2],V=D.tracks[3],F=D.tracks[4],O=D.tracks[5],N=D.tracks[6],H=D.tracks[7];I.times=M,I.values=new Float32Array(_),T.times=M,T.values=new Float32Array(S),R.times=M,R.values=new Float32Array(L),V.times=M,V.values=new Float32Array(o.map(o=>o.azimuth)),F.times=M,F.values=new Float32Array(o.map(o=>o.elevation)),O.times=M,O.values=new Float32Array(o.map(o=>o.radius)),N.times=M,N.values=new Float32Array(o.flatMap(o=>o.lookAtRelativeQuaternion.toArray())),H.times=M,H.values=new Float32Array(o.map(o=>o.focalLength));for(let o=1;o<V.values.length;o++){let C=V.values[o-1];V.values[o]=(0,eR.SI)(V.values[o],C)}let U=new Float32Array(o.map(o=>o.smoothness)),G=C.loop,W=C.interpolation;I.createInterpolant=eN(W,I,3,C.tension,G,U),R.createInterpolant=eN(W,R,3,C.tension,G,U),V.createInterpolant=eN(W,V,1,C.tension,G,U),F.createInterpolant=eN(W,F,1,C.tension,G,U),O.createInterpolant=eN(W,O,1,C.tension,G,U),H.createInterpolant=eN(W,H,1,C.tension,G,U),T.createInterpolant=eB(W,T,C.tension,G,U),N.createInterpolant=eB(W,N,C.tension,G,U),D.duration=P;let K=E.clipAction(D);K._updateTime=o=>K.time+=o,K.play()}}constructor(){super(),this.animationCamera=new eD.N,this.animationCamera.useOrbitTransform=!0,this.animationCamera.fov=eE.h5.fov,this.animationCamera.name="Camera",this.add(this.animationCamera),this.animations=[new U.AnimationClip("PathAnimation",0,[new U.VectorKeyframeTrack("Camera.position",[0],[0,0,0],U.InterpolateSmooth),new U.QuaternionKeyframeTrack("Camera.quaternion",[0],[0,0,0,1]),new U.VectorKeyframeTrack("Camera.target",[0],[0,0,0],U.InterpolateSmooth),new U.NumberKeyframeTrack("Camera.azimuth",[0],[0],U.InterpolateSmooth),new U.NumberKeyframeTrack("Camera.elevation",[0],[0],U.InterpolateSmooth),new U.NumberKeyframeTrack("Camera.radius",[0],[1],U.InterpolateSmooth),new U.QuaternionKeyframeTrack("Camera.lookAtRelativeQuaternion",[0],[0,0,0,1]),new U.NumberKeyframeTrack("Camera.focalLength",[0],[0])])],this.animationMixer=new U.AnimationMixer(this)}}function eN(o,C,M,_,S,E){switch(o){case D.Linear:return o=>new U.LinearInterpolant(C.times,C.values,M,o);case D.Spline:default:return o=>new ez(C.times,C.values,M,{closed:S,tension:_,keyframeSmoothness:E},o)}}function eB(o,C,M,_,S){return E=>new eA(C.times,C.values,{closed:_,tension:M,keyframeSmoothness:S,linear:o===D.Linear},E)}var eH=M(27486),eU=M(57224),eG=M(55119),eW=M.n(eG),eq=M(38386),eK=M(94770),eX=M(33901),eQ=M.n(eX),eZ=M(8670),eY=M(68623),eJ=M(30125),e$=M(47555),e0=M(17714),e3=M.n(e0);function e2(o){let C=(0,H.useRef)(null),M=o.keyframe,_=M.position.clone(),S=M.target.clone();(0,H.useEffect)(()=>{let o=setInterval(()=>{_.equals(M.position)&&S.equals(M.target)||(_.copy(M.position),S.copy(M.target),C.current&&(C.current.style.background=e6(M.position,M.target)))},1e3/120);return()=>clearInterval(o)},[]);let E=M.smoothness*o.smoothnessMultiplier,P=(0,N.jsx)("div",{ref:C,"data-id":M.id,"data-keyframe":!0,className:e3().keyframeShape+" "+(o.selected?e3().selected:"")+" "+(o.dragging?e3().dragging:""),style:{background:e6(M.position,M.target),borderRadius:50*E+"%"}});return(0,N.jsxs)("div",{className:e3().keyframe,style:{width:(0,eR.t7)(16,19,E)+"px",height:(0,eR.t7)(16,19,E)+"px",...o.style},children:[P,M.keyframeType===eI.yX.Loop&&(0,N.jsx)("div",{className:e3().keyframeIcon,children:"∞"})]})}let e4=new U.Color,e5=new U.Vector3;function e6(o,C){e5.subVectors(o,C);let M=Math.atan2(e5.z,e5.x),_=Math.atan2(e5.y,Math.sqrt(e5.x*e5.x+e5.z*e5.z));return e4.setHSL((M/Math.PI+1)/2,.5,(_/Math.PI+1)/2),"#"+e4.getHexString("srgb")}let e7=eJ.A.Exponential(.05);class e9 extends U.Object3D{constructor(o){super(),this.options=o,this.lineGeometry=new K.L,this.lineMaterial=new X.Y({worldUnits:!1,linewidth:.005,color:16777215,vertexColors:!0,transparent:!1,dashed:!1,dashScale:1,dashSize:.01,dashOffset:0,gapSize:.01}),this.line=null,this.keyframeMeshes=[],this.showAnimationCameraVisual=!1,this.selectedObject=null,this.onDispose=[],this.dispose=()=>{for(let o of(this.removeFromParent(),this.clear(),this.lineGeometry.dispose(),this.lineMaterial.dispose(),this.onDispose))o()},this.clear=()=>(this.clearLine(),this.clearKeyframes(),this),this.clearLine=()=>{null!=this.line&&(this.remove(this.line),this.line=null),this.lineGeometry.dispose(),this.lineGeometry=new K.L},this.clearKeyframes=()=>{for(let o of this.keyframeMeshes)this.remove(o);this.keyframeMeshes=[]},this.setSelection=(o,C)=>{for(let C of(this.selectedObject=o,this.keyframeMeshes))C.selected=!1;if((0,eR.al)(o)){let C;null!=(C=o.keyframeType===eI.yX.Loop?this.keyframeMeshes[0]:this.keyframeMeshes.find(C=>C.keyframeId===o.id))&&(C.selected=!0)}else U.Object3D},this.setEditEnabled=o=>{for(let C of this.keyframeMeshes)C.gizmoEnabled=o},this.update=(o,C,M)=>{let _=o.animationCamera;this.animationCameraVisual.matrix=_.matrix,this.updateLine(o,C),this.updateKeyframes(M?C:[])},this.updateLine=(o,C)=>{if(this.clearLine(),0===C.length)return;let M=o.animationCamera,_=(0,eR.n2)(o,M),S=new U.AnimationMixer(o),E=0;for(let C of o.animations){let o=S.clipAction(C);o._updateTime=C=>o.time+=C,o.play(),E=Math.max(E,C.duration)}let P=[],D=[],L=new U.Color;S.setTime(0);let I=Math.floor(30*E),T=E/I;for(let o=0;o<=I;o++){let C=o*T;S.setTime(C),_.updateMatrixWorld(!0);let M=_.position,E=_.target,I=_.getWorldPosition(new U.Vector3);P.push(I.x,I.y,I.z),L.set(e6(M,E)),D.push(L.r,L.g,L.b)}P.length>0&&(this.lineGeometry.setPositions(P),this.lineGeometry.setColors(D),this.line=new W.w(this.lineGeometry,this.lineMaterial),this.add(this.line)),S.stopAllAction(),S.uncacheRoot(o),S.uncacheClip(o.animations[0]),(0,eR.iQ)(o,M,_)},this.updateKeyframes=o=>{for(let o of this.keyframeMeshes)o.userData.touched=!1;for(let C of o){if(C.keyframeType===eI.yX.Loop)continue;let o=this.keyframeMeshes.find(o=>o.keyframeId===C.id);if(null!=o)o.setKeyframe(C),o.userData.touched=!0;else{let o=new te({keyframe:C,onClick:this.options.onSelect,onChange:this.options.onKeyframeChange,onChangeEnd:this.options.onKeyframeChangeEnd});o.userData.touched=!0,this.add(o),this.keyframeMeshes.push(o)}}for(let o=this.keyframeMeshes.length-1;o>=0;o--){let C=this.keyframeMeshes[o];C.userData.touched||(this.remove(C),this.keyframeMeshes.splice(o,1))}};let C=new U.DirectionalLight(16777215,1);C.position.set(0,1,0),C.target.position.set(0,0,0),this.add(C);let M=new U.HemisphereLight(16777215,11184810,1);this.add(M),this.animationCameraVisual=new U.Object3D;let _=new U.Mesh(e8(.9),new U.MeshLambertMaterial({color:16777215,flatShading:!0})),S=new U.Vector3,E=new U.Vector3;_.onBeforeRender=(o,C,M)=>{S.setFromMatrixPosition(M.matrixWorld),E.setFromMatrixPosition(_.matrixWorld);let P=S.distanceTo(E),D=.05*(P=Math.max(.01,Math.min(4,P)));_.scale.setScalar(D),_.updateMatrixWorld(!0)},this.animationCameraVisual.add(_),this.animationCameraVisual.matrixAutoUpdate=!1,Object.defineProperty(this.animationCameraVisual,"visible",{get:()=>this.showAnimationCameraVisual&&this.keyframeMeshes.length>=2,set:o=>{}}),this.add(this.animationCameraVisual)}}function e8(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return tn("keyframeGeometry-"+o,()=>{let C=new U.ConeGeometry(1,2,4,1);C.rotateX(Math.PI/2),C.rotateZ(Math.PI/4);let M=new U.ConeGeometry(.4,1,4,8);M.scale(1,.4,.01),M.translate(0,1,-1);let _=.75;return(0,eZ.n4)([C,M]).scale(o*_,o*_,o*_)})}class te extends U.Mesh{get selected(){return this._selected}set selected(o){var C,M,_,S;o&&!this._selected?null===(C=(M=this).onSelectStart)||void 0===C||C.call(M,this):!o&&this._selected&&(null===(_=(S=this).onSelectEnd)||void 0===_||_.call(S,this)),this._selected=o,this.transformGizmo.visible=o}setKeyframe(o){this.keyframeId=o.id,this.keyframe=o,this.quaternion.copy(o.quaternion),this.position.copy(o.position),this.colorBase.set(e6(o.position,o.target)),this.colorBase.offsetHSL(0,.2,.15),this.colorHover.copy(this.colorBase).offsetHSL(0,.5,.25),this.colorOutline.copy(this.colorBase).offsetHSL(0,0,.2)}constructor(o){var C,M,_;let S=null!==(C=o.geometry)&&void 0!==C?C:e8();super(S),this.animator=new eY.L,this.colorLerp=0,this.hovered=!1,this.defaultOpacity=.75,this._selected=!1,this.keyframeId=-1,this.colorBase=new U.Color(65280),this.colorHover=new U.Color(65535),this.colorOutline=new U.Color(255),this.keyframe=o.keyframe,this.setKeyframe(o.keyframe),this.onSelectStart=o.onSelectStart,this.onSelectEnd=o.onSelectEnd,this.gizmoEnabled=null!==(M=o.gizmoEnabled)&&void 0!==M&&M,this.viewIndependentSize=null===(_=o.viewIndependentSize)||void 0===_||_,this.material=new U.MeshLambertMaterial({color:this.colorBase,emissive:this.colorBase,emissiveIntensity:.2,transparent:this.defaultOpacity<1,opacity:this.defaultOpacity,flatShading:!0}),this.renderOrder=1e3,this.outline=new U.Mesh(S,new U.MeshBasicMaterial({transparent:!0,opacity:0,depthTest:!0,depthWrite:!1,side:U.BackSide})),this.outline.material.color=this.colorOutline,this.outline.scale.setScalar(1.2),this.outline.position.z=.1,this.add(this.outline),(0,eL.x)(this,{cursor:"pointer",occludePointerEvents:!0,onPointerOver:o=>this.hovered=!0,onPointerOut:o=>this.hovered=!1,onPointerUp:(C,M)=>{var _;return M?null===(_=o.onClick)||void 0===_?void 0:_.call(o,this.keyframe):null}}),this.transformGizmo=new e$.Mu(this,{...o.transformOptions,translation:!0,rotation:!0}),this.transformGizmo.scale.setScalar(4);let E=()=>{this.updateWorldMatrix(!0,!1);let o=this.keyframe,C=eI.Or.getKeyframeFromTransform(this.matrixWorld,o.t_s,o.target,o.focalLength);return C.id=o.id,this.keyframe=C,C};this.transformGizmo.onChangeStart=(C,M)=>{var _;null===(_=o.onChangeStart)||void 0===_||_.call(o,E(),this.position,this.quaternion,M)},this.transformGizmo.onChange=(C,M)=>{o.onChange(E(),this.position,this.quaternion,M)},this.transformGizmo.onChangeEnd=(C,M)=>{o.onChangeEnd(E(),this.position,this.quaternion,M)},this.transformGizmo.renderOrder=this.renderOrder+1,this.frustumCulled=!1;let P=new U.Vector3,D=new U.Vector3;this.onBeforeRender=(o,C,M)=>{let _=this.hovered?1:0;this.animator.springTo(this.outline.material,"opacity",this.selected?1:0,e7),this.animator.springTo(this.material,"opacity",this.selected?1:this.defaultOpacity,e7),this.animator.springTo(this,"colorLerp",_,e7),this.animator.tick(),this.material.color.lerpColors(this.colorBase,this.colorHover,this.colorLerp);let S=this.selected&&this.gizmoEnabled;if(S&&null===this.transformGizmo.parent?this.add(this.transformGizmo):S||null===this.transformGizmo.parent||this.remove(this.transformGizmo),this.viewIndependentSize){P.setFromMatrixPosition(M.matrixWorld),D.setFromMatrixPosition(this.matrixWorld);let o=P.distanceTo(D),C=.05*(o=Math.max(.01,Math.min(4,o)));this.scale.setScalar(C),this.updateMatrixWorld(!0)}}}}let tt={};function tn(o,C){return void 0===tt[o]&&(tt[o]=C()),tt[o]}var tr=M(23195),ti=M.n(tr),ta=M(29416),ts=M(28049),tl=M.n(ts);function tu(o){var C,M,_,S,E,P;let D=C=>{var M;null===(M=o.onChange)||void 0===M||M.call(o,{x:o.obj.x,y:o.obj.y,z:o.obj.z},o.obj,C)};return(0,N.jsxs)(N.Fragment,{children:[null!=o.label&&(0,N.jsx)("label",{className:tl().inlineLabel,title:o.title,children:(0,N.jsx)("span",{children:(0,N.jsx)("b",{children:o.label})})}),(0,N.jsxs)("div",{className:tl().inputXYZ+" InputXYZ",style:o.style,children:[(0,N.jsx)(ta.R,{obj:o.obj,field:"x",type:o.type,min:null===(C=o.min)||void 0===C?void 0:C.x,max:null===(M=o.max)||void 0===M?void 0:M.x,onChange:()=>D("x"),units:o.units,changeDelta:o.changeRate}),(0,N.jsx)(ta.R,{obj:o.obj,field:"y",type:o.type,min:null===(_=o.min)||void 0===_?void 0:_.y,max:null===(S=o.max)||void 0===S?void 0:S.y,onChange:()=>D("x"),units:o.units,changeDelta:o.changeRate}),(0,N.jsx)(ta.R,{obj:o.obj,field:"z",type:o.type,min:null===(E=o.min)||void 0===E?void 0:E.z,max:null===(P=o.max)||void 0===P?void 0:P.z,onChange:()=>D("x"),units:o.units,changeDelta:o.changeRate})]})]})}function tc(o){var C,M;let _=null!==(C=o.width)&&void 0!==C?C:32,S=null!==(M=o.height)&&void 0!==M?M:32,E=o.color;return(0,N.jsxs)("svg",{width:_,height:S,style:{fill:null!=E?E:"currentColor"},viewBox:"0 0 1000 1000",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,N.jsx)("path",{d:"M558.366 510.992C551.299 510.992 545.136 505.757 544.139 498.511C543.043 490.593 548.539 483.278 556.404 482.182C692.796 463.09 774.22 377.966 774.22 254.477C774.22 246.48 780.66 240 788.61 240C796.559 240 803 246.479 803 254.477C803 391.678 710.024 489.911 560.373 510.853C559.699 510.958 559.026 511 558.369 511L558.366 510.992Z"}),(0,N.jsx)("path",{d:"M212.39 760C204.441 760 198 753.545 198 745.577C198 608.899 290.977 511.031 440.629 490.166C448.427 488.947 455.765 494.566 456.861 502.46C457.957 510.348 452.461 517.635 444.595 518.728C308.202 537.749 226.765 622.546 226.765 745.574C226.765 753.536 220.324 759.997 212.38 759.997L212.39 760Z"}),(0,N.jsx)("path",{d:"M240.306 846H182.694C166.873 846 154 833.126 154 817.306V759.694C154 743.873 166.874 731 182.694 731H240.306C256.127 731 269 743.874 269 759.694V817.306C269 833.127 256.126 846 240.306 846ZM240.306 817.249V831.625L240.322 817.249H240.306ZM240.249 759.694L182.694 759.751L182.751 817.306L240.265 817.249L240.249 759.694Z"}),(0,N.jsx)("path",{d:"M817.306 269H759.694C743.873 269 731 256.126 731 240.306V182.694C731 166.873 743.874 154 759.694 154H817.306C833.127 154 846 166.874 846 182.694V240.306C846 256.127 833.126 269 817.306 269ZM817.306 240.249V254.625L817.322 240.249H817.306ZM817.249 182.694L759.694 182.751L759.751 240.306L817.265 240.249L817.249 182.694Z"}),(0,N.jsx)("path",{d:"M558.499 573H442.501C434.491 573 428 566.51 428 558.499V442.501C428 434.491 434.49 428 442.501 428H558.499C566.509 428 573 434.49 573 442.501V558.499C573 566.504 566.505 573 558.499 573ZM456.995 543.999H543.998V456.997H456.995V543.999Z"})]})}function td(o){var C,M;let _=null!==(C=o.width)&&void 0!==C?C:32,S=null!==(M=o.height)&&void 0!==M?M:32,E=o.color;return(0,N.jsx)("svg",{width:_,height:S,style:{fill:null!=E?E:"currentColor",stroke:null!=E?E:"currentColor"},viewBox:"0 0 1000 1000",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,N.jsx)("path",{d:"M711 180C697.479 187.799 684.328 195.385 671.5 202.784M711 825L671.5 802.003M671.5 202.784C671.5 202.784 763.701 312.299 763.701 501.799C763.701 691.299 671.5 802.003 671.5 802.003M671.5 202.784C588.628 250.587 519.261 290.599 451 329.973M671.5 802.003L451 673.625M451 329.973C374.949 373.841 300.271 416.917 209.818 469.091C185.192 483.296 185.108 518.82 209.677 533.124L451 673.625M451 329.973C451 329.973 392.5 398 392.5 501.799C392.5 605.598 451 673.625 451 673.625M453.5 329.973C453.5 329.973 512 398 512 501.799C512 605.598 453.5 673.625 453.5 673.625",stroke:E,strokeWidth:"36",strokeLinecap:"round",strokeLinejoin:"round"})})}var th=M(27367);class tp{tick(){this.animator.tick()}select(o){this.editorGizmo.traverse(C=>{C.selected=C===o})}getState(){return eW()(this.state)}setState(o){tm(this.state,o)}constructor(o,C){this.animator=new eY.L,this.events={onChange:new th.v,onChangeEnd:new th.v,onBakeToKeyframes:new th.v},this.setEditEnabled=o=>{this.editorGizmo.visible=o},this.SelectionContextMenuHeader=()=>null,this.SelectionContextMenu=()=>null,this.type=o,this.state=C,this.editorGizmo=new U.Object3D}}function tm(o,C){for(let M in o)o[M]instanceof Object?tm(o[M],C[M]):o[M]=C[M];return o}let tf={},tg=[],tv={curveSettings:{loop:!1,motionMode:P.Freeform,interpolation:D.Linear,tension:0},getKeyframes(o){if(ti()(tf,o))return tg;let C=[],M=new U.Vector3(o.startPosition.x,o.startPosition.y,o.startPosition.z),_=new U.Vector3(o.target.x,o.target.y,o.target.z),S=new U.Quaternion,E=new U.Matrix4;E.lookAt(M,_,new U.Vector3(0,1,0)),S.setFromRotationMatrix(E);let P=new eI.Or({t_s:0,focalLength:o.startFocalLength,position:M,smoothness:1,quaternion:S,target:_},eI.yX.Normal),D=o.startFocalLength*(o.dollyDistance/M.distanceTo(_)),L=M.clone().sub(_).normalize().multiplyScalar(o.dollyDistance).add(_),I=new eI.Or({t_s:o.duration,focalLength:D,position:L,smoothness:1,quaternion:S,target:_},eI.yX.Normal);return C.push(P),C.push(I),tf=eW()(o),tg=C,C},createEditorObject:o=>new ty(o)};class ty extends tp{constructor(o){super(I.Type.DollyZoom,o),this.SelectionContextMenuHeader=()=>(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(td,{})," Dolly Template"]}),this.SelectionContextMenu=()=>{let o=()=>{this.events.onChange.dispatch(void 0)},C=()=>{this.events.onChangeEnd.dispatch(void 0)},M=this.state,_={onChange:o,onChangeEnd:C};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(tu,{label:"Start",obj:M.startPosition,..._}),(0,N.jsx)(ta.R,{label:"Focal Length",obj:M,field:"startFocalLength",units:"mm",..._}),(0,N.jsx)(ta.R,{label:"Dolly Distance",obj:M,field:"dollyDistance",units:"m",..._}),(0,N.jsx)("hr",{}),(0,N.jsx)(tu,{label:"Target",obj:M.target,..._}),(0,N.jsx)("hr",{}),(0,N.jsx)(ta.R,{label:"Duration",obj:M,field:"duration",units:"s",min:1,..._}),(0,N.jsx)("hr",{}),(0,N.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,N.jsxs)("button",{onClick:()=>this.events.onBakeToKeyframes.dispatch(void 0),children:[(0,N.jsx)(tc,{width:24,height:24})," Edit Keyframes"]})})]})}}}var tx=M(65134),tw=M(75788);let tb=eJ.A.Exponential(.05);class tC extends tx.w{set(o,C){let M=[],_=new U.Vector3(C.x-o.x,C.y-o.y,C.z-o.z),S=_.length(),E=S>0?_.multiplyScalar(1/S):new U.Vector3(1,0,0),P=.1,D=0;for(let C=0;C<S;C+=P){if(D%2==0){let _=Math.min(C+P,S);M.push(o.x+E.x*C,o.y+E.y*C,o.z+E.z*C),M.push(o.x+E.x*_,o.y+E.y*_,o.z+E.z*_)}D+=1}let L=new tw.z;L.setPositions(M),this.geometry=L}toggleDisplay(o){let C=!(arguments.length>1)||void 0===arguments[1]||arguments[1],M=o?this.displayShowOpacity:this.displayHideOpacity;C?this.animator.springTo(this.material,"opacity",M,tb):this.animator.setTo(this.material,"opacity",M)}tick(){this.animator.tick()}constructor(o=new U.Vector3,C=new U.Vector3,M){super(new tw.z,new X.Y({color:16777215,worldUnits:!0,linewidth:.03,opacity:1,transparent:!0,depthWrite:!1,...M})),this.animator=new eY.L,this.displayShowOpacity=.75,this.displayHideOpacity=0,this.set(o,C),this.toggleDisplay(!0,!1)}}function tM(o){var C,M;let _=null!==(C=o.width)&&void 0!==C?C:32,S=null!==(M=o.height)&&void 0!==M?M:32,E=o.color;return(0,N.jsxs)("svg",{width:_,height:S,style:{fill:null!=E?E:"currentColor"},viewBox:"0 0 1000 1000",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,N.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M500.019 583.668C392.955 583.668 297.891 563.199 239.019 531.101C205.252 512.669 183.355 491.569 183.355 466.999C183.355 442.435 205.252 421.335 239.019 402.898C297.887 370.799 392.948 350.331 500.019 350.331C607.091 350.331 702.148 370.799 761.019 402.898C794.787 421.329 816.684 442.429 816.684 466.999C816.684 482.435 807.448 496.598 792.381 509.768C765.082 533.668 719.445 553.132 662.917 566.235C653.949 568.3 648.385 577.267 650.45 586.235C652.515 595.202 661.482 600.799 670.45 598.701C733.453 584.137 783.916 561.503 814.35 534.834C837.816 514.299 850.014 491.034 850.014 467C850.014 432.697 824.15 399.366 776.979 373.636C714.479 339.567 613.707 317 500.007 317C386.307 317 285.55 339.567 223.036 373.636C175.87 399.367 150 432.704 150 467C150 501.303 175.864 534.634 223.036 560.364C285.536 594.433 386.307 617 500.007 617C509.209 617 516.676 609.533 516.676 600.331C516.676 591.129 509.209 583.663 500.007 583.663L500.019 583.668Z"}),(0,N.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M421.548 545.468L476.448 600.333L421.548 655.199C415.047 661.734 415.047 672.263 421.548 678.799C428.083 685.3 438.612 685.3 445.148 678.799L511.817 612.131C518.318 605.596 518.318 595.066 511.817 588.531L445.148 521.862C438.613 515.361 428.084 515.361 421.548 521.862C415.047 528.397 415.047 538.926 421.548 545.462V545.468Z"})]})}class t_ extends U.Object3D{get selected(){return this._selected}set selected(o){var C,M,_,S;o&&!this._selected?null===(C=(M=this).onSelectStart)||void 0===C||C.call(M,this):!o&&this._selected&&(null===(_=(S=this).onSelectEnd)||void 0===_||_.call(S,this)),this._selected=o,this.transformGizmo.visible=o}constructor(o){super(),this._selected=!1,this.onSelectStart=o.onSelectStart,this.onSelectEnd=o.onSelectEnd;let C=new U.Mesh(new U.SphereGeometry(1,32,32),new U.MeshLambertMaterial({emissive:16777215,emissiveIntensity:.1}));this.add(C);let M=new e$.Mu(this,o.transformOptions);this.transformGizmo=M,M.visible=!1,M.scale.setScalar(.75),M.onChangeStart=(C,M)=>{var _;null===(_=o.onChangeStart)||void 0===_||_.call(o,C.position,C.quaternion,M)},M.onChange=(C,M)=>{var _;null===(_=o.onChange)||void 0===_||_.call(o,C.position,C.quaternion,M)},M.onChangeEnd=(C,M)=>{var _;null===(_=o.onChangeEnd)||void 0===_||_.call(o,C.position,C.quaternion,M)},this.add(M),tS(C,.025),(0,eL.x)(C,{cursor:"pointer",occludePointerEvents:!0,onPointerUp:(C,M)=>{if(M){var _;null===(_=o.onClick)||void 0===_||_.call(o,C)}}})}}function tS(o,C){o.frustumCulled=!1,o.renderOrder=-1/0;let M=new U.Vector3,_=new U.Vector3,S=o.onBeforeRender;return o.onBeforeRender=(E,P,D,L,I,T)=>{M.setFromMatrixPosition(D.matrixWorld),_.setFromMatrixPosition(o.matrixWorld);let R=M.distanceTo(_);o.scale.setScalar(C*R),o.updateWorldMatrix(!1,!0),null==S||S(E,P,D,L,I,T)},{remove:()=>{o.onBeforeRender=S}}}function tj(o){var C,M;let _=Array.isArray(o.options)?o.options.map(o=>({key:o,value:o})):Object.entries(o.options).map(o=>{let[C,M]=o;return{key:C,value:M}}),S=(null===(C=o.showLabel)||void 0===C||C)&&null!=o.label;return(0,N.jsxs)("div",{style:{display:"flex",gap:"12px",...null!==(M=o.style)&&void 0!==M?M:{}},children:[(0,N.jsx)("label",{className:tl().inlineLabel+" ",title:o.title,style:{display:S?"":"none",cursor:"e-resize"},onClick:()=>{let C=_.findIndex(C=>C.value===o.value);C=-1===C?0:(C+1)%_.length,o.onChange(_[C].value)},children:(0,N.jsx)("b",{children:o.label})}),(0,N.jsx)("div",{id:o.id,className:tl().inputRadio,children:_.map(C=>(0,N.jsxs)("div",{onClick:()=>o.onChange(C.value),className:o.value===C.value?tl().selected:"",children:[" ",C.key+""," "]},C.key+""))})]})}let tk=new U.Matrix4,tE={},tP=[],tD={curveSettings:{loop:!1,motionMode:P.Orbit,interpolation:D.Spline,tension:0},getKeyframes(o){if(ti()(tE,o))return tP;let C=[];for(let M=0;M<5;M++){let _=o.rotation_radians+o.direction*(2*Math.PI)*M/4,S=new U.Vector3(o.target.x+Math.cos(_)*o.radius,o.target.y+o.height,o.target.z+Math.sin(_)*o.radius),E=new U.Quaternion,P=new U.Vector3(o.target.x,o.target.y,o.target.z);tk.lookAt(S,P,U.Object3D.DEFAULT_UP).decompose(new U.Vector3,E,new U.Vector3);let D=new eI.Or({t_s:M*o.duration/4,focalLength:o.focalLength,position:S,quaternion:E,target:P,smoothness:1},eI.yX.Normal);C.push(D)}return tE=eW()(o),tP=C,C},createEditorObject:o=>new tI(o)},tL=.05;class tI extends tp{setState(o){super.setState(o),this.targetHandle.position.set(o.target.x,o.target.y,o.target.z),this.radiusHandle.position.set(o.target.x+Math.cos(o.rotation_radians)*o.radius,o.target.y+o.height,o.target.z+Math.sin(o.rotation_radians)*o.radius);let C=this.radiusHandle.position.clone().sub(this.targetHandle.position);{let o=new U.Vector3(C.x,C.y,C.z).clone().normalize(),M=new U.Vector3(0,1,0).cross(o).normalize(),_=o.clone().cross(M).normalize(),S=new U.Matrix4;S.set(M.x,_.x,o.x,0,M.y,_.y,o.y,0,M.z,_.z,o.z,0,0,0,0,1),this.radiusHandle.quaternion.setFromRotationMatrix(S)}{let o=new U.Vector3(C.x,0,C.z).clone().normalize(),M=new U.Vector3(0,1,0).cross(o).normalize(),_=o.clone().cross(M).normalize(),S=new U.Matrix4;S.set(M.x,_.x,o.x,0,M.y,_.y,o.y,0,M.z,_.z,o.z,0,0,0,0,1);let E=new U.Quaternion().setFromRotationMatrix(S);this.radiusHandle.transformGizmo.quaternion.copy(this.radiusHandle.quaternion).invert(),this.radiusHandle.transformGizmo.quaternion.multiply(E)}{let C=new U.Vector3(o.target.x,o.target.y+o.height,o.target.z),M=this.radiusHandle.position;this.radiusVisual.set(C,M)}{let C=new U.Vector3(o.target.x,o.target.y,o.target.z),M=new U.Vector3(o.target.x,o.target.y+o.height,o.target.z);this.heightVisual.set(C,M)}}constructor(o){super(I.Type.Orbit,o),this.radiusVisual=new tC,this.heightVisual=new tC,this.SelectionContextMenuHeader=()=>(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(tM,{})," Orbit Template"]}),this.SelectionContextMenu=()=>{let[o,C]=(0,H.useState)(this.state.direction),M=(o,C,M)=>{this.events.onChange.dispatch(void 0),"radius"==M&&(this.select(this.radiusHandle),this.radiusVisual.toggleDisplay(!0)),"height"==M&&(this.select(this.radiusHandle),this.heightVisual.toggleDisplay(!0)),C==this.state.target&&this.select(this.targetHandle)},_=(o,C,M)=>{this.events.onChangeEnd.dispatch(void 0),"radius"==M&&this.radiusVisual.toggleDisplay(!1),"height"==M&&this.heightVisual.toggleDisplay(!1)},S=this.state,E={onChange:M,onChangeEnd:_};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ta.R,{...E,label:"Radius",obj:S,field:"radius",min:tL,onFocus:()=>this.select(this.radiusHandle),onHoverStart:()=>this.radiusVisual.toggleDisplay(!0),onHoverEnd:()=>this.radiusVisual.toggleDisplay(!1)}),(0,N.jsx)(ta.R,{...E,label:"Height",obj:S,field:"height",onFocus:()=>this.select(this.radiusHandle),onHoverStart:()=>this.heightVisual.toggleDisplay(!0),onHoverEnd:()=>this.heightVisual.toggleDisplay(!1)}),(0,N.jsx)(ta.R,{...E,label:"Rotation",obj:S,field:"rotation_radians",units:"\xb0",onFocus:()=>this.select(this.radiusHandle),changeDelta:30,conversion:{toDisplay:U.MathUtils.radToDeg,fromDisplay:U.MathUtils.degToRad}}),(0,N.jsx)(ta.R,{label:"Focal Length",obj:S,field:"focalLength",...E}),(0,N.jsx)(tj,{label:"Direction",value:o,options:{"<":1,">":-1},onChange:o=>{this.state.direction=o,C(this.state.direction),M(o,this.state,"direction")}}),(0,N.jsx)(ta.R,{label:"Duration",obj:S,field:"duration",units:"s",min:1,...E}),(0,N.jsx)("hr",{}),(0,N.jsx)(tu,{label:"Target",obj:S.target,...E}),(0,N.jsx)("hr",{}),(0,N.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,N.jsxs)("button",{onClick:()=>this.events.onBakeToKeyframes.dispatch(void 0),children:[(0,N.jsx)(tc,{width:24,height:24})," Edit Keyframes"]})})]})};let C=0,M=o.rotation_radians;this.targetHandle=new t_({transformOptions:{translationX:!0,translationY:!0,translationZ:!0,rotationX:!1,rotationY:!0,rotationZ:!1},onChangeStart:(o,_)=>{let S=new U.Vector3(1,0,0).applyQuaternion(_);C=Math.atan2(S.z,S.x),M=this.state.rotation_radians},onChange:(o,_)=>{this.state.target.x=o.x,this.state.target.y=o.y,this.state.target.z=o.z;let S=new U.Vector3(1,0,0).applyQuaternion(_),E=Math.atan2(S.z,S.x)-C;this.state.rotation_radians=M+E,this.events.onChange.dispatch(void 0)},onChangeEnd:(o,C)=>{this.events.onChangeEnd.dispatch(void 0)},onClick:()=>{this.select(this.targetHandle)}});let _=new U.Vector2;this.radiusHandle=new te({gizmoEnabled:!0,keyframe:new eI.Or({t_s:0,focalLength:0,position:new U.Vector3(0,0,0),quaternion:new U.Quaternion,target:new U.Vector3(0,0,0),smoothness:1},eI.yX.Normal),transformOptions:{translationX:!1,translationY:!0,translationZ:!0,rotationX:!1,rotationY:!1,rotationZ:!1},onChangeStart:(o,C,M,S)=>{_.set(C.x-this.state.target.x,C.z-this.state.target.z),"translateZ"==S.name&&this.radiusVisual.toggleDisplay(!0),"translateY"==S.name&&this.heightVisual.toggleDisplay(!0)},onChange:(o,C,M,S)=>{let E=new U.Vector2(C.x-this.state.target.x,C.z-this.state.target.z),P=E.length()*Math.sign(E.dot(_));P<tL&&(P>0?E.multiplyScalar(tL/P):E.set(tL,0),P=tL,C.x=this.state.target.x+E.x,C.z=this.state.target.z+E.y),this.state.radius=E.length(),this.state.height=C.y-this.state.target.y,this.events.onChange.dispatch(void 0),"translateZ"==S.name&&this.radiusVisual.toggleDisplay(!0),"translateY"==S.name&&this.heightVisual.toggleDisplay(!0)},onChangeEnd:(o,C,M,_)=>{this.events.onChangeEnd.dispatch(void 0),"translateZ"==_.name&&this.radiusVisual.toggleDisplay(!1),"translateY"==_.name&&this.heightVisual.toggleDisplay(!1)},onSelectEnd:()=>{this.radiusVisual.toggleDisplay(!1),this.heightVisual.toggleDisplay(!1)},onClick:()=>{this.select(this.radiusHandle)}}),this.radiusHandle.transformGizmo.zAxis.events.onHoverStart.addListener(()=>{this.radiusVisual.toggleDisplay(!0)}),this.radiusHandle.transformGizmo.zAxis.events.onHoverEnd.addListener(()=>{this.radiusVisual.toggleDisplay(!1)}),this.radiusHandle.transformGizmo.yAxis.events.onHoverStart.addListener(()=>{this.heightVisual.toggleDisplay(!0)}),this.radiusHandle.transformGizmo.yAxis.events.onHoverEnd.addListener(()=>{this.heightVisual.toggleDisplay(!1)}),this.editorGizmo.add(this.targetHandle),this.editorGizmo.add(this.radiusHandle),this.editorGizmo.add(this.radiusVisual),this.editorGizmo.add(this.heightVisual),this.radiusVisual.toggleDisplay(!1,!1),this.heightVisual.toggleDisplay(!1,!1),this.animator.onAfterStep.addListener(o=>{this.radiusVisual.tick(),this.heightVisual.tick()}),this.setState(o)}}function tz(o){var C,M;let _=null!==(C=o.width)&&void 0!==C?C:32,S=null!==(M=o.height)&&void 0!==M?M:32,E=o.color;return(0,N.jsx)("svg",{width:_,height:S,style:{fill:null!=E?E:"currentColor"},viewBox:"0 0 1000 1000",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,N.jsx)("path",{d:"M865.991 514.043C865.991 615.64 782.961 700.299 679.605 700.299C677.909 700.299 515.237 698.604 477.969 519.123C444.081 359.949 322.083 363.346 322.083 363.346C237.361 363.346 169.581 431.079 169.581 515.741C169.581 600.403 237.361 668.136 322.083 668.136C367.833 668.136 410.197 647.817 439.001 612.258C445.781 605.483 455.947 603.794 462.721 610.563C469.501 617.338 471.192 627.498 464.418 634.267C428.834 676.601 376.304 702 320.386 702C218.718 702 134 619.027 134 515.744C134 412.452 217.031 329.488 320.386 329.488C320.386 329.488 471.189 324.408 510.171 512.362C542.368 664.757 672.84 668.139 679.622 668.139C762.653 668.139 832.124 600.406 832.124 515.744C832.124 431.082 764.344 363.349 679.622 363.349C644.039 363.349 610.151 376.893 581.342 398.907L637.259 407.372C645.729 409.067 652.509 417.532 652.509 425.996C650.813 434.461 644.039 441.236 635.562 441.236H633.866L542.365 429.381C537.282 429.381 532.198 425.996 528.811 420.916C525.424 415.836 523.728 410.757 525.424 403.982L537.287 314.24C538.984 305.775 547.454 299 555.925 299C564.395 300.695 571.175 309.16 571.175 317.624L564.395 370.118C596.592 343.023 637.259 329.479 681.313 329.479C782.981 327.784 866 412.452 866 514.052L865.991 514.043Z"})})}let tT={},tR=[],tA={curveSettings:{loop:!0,motionMode:P.Orbit,interpolation:D.Spline,tension:0},getKeyframes(o){if(ti()(tT,o))return tR;let C=o.viewPosition,M=[{radius:C.radius,elevation:C.elevation,azimuth:C.azimuth},{radius:C.radius,elevation:C.elevation+o.amplitudeElevation,azimuth:C.azimuth-o.amplitudeAzimuth},{radius:C.radius,elevation:C.elevation-o.amplitudeElevation,azimuth:C.azimuth-o.amplitudeAzimuth},{radius:C.radius,elevation:C.elevation,azimuth:C.azimuth},{radius:C.radius,elevation:C.elevation+o.amplitudeElevation,azimuth:C.azimuth+o.amplitudeAzimuth},{radius:C.radius,elevation:C.elevation-o.amplitudeElevation,azimuth:C.azimuth+o.amplitudeAzimuth}],_=M.map((C,_)=>{let S=new U.Vector3(o.target.x,o.target.y,o.target.z),E=(0,eR.pg)(C),P=new U.Vector3(S.x+E.x,S.y+E.y,S.z+E.z),D=new U.Quaternion,L=new U.Matrix4;return L.lookAt(P,S,new U.Vector3(0,1,0)),D.setFromRotationMatrix(L),new eI.Or({t_s:_*o.duration/(M.length-1),position:P,focalLength:o.focalLength,smoothness:1,target:S,quaternion:D},eI.yX.Normal)});return tT=eW()(o),tR=_,_},createEditorObject:o=>new tF(o)},tV=.05;class tF extends tp{setState(o){super.setState(o),this.targetHandle.position.set(o.target.x,o.target.y,o.target.z);let C=(0,eR.pg)(o.viewPosition);this.viewPositionHandle.position.set(o.target.x+C.x,o.target.y+C.y,o.target.z+C.z);{let o=new U.Vector3(C.x,C.y,C.z).clone().normalize(),M=new U.Vector3(0,1,0).cross(o).normalize(),_=o.clone().cross(M).normalize(),S=new U.Matrix4;S.set(M.x,_.x,o.x,0,M.y,_.y,o.y,0,M.z,_.z,o.z,0,0,0,0,1),this.viewPositionHandle.quaternion.setFromRotationMatrix(S)}this.radiusVisual.set(o.target,this.viewPositionHandle.position)}constructor(o){super(I.Type.Oscillate,o),this.radiusVisual=new tC,this.SelectionContextMenuHeader=()=>(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(tz,{})," Oscillate Template"]}),this.SelectionContextMenu=()=>{let o=(o,C,_)=>{this.events.onChange.dispatch(void 0),C===M.viewPosition&&this.radiusVisual.toggleDisplay(!0)},C=(o,C,_)=>{this.events.onChangeEnd.dispatch(void 0),C===M.viewPosition&&this.radiusVisual.toggleDisplay(!1)},M=this.state,_={onChange:o,onChangeEnd:C};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ta.R,{label:"Stretch X",obj:M,field:"amplitudeAzimuth",units:"\xb0",conversion:"radiansToDegrees",changeDelta:30,min:0,max:160,..._}),(0,N.jsx)(ta.R,{label:"Stretch Y",obj:M,field:"amplitudeElevation",units:"\xb0",conversion:"radiansToDegrees",changeDelta:15,min:0,max:80,..._}),(0,N.jsx)(ta.R,{label:"Focal Length",obj:M,field:"focalLength",units:"mm",min:0,..._}),(0,N.jsx)("hr",{}),(0,N.jsx)(ta.R,{label:"Azimuth",obj:M.viewPosition,field:"azimuth",units:"\xb0",conversion:"radiansToDegrees",changeDelta:60,..._,onHoverStart:()=>this.radiusVisual.toggleDisplay(!0),onHoverEnd:()=>this.radiusVisual.toggleDisplay(!1)}),(0,N.jsx)(ta.R,{label:"Elevation",obj:M.viewPosition,field:"elevation",units:"\xb0",conversion:"radiansToDegrees",changeDelta:30,..._,onHoverStart:()=>this.radiusVisual.toggleDisplay(!0),onHoverEnd:()=>this.radiusVisual.toggleDisplay(!1)}),(0,N.jsx)(ta.R,{label:"Distance",obj:M.viewPosition,field:"radius",min:tV,..._}),(0,N.jsx)(tu,{label:"Target",obj:M.target,..._}),(0,N.jsx)("hr",{}),(0,N.jsx)(ta.R,{label:"Duration",obj:M,field:"duration",units:"s",min:1,..._}),(0,N.jsx)("hr",{}),(0,N.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,N.jsxs)("button",{onClick:()=>this.events.onBakeToKeyframes.dispatch(void 0),children:[(0,N.jsx)(tc,{width:24,height:24})," Edit Keyframes"]})})]})},this.targetHandle=new t_({transformOptions:{translationX:!0,translationY:!0,translationZ:!0,rotationX:!1,rotationY:!1,rotationZ:!1},onChange:(o,C)=>{this.state.target.x=o.x,this.state.target.y=o.y,this.state.target.z=o.z;let M=new U.Vector3(1,0,0).applyQuaternion(C);M.z,M.x,this.events.onChange.dispatch(void 0)},onChangeEnd:(o,C)=>{this.events.onChangeEnd.dispatch(void 0)},onClick:()=>{this.select(this.targetHandle)}});let C=new U.Vector3;this.viewPositionHandle=new te({keyframe:new eI.Or({t_s:0,focalLength:0,position:new U.Vector3(0,0,0),quaternion:new U.Quaternion,target:new U.Vector3(0,0,0),smoothness:1},eI.yX.Normal),gizmoEnabled:!0,transformOptions:{translationX:!1,translationY:!1,translationZ:!0,rotationX:!1,rotationY:!1,rotationZ:!1},onChangeStart:(o,M,_,S)=>{C.copy(M),"translateZ"==S.name&&this.radiusVisual.toggleDisplay(!0)},onChange:(o,M,_,S)=>{let E=new U.Vector3(this.state.target.x,this.state.target.y,this.state.target.z),P=new U.Vector3(M.x,M.y,M.z).sub(E),D=C.clone().sub(E).normalize().clone().multiplyScalar(tV);0>P.dot(D)&&(P.copy(D),M.copy(E).add(P)),this.state.viewPosition.radius=P.length(),"translateZ"==S.name&&this.radiusVisual.toggleDisplay(!0),this.events.onChange.dispatch(void 0)},onChangeEnd:(o,C,M,_)=>{this.events.onChangeEnd.dispatch(void 0),"translateZ"==_.name&&this.radiusVisual.toggleDisplay(!1)},onSelectEnd:()=>{this.radiusVisual.toggleDisplay(!1)},onClick:()=>{this.select(this.viewPositionHandle)}}),this.radiusVisual.displayShowOpacity=.75,this.radiusVisual.displayHideOpacity=.2,this.editorGizmo.add(this.targetHandle),this.editorGizmo.add(this.viewPositionHandle),this.editorGizmo.add(this.radiusVisual),this.radiusVisual.toggleDisplay(!1,!1),this.viewPositionHandle.transformGizmo.zAxis.events.onHoverStart.addListener(()=>{this.radiusVisual.toggleDisplay(!0)}),this.viewPositionHandle.transformGizmo.zAxis.events.onHoverEnd.addListener(()=>{this.radiusVisual.toggleDisplay(!1)}),this.animator.onAfterStep.addListener(o=>{this.radiusVisual.tick()}),this.setState(o)}}!function(o){let C;!function(o){o.Orbit="orbit",o.Oscillate="oscillate",o.DollyZoom="dollyZoom"}(C=o.Type||(o.Type={}));let M={orbit:tD,dollyZoom:tv,oscillate:tA};function _(o){return M[o.type]||(console.error("unknown template type ".concat(o.type)),null)}function S(o){var C,M;return null!==(M=null===(C=_(o))||void 0===C?void 0:C.curveSettings)&&void 0!==M?M:{}}function E(o){var C,M;return null!==(M=null===(C=_(o))||void 0===C?void 0:C.getKeyframes(o))&&void 0!==M?M:[]}function P(o){var C,M;return null!==(M=null===(C=_(o))||void 0===C?void 0:C.createEditorObject(o))&&void 0!==M?M:null}o.getCurveSettings=S,o.getKeyframes=E,o.createEditorObject=P}(I||(I={}));var tO=M(7202),tN=M.n(tO);function tB(o){var C,M,_,S;let E=(0,H.useRef)(null),P=null!==(_=null===(C=E.current)||void 0===C?void 0:C.clientWidth)&&void 0!==_?_:0,D=null!==(S=null===(M=E.current)||void 0===M?void 0:M.clientHeight)&&void 0!==S?S:0,L=P/D,I=o.videoWidth/o.videoHeight,T=D*I,R=P/I,V=I>L;return(0,N.jsxs)("div",{id:"frameGuide",ref:E,className:tN().frameGuideContainer,children:[(0,N.jsx)("div",{className:tN().frameGuide,style:{bottom:V?(1-(1-R/D)*.5)*100+"%":"-1px",right:V?"-1px":(1-(1-T/P)*.5)*100+"%",left:"-1px",top:"-1px"}}),(0,N.jsx)("div",{className:tN().frameGuide,style:{top:V?(1-(1-R/D)*.5)*100+"%":"-1px",left:V?"-1px":(1-(1-T/P)*.5)*100+"%",bottom:"-1px",right:"-1px"}})]})}function tH(o){var C;let M=(0,H.useRef)(null);return(0,N.jsxs)("button",{onClick:()=>{var o;return null===(o=M.current)||void 0===o?void 0:o.click()},style:o.style,children:[(0,N.jsx)(eU.aAW,{})," ",(0,N.jsx)("span",{children:null!==(C=o.label)&&void 0!==C?C:"Import File"}),(0,N.jsx)("input",{ref:M,type:"file",accept:".fbx,.json",hidden:!0,onChange:C=>{if(null==C.target.files||0==C.target.files.length){console.warn("No files selected");return}o.onImportFile(C.target.files[0]),C.target.value=""}})]})}var tU=M(96487),tG=M.n(tU);let tW=o=>(0,N.jsx)("div",{className:tG().clearMenu,...o,children:o.children});tW.Section=o=>{var C,M,_;let S;let{collapsed:E,onCollapseChange:P,header:D,...L}=o,[I,T]=(0,H.useState)(null!==(M=o.collapsed)&&void 0!==M&&M),R=(0,H.useRef)(I);R.current=I;let V=(0,H.useRef)(null),F=(0,H.useRef)(null);(0,H.useEffect)(()=>{var C;return T(null!==(C=o.collapsed)&&void 0!==C?C:I)},[o.collapsed]);let[,O]=(0,H.useReducer)(o=>o+1,0);function U(){R.current&&(T(!1),null==P||P(!1))}(0,H.useEffect)(O,[]);let G=(0,H.useRef)([]);tq(V,()=>{var o;O(),G.current.forEach(o=>o.remove()),G.current=[],null===(o=V.current)||void 0===o||o.querySelectorAll("input, [contenteditable]").forEach(o=>{o.addEventListener("focus",U),G.current.push({remove:()=>o.removeEventListener("focus",U)})})}),(0,H.useEffect)(()=>{let o=setInterval(O,100);return()=>clearInterval(o)},[]);let W=null!==(_=null===(C=V.current)||void 0===C?void 0:C.clientHeight)&&void 0!==_?_:0;return S=(I?0:W)+"px",(0,N.jsxs)("section",{className:I?tG().collapsed:"",...L,style:{...L.style},children:[(0,N.jsxs)("header",{ref:F,onClick:()=>{T(!I),null==P||P(!I)},children:[I?(0,N.jsx)(eU.XCv,{}):(0,N.jsx)(eU.v4q,{}),(0,N.jsx)("span",{children:D})]}),(0,N.jsx)("div",{style:{maxHeight:S,transition:"max-height 0.1s ease-in-out"},children:(0,N.jsx)("div",{ref:V,className:tG().sectionContent,children:o.children})})]})};let tq=function(o,C){let M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{attributes:!0,characterData:!0,childList:!0,subtree:!0};H.useEffect(()=>{if(o.current){let _=new MutationObserver(C);return _.observe(o.current,M),()=>_.disconnect()}},[C,M])},tK=o=>(0,N.jsx)("div",{className:tG().menu,...o,children:o.children});function tX(o){let C=(0,H.useRef)({...o.settings});function M(){o.onSettingsChange({...C.current})}(0,H.useEffect)(()=>{Object.assign(C.current,o.settings)},[o.settings]);let _=(0,H.useRef)(o.duration);(0,H.useEffect)(()=>{_.current=o.duration},[o.duration]);let S=(0,H.useMemo)(()=>({get smoothness(){return 1-C.current.tension},set smoothness(value){C.current.tension=1-value}}),[]);return(0,N.jsxs)(tW.Section,{header:"Motion",collapsed:o.collapsed,onCollapseChange:o.onCollapseChange,children:[(0,N.jsx)(tK.Row,{children:(0,N.jsx)(tj,{options:[P.Freeform,P.Orbit],value:o.settings.motionMode,onChange:o=>{C.current.motionMode=o,M()},style:{width:"100%",justifyContent:"center"}})}),(0,N.jsx)(tK.Row,{children:(0,N.jsx)(ta.R,{style:{width:"100%"},obj:_,field:"current",label:"duration",type:"float",units:"s",min:1,max:o.durationMax,onChange:o.onDurationChange,onChangeEnd:o.onDurationChangeEnd})}),(0,N.jsx)(tK.Row,{children:(0,N.jsx)(ta.R,{label:"smoothness",style:{width:"100%"},obj:S,field:"smoothness",type:"float",min:0,max:1,onChange:M})}),(0,N.jsx)(tK.Row,{children:(0,N.jsx)(tj,{label:"loop",options:["off","on"],value:o.settings.loop?"on":"off",onChange:o=>{C.current.loop="on"===o,M()},style:{justifyContent:"flex-end",width:"100%"}})})]})}tK.Row=o=>(0,N.jsx)("div",{className:tG().inputRow,...o,children:o.children}),tK.Section=o=>{var C;let[M,_]=(0,H.useState)(null!==(C=o.collapsed)&&void 0!==C&&C),S=(0,H.useRef)(null),[E,P]=(0,H.useState)(null);return(0,H.useEffect)(()=>{var o,C;P(null!==(C=null===(o=S.current)||void 0===o?void 0:o.clientHeight)&&void 0!==C?C:0)},[]),(0,N.jsxs)("section",{className:M?tG().collapsed:"",...o,children:[(0,N.jsx)("header",{onClick:()=>_(!M),children:o.title}),(0,N.jsx)("div",{className:tG().sectionContent,style:{maxHeight:null!=E?(M?0:E)+"px":void 0},children:(0,N.jsx)("div",{ref:S,children:o.children})})]})};var tQ=M(41924);function tZ(o){let{label:C,children:M,..._}=o;return(0,N.jsxs)("div",{className:tl().iconButton+" "+(o.selected?tl().selected:""),..._,children:[(0,N.jsx)("div",{className:tl().icon,children:M}),(0,N.jsx)("div",{className:tl().label,children:C})]})}function tY(o){let{label:C,children:M,..._}=o;return(0,N.jsx)("div",{className:tl().iconButtons,..._,children:M})}var tJ=M(54925),t$=M(17794),t3=M.n(t$),t2=M(76961);let t4={render:"Render",renderUploading:"Uploading",renderFailed:"Failed"};function t5(o){var C,M,_,S,E,P;let D,L;let I=null===(_=o.enablePreview)||void 0===_||_,T=null!==(S=o.disableRender)&&void 0!==S&&S,[R,V]=(0,H.useState)(null!==(E=o.settings.bgColor)&&void 0!==E?E:{r:0,g:0,b:0,a:0}),F=(0,H.useContext)(eP.pn),O=o.animationScene.animationCamera,G=(0,H.useRef)({...o.settings});R=null!=R?R:{r:0,g:0,b:0,a:0},(0,H.useEffect)(()=>{Object.assign(G.current,o.settings),G.current.bgColor={...o.settings.bgColor},V(o.settings.bgColor)},[o.settings]);let[W,K]=(0,H.useState)(t4.render),[X,Q]=(0,H.useState)(0),[Z,Y]=(0,H.useState)(!1);function J(C){var M;if(Z||null==O)return;let _=(0,eR.Ft)(o.animationScene,O,C.width/C.height,null!==(M=o.durationTrim)&&void 0!==M?M:1/0,C.fps),S=_.c2w,E={width:C.width,height:C.height,fov:[C.fov],fps:C.fps,segment:eE.A6.getValue(),bg_color:[R.r||1e-5,R.g||1e-5,R.b||1e-5],c2w:S,no_logo:er,with_depth:er&&C.depthMaps,with_alpha:er&&C.transparentBackground,...(0,eR.HY)()};if(_.fovVertical.length>0){let o=_.fovVertical.map(o=>2*Math.atan(Math.tan(o*Math.PI/360)*C.width/C.height)*180/Math.PI*C.fovXMultiplier);E.fov=o}if(C.fovXOverride_deg&&isFinite(C.fovXOverride_deg)){let o=C.fovXOverride_deg;E.fov=[o]}let P=E.c2w.length/C.fps;async function D(){K(t4.renderUploading),Y(!0);let{uuid:C}=F,M={fps:E.fps,width:E.width,height:E.height,bgColor:{r:E.bg_color[0],g:E.bg_color[1],b:E.bg_color[2],a:1},transparentBackground:E.with_alpha,duration:P,no_logo:E.no_logo,with_depth:E.with_depth},_={capture:{uuid:C},trajectory:{schemaVersion:4,settings:{segmentation:eE.A6.getValue(),videoExport:M},keyframes:[]}};await (0,tJ.an)(_,E),K(t4.render),Q(X+1),Y(!1),o.onJobQueued()}o.onQueueJob(C),D().then(()=>{try{(0,tJ.Qc)()}catch(o){console.error(o)}}).catch(o=>{throw K(t4.renderFailed),setTimeout(()=>K(t4.render),2e3),o})}function $(){o.onSettingsChange({...G.current})}(0,H.useEffect)(()=>{let o=R;window.luma.options.background_color=[o.r,o.g,o.b,1]},[R]);let[ee,et]=(0,H.useState)(""),[er,ei]=(0,H.useState)(!1),[ea,eo]=(0,H.useState)(!1),es=async()=>{if(!t3()(t2.store.userLimits)){let o=new Date().toLocaleString("default",{month:"short"}),{render:C}=t2.store.userLimits,{left:M,used:_,pro:S}=C,E=M>0?" of ".concat(_+M):"";et("".concat(_).concat(E," renders in ").concat(o)),ei(S),eo(0===M)}};(0,H.useEffect)(()=>{es()},[null===(C=t2.store.userLimits)||void 0===C?void 0:C.render]);let eu=(0,H.useRef)(o.duration);(0,H.useEffect)(()=>{eu.current=o.duration},[o.duration]);let ec=[{w:9,h:16,heights:[640,1280,1920,3840]},{w:1,h:1,heights:[640,1080,1440,2160]},{w:5,h:4,heights:[900,1440]},{w:4,h:3,heights:[480,720,1080]},{w:16,h:9,heights:[720,1080,2160]}],[ed,eh]=(0,H.useState)(G.current.width/G.current.height),[em,ef]=(0,H.useState)(ec.every(o=>ed!=o.w/o.h)),eg=((null===(M=ec.find(o=>o.w/o.h==ed))||void 0===M?void 0:M.heights)||[]).map((o,C)=>({w:Math.round(ed*o),h:o,key:C})),ev={maxDim:3840,maxRes:8294400},ey={maxDim:1920,maxRes:2073600};if(!em){let o=eg.reduce((o,C)=>Math.abs(C.w-G.current.width)<Math.abs(o.w-G.current.width)?C:o);o.h*o.w>(er?ev.maxRes:ey.maxRes)&&o.key>=1&&(o=eg.find(C=>C.key==o.key-1));let C=G.current.width!=o.w||G.current.height!=o.h;G.current.width=o.w,G.current.height=o.h,C&&setTimeout($,0)}function ex(o){let{w:C,h:M}=o;return(0,N.jsx)(tZ,{label:"".concat(C,":").concat(M),selected:!em&&ed==C/M,onClick:()=>{ef(!1),eh(C/M)},children:(0,N.jsx)(t6,{aspectRatio:C/M})})}return er?(D=Math.min(ev.maxDim,Math.floor(ev.maxRes/G.current.height)),L=Math.min(ev.maxDim,Math.floor(ev.maxRes/G.current.width))):(D=Math.min(ey.maxDim,Math.floor(ey.maxRes/G.current.height)),L=Math.min(ey.maxDim,Math.floor(ey.maxRes/G.current.width))),(0,N.jsxs)(tW.Section,{header:"Render Video",collapsed:o.collapsed,onCollapseChange:o.onCollapseChange,children:[(0,N.jsx)(tK.Row,{style:{marginBottom:10},children:(0,N.jsxs)(tY,{label:"Aspect Ratio",children:[ec.map((o,C)=>(0,N.jsx)(ex,{w:o.w,h:o.h},C)),(0,N.jsx)(tZ,{label:"custom",selected:em,onClick:()=>{ef(!0)},children:(0,N.jsx)(t6,{aspectRatio:1,style:{border:"1px dotted white"}})})]})}),!em&&(0,N.jsx)(tK.Row,{children:(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%",gap:10},children:[(0,N.jsx)("label",{htmlFor:"resolution-select",style:{flexGrow:1,width:"100%"},children:(0,N.jsx)("b",{children:"resolution"})}),(0,N.jsx)(tQ.Ph,{id:"resolution-select",value:"".concat(G.current.width,"x").concat(G.current.height),onChange:o=>{let[C,M]=o.target.value.split("x").map(o=>parseInt(o));G.current.width=C,G.current.height=M,$()},style:{textAlign:"right",width:"auto"},children:eg.map((o,C)=>{let M=!er&&(o.w*o.h>ey.maxRes||o.w>ey.maxDim||o.h>ey.maxDim),_=er&&(o.w*o.h>ev.maxRes||o.w>ev.maxDim||o.h>ev.maxDim);return(0,N.jsxs)("option",{value:"".concat(o.w,"x").concat(o.h),disabled:M||_,children:[o.w,"x",o.h," ",M&&"(Pro)"]},C)})})]})}),em&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(tK.Row,{children:(0,N.jsx)(ta.R,{style:{width:"100%"},obj:G.current,field:"width",type:"int",min:1,max:D,units:"px",onChange:$})}),(0,N.jsx)(tK.Row,{children:(0,N.jsx)(ta.R,{style:{width:"100%"},obj:G.current,field:"height",type:"int",min:1,max:L,units:"px",onChange:$})})]}),(0,N.jsx)("hr",{}),(0,N.jsx)(tK.Row,{children:(0,N.jsx)(ta.R,{style:{width:"100%"},obj:G.current,field:"fps",type:"int",min:24,max:60,onChange:$})}),(null===(P=o.showDuration)||void 0===P||P)&&(0,N.jsx)(tK.Row,{children:(0,N.jsx)(ta.R,{style:{width:"100%"},obj:eu,field:"current",label:"duration",type:"float",min:1,max:o.durationMax,units:"s",disabled:o.durationDisableEdit,onChange:o.onDurationChange})}),(0,N.jsxs)(tK.Row,{children:[(0,N.jsx)("label",{htmlFor:"background",children:(0,N.jsx)("b",{children:"background"})}),(0,N.jsx)("input",{id:"background",type:"color",value:"#"+new U.Color(R.r,R.g,R.b).getHexString(),onChange:o=>{let C=new U.Color(o.target.value);G.current.bgColor.r=C.r,G.current.bgColor.g=C.g,G.current.bgColor.b=C.b,V({r:C.r,g:C.g,b:C.b,a:R.a}),$()}})]}),er&&(0,N.jsx)(tK.Row,{children:(0,N.jsx)(tj,{label:"depth maps",options:["off","on"],value:o.settings.depthMaps?"on":"off",onChange:o=>{G.current.depthMaps="on"===o,$()},style:{justifyContent:"flex-end",width:"100%"}})}),I?(0,N.jsx)(tK.Row,{style:{marginTop:"20px"},children:(0,N.jsx)("button",{onClick:o.onPreview,children:"Preview"})}):null,(0,N.jsx)(tK.Row,{style:{marginTop:"20px"},children:(0,N.jsx)("button",{onClick:()=>J(G.current),disabled:ea||T,children:ea?"Render limit has been reached":W})}),(0,N.jsx)(tK.Row,{style:{textAlign:"center",fontSize:10,marginTop:10,opacity:.5},children:(0,N.jsx)("label",{children:ee})}),(0,N.jsx)(tK.Row,{style:{textAlign:"center",fontSize:10,marginTop:4,marginBottom:8,opacity:.5},children:(0,N.jsx)("label",{children:er?"Pro: no logo, 4k renders, depth":""})})]})}function t6(o){let C="20px";return(0,N.jsx)("div",{style:{width:o.aspectRatio<1?"auto":C,height:o.aspectRatio<1?C:"auto",maxWidth:38,maxHeight:38,border:"1px solid white",aspectRatio:o.aspectRatio,...o.style}})}var t7=M(17688),t9=M(23363),t8=M.n(t9);function ne(o){var C,M,_,S,E,P,D,L;let I,T;let[R,V]=(0,H.useState)(null!==(C=o.firstPersonCamera.useOrbitTransform)&&void 0!==C&&C);(0,H.useEffect)(()=>{let C=setInterval(()=>{var C;return V(null!==(C=o.firstPersonCamera.useOrbitTransform)&&void 0!==C&&C)},1e3/60);return()=>clearInterval(C)},[o.firstPersonCamera]);let F=o.object;(0,eR.xG)(F)?(T=(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(eU.xmR,{}),(0,N.jsx)("div",{children:F.name})]}),I=(0,N.jsx)(nt,{object:F,useOrbitTransform:R,locked:o.locked,onUnlock:o.onUnlock,onKeyframeChange:o.onKeyframeChange,onKeyframeChangeEnd:o.onKeyframeChangeEnd})):(0,eR.al)(F)?(T=(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(e2,{keyframe:F,dragging:!1,selected:!0,smoothnessMultiplier:1-o.settings.tension,style:{position:"unset",display:"block",margin:0,transform:"rotate(45deg) scale(0.6)",cursor:"pointer"},pollForPositionChange:!0}),(0,N.jsx)("div",{children:"Keyframe"})]}),I=(0,N.jsx)(nt,{object:F,useOrbitTransform:R,locked:o.locked,onUnlock:o.onUnlock,onKeyframeChange:o.onKeyframeChange,onKeyframeChangeEnd:o.onKeyframeChangeEnd})):null!=F.SelectionContextMenu&&"function"==typeof F.SelectionContextMenu?(T=null!==(E=(0,N.jsx)(F.SelectionContextMenuHeader,{}))&&void 0!==E?E:"".concat(null!==(S=null!==(_=null!==(M=F.name)&&void 0!==M?M:F.type)&&void 0!==_?_:F.constructor.name)&&void 0!==S?S:F),I=(0,N.jsx)(F.SelectionContextMenu,{})):(T="Unknown object: ".concat(null!==(L=null!==(D=null!==(P=F.name)&&void 0!==P?P:F.type)&&void 0!==D?D:F.constructor.name)&&void 0!==L?L:F),I=null);let O=(0,N.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",alignContent:"center",gap:"10px",height:"16px"},children:T});return(0,N.jsx)(tW.Section,{header:O,collapsed:o.collapsed,children:I})}function nt(o){let C=(0,H.useMemo)(()=>o.object.clone(),[o.object.id,(0,eR.al)(o.object)]),M=(0,eR.al)(o.object)?C.copy(o.object):o.object,_=(0,H.useMemo)(()=>({get azimuth(){return(0,t7.ZY)(M.azimuth)},set azimuth(value){M.azimuth=(0,t7.Id)(value),M.updateCartesianFromOrbit()},get elevation(){return(0,t7.ZY)(M.elevation)},set elevation(value){M.elevation=(0,t7.Id)(value),M.updateCartesianFromOrbit()},get radius(){return M.radius},set radius(value){M.radius=value,M.updateCartesianFromOrbit()},get roll(){return(0,t7.ZY)((0,eR.tr)(M.quaternion))},set roll(value){let o=(0,eR.tr)(M.quaternion),C=(0,t7.Id)(value)-o,_=new U.Vector3(0,0,-1).applyQuaternion(M.quaternion),S=new U.Quaternion().setFromAxisAngle(_,C);M.quaternion.premultiply(S),M.updateOrbitFromCartesian()},get pitch(){return(0,t7.ZY)((0,eR.Es)(M.quaternion))},set pitch(value){let o=(0,eR.Es)(M.quaternion),C=(0,t7.Id)(value)-o,_=new U.Vector3(1,0,0).applyQuaternion(M.quaternion),S=new U.Quaternion().setFromAxisAngle(_,C);M.quaternion.premultiply(S),M.updateOrbitFromCartesian()},get yaw(){return(0,t7.ZY)((0,eR.tE)(M.quaternion))},set yaw(value){let o=(0,eR.tE)(M.quaternion),C=(0,t7.Id)(value)-o,_=new U.Vector3(0,1,0).applyQuaternion(M.quaternion),S=new U.Quaternion().setFromAxisAngle(_,C);M.quaternion.premultiply(S),M.updateOrbitFromCartesian()}}),[M]);function S(){(0,eR.al)(M)&&o.onKeyframeChange(M)}function E(){(0,eR.al)(M)&&o.onKeyframeChangeEnd(M)}return(0,N.jsxs)("div",{children:[o.locked&&(0,N.jsx)(eU.khe,{style:{position:"absolute",top:"35px",left:"50%",transform:"translateX(-50%)"}}),o.locked&&(0,N.jsx)("div",{className:t8().lockOverlay,children:(0,N.jsxs)("button",{onClick:()=>{var C;return null===(C=o.onUnlock)||void 0===C?void 0:C.call(o,o.object)},children:[(0,N.jsx)(eU.Jot,{})," Edit"]})}),(0,N.jsx)(ta.R,{obj:M,field:"focalLength",label:"focal length",min:0,units:"mm",onChange:S,onChangeEnd:E}),(0,N.jsx)("hr",{}),o.useOrbitTransform&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ta.R,{obj:_,field:"radius",label:"distance",onChange:S,onChangeEnd:E}),(0,N.jsx)("hr",{}),(0,N.jsx)(ta.R,{obj:_,field:"azimuth",units:"\xb0",changeDelta:50,onChange:S,onChangeEnd:E}),(0,N.jsx)(ta.R,{obj:_,field:"elevation",units:"\xb0",changeDelta:50,onChange:S,onChangeEnd:E})]}),!o.useOrbitTransform&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ta.R,{obj:M.position,field:"x",changeDelta:1,onChange:S,onChangeEnd:E}),(0,N.jsx)(ta.R,{obj:M.position,field:"y",changeDelta:1,onChange:S,onChangeEnd:E}),(0,N.jsx)(ta.R,{obj:M.position,field:"z",changeDelta:1,onChange:S,onChangeEnd:E})]}),(0,N.jsx)("hr",{}),(0,N.jsx)(ta.R,{obj:_,field:"roll",label:"roll",units:"\xb0",changeDelta:30,onChange:S,onChangeEnd:E}),(0,N.jsx)(ta.R,{obj:_,field:"pitch",label:"pitch",units:"\xb0",changeDelta:30,onChange:S,onChangeEnd:E}),(0,N.jsx)(ta.R,{obj:_,field:"yaw",label:"yaw",units:"\xb0",changeDelta:30,onChange:S,onChangeEnd:E}),(0,eR.al)(M)&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("hr",{}),(0,N.jsx)(ta.R,{obj:M,field:"smoothness",min:0,max:1,onChange:S,onChangeEnd:E})]})]})}function nn(o){let{menuPosition:C,...M}=o;return(0,N.jsx)(tW,{...M,style:{position:"absolute",top:"100px",right:"right"===C?"20px":"unset",left:"left"===C?"20px":"unset",overflowY:"visible",...o.style}})}function nr(o){let C=(0,H.useContext)(eP.pn);return(0,N.jsx)(tW.Section,{header:"Trajectories",collapsed:o.collapsed,onCollapseChange:o.onCollapseChange,children:(0,N.jsxs)(tY,{children:[(0,N.jsx)(tZ,{label:"Orbit",selected:o.currentTemplateType===I.Type.Orbit,onClick:()=>{var M;let _=new U.Vector3(2,1,0);null===(M=C.initialPose)||void 0===M||M.decompose(_,new U.Quaternion,new U.Vector3);let S=(0,eR.aL)(_),E=new U.Vector2(_.x,_.z).length(),P={type:I.Type.Orbit,radius:E,height:_.y,rotation_radians:S.azimuth,target:{x:0,y:0,z:0},duration:10,focalLength:20,direction:-1};o.onCreateTemplate(P)},children:(0,N.jsx)(tM,{width:"100%",height:"100%"})}),(0,N.jsx)(tZ,{label:"Oscillate",selected:o.currentTemplateType===I.Type.Oscillate,onClick:()=>{var M;let _=new U.Vector3(2,1,0);null===(M=C.initialPose)||void 0===M||M.decompose(_,new U.Quaternion,new U.Vector3);let S=(0,eR.aL)(_),E={type:I.Type.Oscillate,duration:10,focalLength:20,amplitudeAzimuth:.12*Math.PI,amplitudeElevation:.04*Math.PI,viewPosition:S,target:{x:0,y:0,z:0}};o.onCreateTemplate(E)},children:(0,N.jsx)(tz,{width:"100%",height:"100%"})}),(0,N.jsx)(tZ,{label:"Custom",selected:null==o.currentTemplateType,onClick:()=>{o.onCreateTemplate(null)},children:(0,N.jsx)(tc,{width:"100%",height:"100%"})})]})})}var ni=M(24994),na=M(45766),no=M.n(na);let ns=(0,H.forwardRef)((o,C)=>{var M,_;let[S,E]=(0,H.useState)(!1),[P,D]=(0,H.useState)(0),[L,I]=(0,H.useState)(-1),T=(0,H.useRef)(null),R=(0,H.useRef)(null),V=(0,H.useRef)(null),[F,O]=(0,H.useState)(0),U=(0,H.useRef)(P);U.current=P,(0,H.useImperativeHandle)(C,()=>({isScrubbing:S,setPosition:D,selectKeyframe:Z}),[S,D]);let G=(0,H.useRef)(null),W=(0,H.useRef)(null),K=(0,H.useRef)(null),X=(0,H.useRef)(null),Q=(0,H.useRef)(-1);function Z(C,M){if(C!==Q.current){var _;Q.current=C,I(C),null===(_=o.onSelectKeyframe)||void 0===_||_.call(o,C,null!=M&&M)}}function Y(){let C=U.current;if(null!=o.keyframes&&isFinite(C)){for(let M of o.keyframes)if(.01>Math.abs(nu(M,o.duration_s)-C)){Z(M.id);return}Z(-1)}}function J(C){var M;null!=o.keyframes&&(null===(M=o.onKeyframesChange)||void 0===M||M.call(o,o.keyframes.filter(o=>o.id!==C)),Z(-1))}return(0,H.useEffect)(()=>Y(),[P,o.keyframes]),(0,H.useEffect)(()=>{if(!1===o.interactive)return;let C=new ni.Z(T.current,{disableDefaultBehavior:!0,autoCapturePointer:!1});function M(o){G.current=o.pointerId,E(!0),_(o),o.target.setPointerCapture(o.pointerId)}function _(C){let M=Math.min(Math.max((C.clientX-T.current.getBoundingClientRect().left)/T.current.clientWidth,0),1)||0;D(M),o.onScrub(M)}function S(o){let C=o.target,M=parseInt(C.dataset.id);C.setPointerCapture(o.pointerId),X.current=o.clientX,W.current=o.pointerId,K.current=M,Z(M,!0),O(0)}function P(C){var M;if(null==K.current||null==W.current)return;let _=(C.clientX-X.current)/T.current.clientWidth||0;O(_=I(null===(M=o.keyframes)||void 0===M?void 0:M.find(o=>o.id===K.current),_))}function L(C){if(null==K||null==W.current||null==o.keyframes)return;let M=(C.clientX-X.current)/T.current.clientWidth||0,_=o.keyframes.find(o=>o.id===K.current);M=I(_,M);let S=nu(_,o.duration_s)+M||0,E=o.keyframes.map(C=>{if(C.id!==K.current)return C;{let M=C.clone(!0);return M.t_s=S*o.duration_s,M}});if(0!==M){var P;null===(P=o.onKeyframesChange)||void 0===P||P.call(o,E)}W.current=null,K.current=null,X.current=null,O(0),D(S),o.onScrub(S)}function I(C,M){if(null!=C&&C.keyframeType==eI.yX.Loop){let _=nu(o.keyframes[o.keyframes.length-2],o.duration_s)+.01,S=nu(C,o.duration_s)+M;S<_&&(M+=_-S)}else{let _=o.keyframes[o.keyframes.length-1];if(_.keyframeType==eI.yX.Loop&&null!=C&&C.id!==_.id){let _=.99,S=nu(C,o.duration_s)+M;S>_&&(M-=S-_)}}return M}function F(o){return o instanceof HTMLElement&&!!o.dataset.keyframe}function N(C){var M,_;if(C.target instanceof HTMLInputElement)return;let S=!1;("Delete"===C.key||"Backspace"===C.key&&-1!==Q.current)&&(J(Q.current),S=!0),"i"===C.key&&(null===(M=o.onInsertKeyframe)||void 0===M||M.call(o,U.current),S=!0),"e"===C.key&&-1!==Q.current&&(null===(_=o.onEditKeyframe)||void 0===_||_.call(o,Q.current),S=!0),S&&(C.preventDefault(),C.stopPropagation())}return C.attachEventListeners(),C.events.pointerDown.addListener(o=>{let C=o.target===T.current||o.target===R.current||o.target===V.current;o.isPrimary&&null==G.current&&C?M(o):o.isPrimary&&F(o.target)&&S(o)}),C.events.pointerMove.addListener(o=>{o.pointerId===G.current?_(o):o.pointerId===W.current&&P(o)}),C.events.globalPointerUp.addListener(o=>{o.pointerId===G.current?(G.current=null,_(o),E(!1)):o.pointerId===W.current&&L(o),F(o.target)&&parseInt(o.target.dataset.id)===Q.current||Y()}),window.addEventListener("keydown",N),()=>{C.removeEventListeners(),window.removeEventListener("keydown",N)}},[o.keyframes,o.interactive,o.duration_s]),(0,N.jsxs)("div",{ref:T,className:no().bar,style:o.style,children:[(0,N.jsx)("div",{ref:R,className:no().barFill,style:{width:"".concat(100*P,"%")}}),null===(M=o.keyframes)||void 0===M?void 0:M.map((C,M)=>{let _=nu(C,o.duration_s)+(C.id===K.current?F:0);return(0,N.jsx)(e2,{keyframe:C,smoothnessMultiplier:o.smoothnessMultiplier,style:{left:"".concat(100*_,"%")},dragging:K.current===C.id,selected:L===C.id},C.id)}),(null==o.keyframes||0===o.keyframes.length)&&(0,N.jsx)("div",{ref:V,className:no().handle+" "+(null!=o.keyframes?no().thin:"")+" "+(S?no().dragging:""),style:{display:null!=o.keyframes&&o.keyframes.length<1?"none":"",left:"".concat(100*P,"%")}}),null!=o.keyframes&&o.keyframes.length>0?(0,N.jsx)(nl,{selectedKeyframeId:L,keyframes:o.keyframes,duration_s:o.duration_s,keyframeDragDelta:F,keyframeDragId:K.current,position:P,showButtons:null===(_=o.showKeyframeButtons)||void 0===_||_,onDeleteKeyframe:J,onInsertKeyframe:C=>{var M;return null===(M=o.onInsertKeyframe)||void 0===M?void 0:M.call(o,C)},onEditKeyframe:C=>{var M;return null===(M=o.onEditKeyframe)||void 0===M?void 0:M.call(o,C)}}):null,o.children]})});function nl(o){let C,M=o.selectedKeyframeId,_=o.keyframes.find(C=>C.id===o.selectedKeyframeId),S=o.keyframeDragDelta,E=o.keyframeDragId;return null!=_?(C=nu(_,o.duration_s),E===M&&(C+=S)):C=o.position,(0,N.jsxs)("div",{className:no().keyframeUI,children:[(0,N.jsxs)("div",{className:no().keyframeButtons,style:{left:"".concat(100*C,"%"),opacity:-1!==M&&o.showButtons?1:0,pointerEvents:-1!==M&&o.showButtons?"all":"none"},children:[(0,N.jsxs)("div",{onClick:()=>o.onEditKeyframe(M),title:"Edit keyframe (e)",children:["Edit",(0,N.jsx)("span",{className:no().keyboardShortcut,children:"e"})]}),(0,N.jsxs)("div",{onClick:()=>o.onDeleteKeyframe(M),title:"Delete keyframe (backspace)",children:["Delete",(0,N.jsx)("span",{className:no().keyboardShortcut,children:"⌫"})]})]}),(0,N.jsx)("div",{className:no().keyframeButtons,style:{left:"".concat(100*C,"%"),opacity:-1===M&&o.showButtons?1:0,pointerEvents:-1===M&&o.showButtons?"all":"none"},onClick:()=>o.onInsertKeyframe(o.position),title:"Insert keyframe (i)",children:(0,N.jsxs)("div",{children:["Insert",(0,N.jsx)("span",{className:no().keyboardShortcut,children:"i"})]})})]})}function nu(o,C){return o.t_s/C||0}var nc=M(30295),nd=M.n(nc),nh=o=>{let{className:C,...M}=o,_="".concat(nd().pageTabs," ").concat(C||"");return(0,N.jsx)("div",{className:_,...M})},np=M(37262),nm=M.n(np),nf=o=>{let{className:C,...M}=o,_="".concat(nm().focusButtons," ").concat(C||"");return(0,N.jsx)("div",{className:_,...M})},ng=M(17886),nv=M.n(ng),ny=o=>{let{className:C,...M}=o,_="".concat(nv().iconButton," ").concat(C||"");return(0,N.jsx)("div",{className:_,...M})};!function(o){o[o.Overview=0]="Overview",o[o.FirstPerson=1]="FirstPerson"}(T||(T={})),function(o){o[o.ReplaceHistory=0]="ReplaceHistory",o[o.AppendHistory=1]="AppendHistory"}(R||(R={}));let nx=(0,H.forwardRef)((o,C)=>{var M,_,S,E,T,R,V,F,O;let G,W;let K=o.animationScene.animationMixer,[X,Q]=(0,H.useState)(!1),Z=(0,H.useRef)(X);Z.current=X;let[Y,J]=(0,H.useState)(1),$=(0,H.useRef)(Y);$.current=Y;let[ee,et]=(0,H.useState)(!1),[er,ei]=(0,H.useState)(-1),[ea,eo]=(0,H.useState)(null),[es,eu]=(0,H.useState)(-1);(0,H.useImperativeHandle)(C,()=>({setInitialState:(o,C)=>{eL(o.settings,o.keyframes,o.templateState,C),eC()}}),[]);{let C=(0,H.useRef)(null);G=(0,H.useMemo)(()=>(null!=C.current&&C.current.dispose(),new e9({onSelect:o=>{eo(o),(0,eR.al)(o)&&(K.setTime(o.t_s),Q(!1))},onKeyframeChange:C=>{o.onKeyframesChange(ev.current.map(o=>o.id===C.id?C:o))},onKeyframeChangeEnd(o){ez(ev.current.map(C=>C.id===o.id?o:C))}})),[]),C.current=G,(0,H.useEffect)(()=>()=>{var o;return null===(o=C.current)||void 0===o?void 0:o.dispose()},[])}(0,H.useEffect)(()=>G.dispose,[]);let[ec,ed]=(0,H.useState)(null),eh=(0,H.useRef)(ec);eh.current=ec;let em=o=>{eh.current=o,ed(o)};{let C=(0,H.useRef)(null),M=(0,H.useRef)(null);W=(0,H.useMemo)(()=>{var _,S;if(null===(_=M.current)||void 0===_||_.removeFromParent(),null==ec)return null;{let _=C.current;return(null==_?void 0:_.type)!==ec.type||null==_?(null==(_=I.createEditorObject(ec))||_.events.onChange.addListener(()=>{em(_.getState())}),null==_||_.events.onChangeEnd.addListener(()=>{eF(_.getState())}),null==_||_.events.onBakeToKeyframes.addListener(()=>{eL(eg.current,I.getKeyframes(_.getState()),null)}),M.current=null!==(S=null==_?void 0:_.editorGizmo)&&void 0!==S?S:null):_.setState(ec),null!=M.current&&o.animationScene.add(M.current),_}},[ec]),(0,H.useEffect)(()=>()=>{var o;null===(o=M.current)||void 0===o||o.removeFromParent()},[]),C.current=W,null!=C.current&&C.current.setEditEnabled(0===Y)}null!=ec&&(ea=W);let ef=(0,H.useMemo)(()=>null==ec?o.settings:{...o.settings,...I.getCurveSettings(ec)},[o.settings,null==ec?void 0:ec.type]),eg=(0,H.useRef)(ef);eg.current=ef,o.animationScene.animationCamera.useOrbitTransform=ef.motionMode===P.Orbit,eE.A6.getValue()!==ef.segmentation&&eE.A6.setValue(ef.segmentation),(0,H.useEffect)(()=>eE.A6.watch(o=>{o!==eg.current.segmentation&&eV({...eg.current,segmentation:o})},eK.j.OnUserChange,!1).unwatch,[]),o.animationPlayingRef.current=X,G.visible=!X||0===Y,G.setEditEnabled(!X&&0===Y),G.showAnimationCameraVisual=0===Y,(0,H.useMemo)(()=>G.setSelection(ea,X),[ea,X]);let ev=(0,H.useRef)([]),ey=(0,H.useRef)([]),ex=(0,H.useRef)({}),ew=(0,H.useMemo)(()=>{var C;let M=null!=ec?I.getKeyframes(ec):null,_=ey.current;o.keyframes;let S=eI.Or.processKeyframes(null!==(C=null!=M?M:o.keyframes)&&void 0!==C?C:[],ef.loop);if(o.animationScene.updateAnimationFromKeyframes(S,ef),0===S.length){let C=eI.Or.getKeyframeFromLumaCamera(0,o.firstPersonCamera.focalLength);o.firstPersonCamera.setFromKeyframe(C)}else 1===S.length&&o.firstPersonCamera.setFromKeyframe(S[0]);if(G.update(o.animationScene,S,null==ec),o.animationScene.add(G),_.length===S.length){let o=nC(_),C=nC(S);if(o!==C){let M=C/o;K.setTime(K.time*M)}}return S},[o.keyframes,ec,ef]);ev.current=ew,ey.current=ew,ex.current={...ef},ew.length<=1&&X&&Q(!1);let eb=nC(ew);function eC(C){let M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new U.Vector3,_=new U.Box3;for(let o of ev.current)_.expandByPoint(o.position);let S=o.editorCamera,E=S.clone(),P=o.editorCamera.position.clone(),D=P.length(),L=Math.max(1.5*_.clampPoint(null!=C?C:P,new U.Vector3).length(),.5);D<L&&isFinite(L)&&(E.position.copy((null!=C?C:P).clone().setLength(L)),E.lookAt(M),E.target.copy(M)),S.animateTo(E)}function eM(C){var M;let _=nM(ew,Y,ef,o.animationScene,o.firstPersonCamera,C),S=ew.find(o=>o.keyframeType===eI.yX.Loop);if(null!=S&&_.t_s>S.t_s){let o=S.t_s;S.t_s=_.t_s,_.t_s=o}console.log("added keyframe",_.id,_.t_s,_),ez([...ew,_]),K.setTime(_.t_s),null===(M=o.scrubBarRef.current)||void 0===M||M.selectKeyframe(_.id)}function e_(){let o=window.confirm("You are about to clear ".concat(ew.length," keyframes, please make sure to download the camera path keyframes if needed for future use."));return o&&ez([]),o}function eS(o,C){C.id=o.id,ez(ew.map(M=>M===o?C:M))}o.beforeRenderRef.current=()=>{null==W||W.tick()},(0,H.useEffect)(()=>{let C=o.interactionManager.events.keyDown.addListener(o=>{let C=!1;"Space"!==o.code||ee?"z"===o.key&&(o.ctrlKey||o.metaKey)&&!o.shiftKey?(eN(),C=!0):("y"===o.key&&(o.ctrlKey||o.metaKey)&&!o.shiftKey||"z"===o.key&&(o.ctrlKey||o.metaKey)&&o.shiftKey)&&(eB(),C=!0):(Q(!Z.current&&ev.current.length>1),C=!0),C&&(o.preventDefault(),o.stopPropagation())},o.eventPriority);return()=>C.remove()},[ee,o.eventPriority]),(0,H.useEffect)(()=>{function C(){if(1===$.current&&!Z.current){let C=eI.Or.getKeyframeFromLumaCamera(0,0);o.firstPersonCamera.setFromKeyframe(C,!1)}}return window.addEventListener("lumaCameraChange",C),()=>window.removeEventListener("lumaCameraChange",C)},[]),(0,H.useEffect)(()=>{let C=0===Y?null:o.firstPersonCamera;if(-1===es)eo(C);else{let o=ew.find(o=>o.id===es);o?eo(o):eo(C)}},[es,ew,Y]),(0,H.useMemo)(()=>{0===Y?(o.overrideCameraRef.current=null,eC(),et(!1)):(o.overrideCameraRef.current=o.firstPersonCamera,window.luma.camera.origin=[0,0,0]);let C=K.time;K.setTime(0),K.setTime(1),K.setTime(C)},[Y]);let ej=()=>{var C,M;(0,eq.Hy)(L.serializeState(ef,ew,ec),"luma-".concat(null!==(M=null===(C=o.captureName)||void 0===C?void 0:C.trim())&&void 0!==M?M:"capture","-camera-path"))},ek=(0,H.useRef)([]),eD=(0,H.useRef)(1);function eL(C,M,_){let S=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;0===S?(ek.current=[{settings:eW()(C),keyframes:[...M],templateState:null!=_?eW()(_):null}],eD.current=0):(ek.current=ek.current.slice(0,eD.current+1),ek.current.push({settings:eW()(C),keyframes:[...M],templateState:null!=_?eW()(_):null}),eD.current=ek.current.length-1),o.onKeyframesChange(M),o.onSettingsChange(C),em(_),eg.current=C,ev.current=M}function ez(o,C){return eL(eg.current,o,eh.current,C)}let eT=(0,H.useRef)();function eA(C,M){o.onSettingsChange(C),null!=eT.current&&clearTimeout(eT.current),eT.current=window.setTimeout(()=>{eL(C,ev.current,eh.current,M)},100)}function eV(o,C){eL(o,ev.current,eh.current,C)}function eF(o,C){eL(eg.current,ev.current,o,C)}function eO(C){o.onKeyframesChange(C.keyframes),o.onSettingsChange(C.settings),em(C.templateState)}function eN(){let o=eD.current-1,C=ek.current[o];null!=C&&(eD.current--,eO(C))}function eB(){let o=eD.current+1,C=ek.current[o];null!=C&&(eD.current++,eO(C))}let eG=(0,H.useContext)(eP.pn);function eX(o){let C=ev.current,M=C.find(C=>C.id===o);(null==M?void 0:M.keyframeType)===eI.yX.Loop&&(o=C[0].id),ei(o),et(!0),J(1)}(0,H.useEffect)(()=>{var o,C;L.writeLocalStorageDebounce(null!==(C=null!==(o=eG.slug)&&void 0!==o?o:eG.uuid)&&void 0!==C?C:null,L.serializeState(ef,ew,ec))},[ec,ew,ef]);let[eZ,eY]=(0,H.useState)("template"),eJ=null!=ea&&(!X||null!=ec),e$=ee||!o.showUI||0===Y&&null!=ec,e0=!0;return(0,N.jsxs)(N.Fragment,{children:[1===Y&&(0,N.jsx)(tB,{videoWidth:ef.width,videoHeight:ef.height}),eJ&&(0,N.jsx)(nn,{menuPosition:"left",style:{display:o.showUI?"":"none"},children:(0,N.jsx)(ne,{object:ee?o.firstPersonCamera:ea,firstPersonCamera:o.firstPersonCamera,locked:!1,onUnlock:o=>{(0,eR.al)(o)&&eX(o.id)},onKeyframeChange:C=>{o.onKeyframesChange(ev.current.map(o=>o.id===C.id?C:o))},onKeyframeChangeEnd:o=>{ez(ev.current.map(C=>C.id===o.id?o:C))},settings:ef})}),(0,N.jsxs)(nn,{menuPosition:"right",style:{display:o.showUI&&!ee?"":"none"},children:[(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",gap:"10px"},children:[(0,N.jsx)(tH,{label:"Import Path",onImportFile:o.onImportFile,style:{flexGrow:0===ew.length?1:0}}),ew.length>0&&(0,N.jsxs)("button",{onClick:ej,children:[(0,N.jsx)(eU._8t,{})," ",(0,N.jsx)("span",{children:"Save Path"})]})]}),(0,N.jsx)(nr,{currentTemplateType:null!==(R=null==ec?void 0:ec.type)&&void 0!==R?R:null,onCreateTemplate:o=>{if(null!=ec||!(ew.length>0)||e_()){if(null==o){let o={interpolation:D.Spline,tension:0,loop:!1,motionMode:P.Freeform};eL({...ef,...o},[],null,1),J(1)}else if(eF(o),0===Y){if(null!=eG.initialPose){var C,M,_,S;let E=new U.Vector3;null===(C=eG.initialPose)||void 0===C||C.decompose(E,new U.Quaternion,new U.Vector3);let P=new U.Vector3;null!=o.target&&(P.x=null!==(M=o.target.x)&&void 0!==M?M:0,P.y=null!==(_=o.target.y)&&void 0!==_?_:0,P.z=null!==(S=o.target.z)&&void 0!==S?S:0),eC(E,P)}else eC()}}},collapsed:"template"!==eZ,onCollapseChange:()=>eY("template")}),null==ec&&ew.length>0&&(0,N.jsx)(tX,{collapsed:"motion"!==eZ,onCollapseChange:()=>eY("motion"),settings:ef,onSettingsChange:o=>{eA(o)},duration:eb,durationMax:null!==(V=null===(_=t2.store.userLimits)||void 0===_?void 0:null===(M=_.render)||void 0===M?void 0:M.maxDuration)&&void 0!==V?V:240,onDurationChange:C=>{if(C!==eb){let M=C/eb;M=isFinite(M)?M:1;let _=ew.map(o=>{let C=o.clone(!0);return C.t_s=o.t_s*M,C});o.onKeyframesChange(_)}},onDurationChangeEnd:o=>{ez(ew)}}),ew.length>0&&(0,N.jsx)(t5,{animationScene:o.animationScene,onJobQueued:o.onJobQueued,onQueueJob:o.onQueueJob,settings:ef,onSettingsChange:o=>{eA(o)},showDuration:!1,duration:eb,durationMax:null!==(F=null===(E=t2.store.userLimits)||void 0===E?void 0:null===(S=E.render)||void 0===S?void 0:S.maxDuration)&&void 0!==F?F:240,onDurationChange:o=>{},enablePreview:!1,disableRender:0===ew.length,collapsed:"render"!==eZ,onCollapseChange:()=>eY("render")})]}),(0,N.jsxs)(nh,{children:[e0&&(0,N.jsx)("div",{className:0===Y?eQ().active:"",onClick:()=>J(0),children:"Overview"}),(0,N.jsx)("div",{className:1===Y?eQ().active:"",onClick:()=>J(1),children:"First Person"})]}),(0,N.jsxs)("div",{className:eQ().timelineContainer,style:{display:e$?"none":""},children:[(0,N.jsx)(ns,{ref:o.scrubBarRef,style:{position:"relative",top:"unset",left:"unset",right:"unset",bottom:"unset",flexGrow:ew.length>1?1:0,display:ew.length>0?"":"none",transition:"flex-grow 0.25s ease-out"},duration_s:nC(ew),interactive:!ee&&o.showUI,onScrub:o=>{K.setTime(o*nC(ew))},keyframes:null!=ec?void 0:ew,smoothnessMultiplier:1-(null!==(O=null===(T=eg.current)||void 0===T?void 0:T.tension)&&void 0!==O?O:0),onKeyframesChange:o=>{eg.current.loop&&null==o.find(o=>o.keyframeType===eI.yX.Loop)&&eV({...eg.current,loop:!1}),ez(o)},onSelectKeyframe:(0,H.useCallback)((o,C)=>{let M=ew.find(C=>C.id===o);null!=M&&C&&(K.setTime(M.t_s),Q(!1)),eu(o)},[ew]),onInsertKeyframe:C=>{if(ew.length<2)eM();else{let M=nC(ew),_=C*M,S=ew.find(o=>o.t_s===_);S?1===Y?eS(S,eI.Or.getKeyframeFromLumaCamera(_,o.firstPersonCamera.focalLength)):eS(S,nb(o.animationScene,_)):eM(C*M)}},onEditKeyframe:o=>{eX(o)},showKeyframeButtons:!X,children:ew.length>=2&&(0,N.jsxs)("div",{className:eQ().timelineAxis,children:[(0,N.jsx)("div",{className:eQ().axisTick,style:{left:"0%"},children:"0 s"}),(0,N.jsxs)("div",{className:eQ().axisTick,style:{left:"50%"},children:[(.5*eb).toFixed(1)," s"]}),(0,N.jsxs)("div",{className:eQ().axisTick,style:{left:"100%"},children:[eb.toFixed(1)," s"]})]})}),(0,N.jsxs)("div",{style:{marginLeft:"30px",display:"flex",flexDirection:"row"},children:[1===Y&&null==ec&&(0,N.jsxs)("button",{onClick:()=>eM(),title:"Add keyframe to the end of the animation using the current camera position",children:[(0,N.jsx)(eU.pOD,{}),(0,N.jsx)("span",{children:"Add Keyframe"})]}),ew.length>0&&null==ec&&(0,N.jsxs)("button",{onClick:e_,style:{padding:10,paddingLeft:20,paddingRight:20,marginLeft:10},title:"Clear all keyframes",children:[(0,N.jsx)(eH.pJ,{style:{marginRight:2.5}}),(0,N.jsx)("span",{children:"Clear"})]})]})]}),(0,N.jsx)(nf,{style:{display:e$?"none":""},children:(0,N.jsx)(ny,{className:"play_pause",onClick:()=>Q(!X),style:{display:ew.length>1?"":"none"},title:"Play/Pause (space bar)",children:X?(0,N.jsx)(eU.fpf,{width:24,height:24}):(0,N.jsx)(eU.o1U,{width:24,height:24})})}),ee&&o.showUI?(0,N.jsx)(nw,{interactionManager:o.interactionManager,eventPriority:o.eventPriority+1,onCancel:()=>et(!1),onSave:()=>{let C=ew.find(o=>o.id===er);if(null!=C){let M=eI.Or.getKeyframeFromLumaCamera(C.t_s,o.firstPersonCamera.focalLength);M.smoothness=C.smoothness,eS(C,M)}et(!1)},firstPersonCamera:o.firstPersonCamera,keyframe:ew.find(o=>o.id===er),settings:ef}):null]})});function nw(o){if(null==o.keyframe)return o.onCancel(),null;(0,H.useEffect)(()=>{let C=o.interactionManager.events.keyDown.addListener(C=>{let M=!1;"Escape"===C.key?(o.onCancel(),M=!0):"Enter"===C.key&&(o.onSave(),M=!0),M&&(C.preventDefault(),C.stopPropagation())},o.eventPriority);return()=>C.remove()},[]);let C=1-o.settings.tension;return(0,N.jsxs)(nf,{children:[(0,N.jsx)(e2,{keyframe:{position:o.firstPersonCamera.position,target:o.firstPersonCamera.target,id:o.keyframe.id,keyframeType:o.keyframe.keyframeType,smoothness:o.keyframe.smoothness},pollForPositionChange:!0,selected:!0,smoothnessMultiplier:C,dragging:!1,style:{margin:0,top:"-50px",width:"30px",height:"30px",left:"50%"}}),(0,N.jsx)(ny,{className:"cancel",onClick:o.onCancel,title:"Cancel (esc)",children:(0,N.jsx)(eH.Tw,{})}),(0,N.jsx)(ny,{className:"save",onClick:o.onSave,title:"Save (enter)",children:(0,N.jsx)(eH.nQ,{})})]})}function nb(o,C){let M;let _=o.animationCamera,S=_.parent;_.removeFromParent();let E=_.clone();E.name=_.name,S.add(E);{let _=new U.AnimationMixer(o),S=o.animations,P=_.clipAction(S[0]);P._updateTime=o=>P.time+=o,P.play(),_.setTime(C),E.updateMatrixWorld(!0);let D=E.getWorldPosition(new U.Vector3),L=E.getWorldQuaternion(new U.Quaternion);M=eI.Or.createKeyframe(C,D,L,E.target,E.getFocalLength())}return S.remove(E),S.add(_),M}function nC(o){var C,M;return null!==(M=null===(C=o[o.length-1])||void 0===C?void 0:C.t_s)&&void 0!==M?M:0}function nM(){let o,C=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],M=arguments.length>1?arguments[1]:void 0,_=arguments.length>2?arguments[2]:void 0,S=arguments.length>3?arguments[3]:void 0,E=arguments.length>4?arguments[4]:void 0,P=arguments.length>5?arguments[5]:void 0;if(null==P){var D,L;let o=eI.Or.averageDt(C)||2;P=(null!==(L=null===(D=C[C.length-1])||void 0===D?void 0:D.t_s)&&void 0!==L?L:0)+(C.length>0?o:0)}if(1===M)o=eI.Or.getKeyframeFromLumaCamera(P,E.focalLength);else{let M=-1;for(let o=0;o<C.length&&(M=o,!(P<=C[o].t_s));o++);let E=C[M-1],D=C[M];if(null!=E)o=nb(S,P);else if(null!=D){let C=D.position.clone().add(new U.Vector3(1,1,1)),M=D.quaternion.clone();o=eI.Or.createKeyframe(P,C,M,D.target.clone(),D.focalLength)}else{let C=new U.Vector3(1,1,1),M=new U.Vector3(0,0,0),S=new U.Quaternion().setFromUnitVectors(new U.Vector3(0,0,-1),M.clone().sub(C).normalize()),E=new U.PerspectiveCamera(_.fov,_.width/_.height);o=eI.Or.createKeyframe(P,C,S,M,E.getFocalLength())}}return o}function n_(o){let C={set scale(value){o.root.scale.set(value,value,value)},get scale(){return o.root.scale.x}},M={get x(){return(0,t7.ZY)(o.root.rotation.x)},set x(value){o.root.rotation.x=(0,t7.Id)(value)},get y(){return(0,t7.ZY)(o.root.rotation.y)},set y(value){o.root.rotation.y=(0,t7.Id)(value)},get z(){return(0,t7.ZY)(o.root.rotation.z)},set z(value){o.root.rotation.z=(0,t7.Id)(value)}};return(0,N.jsxs)(tW.Section,{header:"Transform Path",collapsed:o.collapsed,children:[(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"space-between",gap:"10px"},children:[(0,N.jsxs)("button",{onClick:()=>o.onSelectTransformMode("translate"),children:[(0,N.jsx)("b",{children:"[G]"})," Move"]}),(0,N.jsxs)("button",{onClick:()=>o.onSelectTransformMode("scale"),children:[(0,N.jsx)("b",{children:"[E]"})," Scale"]}),(0,N.jsxs)("button",{onClick:()=>o.onSelectTransformMode("rotate"),children:[(0,N.jsx)("b",{children:"[R]"})," Rotate"]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("header",{children:"position"}),(0,N.jsx)(tu,{obj:o.root.position})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("header",{children:"rotation"}),(0,N.jsx)(tu,{obj:M,units:"\xb0",changeRate:10})]}),(0,N.jsxs)("div",{style:{textAlign:"right"},children:[(0,N.jsx)("header",{children:"scale"}),(0,N.jsx)(ta.R,{obj:C,field:"scale",min:1e-6,showLabel:!1,style:{display:"inline-flex"},showDot:!0})]})]})}function nS(o){return(0,N.jsxs)(nn,{menuPosition:"right",style:{display:o.showUI?"":"none"},children:[(0,N.jsx)(tH,{onImportFile:o.onImportFile}),(0,N.jsx)(n_,{...o}),(0,N.jsx)(t5,{...o})]})}var nj=M(73159),nk=M(37139),nE=M(10007),nP=M(13800),nD=M.n(nP),nL=M(91863),nI=M.n(nL),nz=M(93369),nT=M(12499),nR=o=>{let{children:C,className:M,style:_,show:S=!0,exitZeroDur:E=!1,loaded:P,...D}=o;return(0,N.jsx)(nz.M,{initial:!1,exitBeforeEnter:!1,children:(S||P)&&(0,N.jsx)(nT.E.div,{...D,className:M,style:_,initial:{opacity:0},animate:{opacity:S&&P?1:0,transition:{duration:.5}},exit:{opacity:S&&P?1:0,transition:{duration:E?0:.5}},children:C})})},nA=M(71034),nV=M.n(nA),nF=o=>{let{src:C,videoShouldPlay:M,videoLoaded:_,className:S}=o,[E,P]=(0,H.useState)(!1);return(0,N.jsx)(nR,{show:M,loaded:E,className:S,exitZeroDur:!0,children:(0,N.jsx)("video",{className:nV().video,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,disablePictureInPicture:!0,onLoadedData:()=>{P(!0),null==_||_()},children:(0,N.jsx)("source",{src:C,type:"video/mp4"})})})},nO=M(84940),nN=M.n(nO);function nB(o){let{image:C,setCurrentVideo:M}=o,_=null==C.video&&"finished"==C.status,[S,E]=(0,H.useState)(!1),P=()=>{S&&E(!1)},D=()=>{S||E(!0)},[L,I]=(0,H.useState)(!0),[T,R]=(0,H.useState)(!1),V=(0,H.useRef)(null);function F(o){L||!V.current||document.body.clientWidth<700||(D(),R(!0))}function O(o){L||!V.current||document.body.clientWidth<700||(P(),R(!1))}let[U,G]=(0,H.useState)(!1),W=!T||U;return(0,N.jsx)("div",{className:nN().masterContainer,style:{overflow:"visible"},onClick:()=>M(C.href),children:(0,N.jsxs)("div",{className:nN().imageContainer,style:{overflow:"visible"},ref:V,onMouseEnter:F,onMouseLeave:O,children:[null==C.imageSrc?(0,N.jsx)(nI(),{className:nN().image,alt:"processing",fill:!0,src:"https://cdn-luma.com/public/captures.lumalabs.ai/images/processing.gif"}):(0,N.jsx)(nI(),{className:nN().image+"".concat(W?"":" "+nN().imageAnime),alt:C.name,src:C.imageSrc,fill:!0,onLoadingComplete:()=>I(!1)}),null!=C.video?(0,N.jsx)(nF,{src:C.video,videoShouldPlay:S,className:nN().videoContainer,videoLoaded:()=>{G(!0)}}):(0,N.jsx)(N.Fragment,{}),(0,N.jsxs)("p",{className:nN().download,onClick:()=>{C.href&&(0,eq.Sv)(C.href)},children:[(0,N.jsx)("span",{}),null==C.video?_?"failed":C.status:(0,N.jsx)(eH._8,{})]})]})})}var nH=M(46941),nU=M(81423),nG=M(97961),nW=M(49599);let nq=(0,H.forwardRef)((o,C)=>{let M;let[_,S]=(0,H.useState)(null),[E,P]=(0,H.useState)(!1),[D,L]=(0,H.useState)(o.collapsed),[I,T]=(0,H.useState)(0);(0,H.useImperativeHandle)(C,()=>({collapse:()=>L(!0),expand:()=>{L(!1)}}));let{uuid:R}=o,[V,F]=(0,H.useState)(!1),O=async()=>{if(R){var o;let{response:C,isMoreAvailable:M}=await (0,tJ.q$)(R);P(M);let _=null===(o=t2.store.capture)||void 0===o?void 0:o.artifacts;if(_){let o=(0,eq.gk)("with_background",_),M=(0,eq.gk)("with_background_preview",_);o&&M&&(C=[...C,{uuid:(0,nW.Z)(),type:nE.KM.video,status:nE.CA.finished,date:"",capture:{uuid:""},user:{uuid:"",username:""},artifacts:[{type:"video",url:o},{type:"video_preview",url:M}]}])}S(C),F(!1)}};(0,H.useEffect)(()=>{D||V||O()},[D]),(0,H.useEffect)(()=>{let o=(null!=_?_:[]).some(o=>o.status===nE.CA.dispatched||o.status===nE.CA.new);if(M&&clearInterval(M),o)return M=setInterval(()=>{O()},15e3),()=>clearInterval(M)},[_]);let[U,G]=(0,H.useState)();(0,H.useEffect)(()=>{D&&G(void 0),D||T(0)},[D]);let W=(0,H.useRef)(null);(0,H.useEffect)(()=>{if(D&&null!=W.current&&null!=_){let o=W.current;T(I+_.filter(C=>{if("finished"!==C.status)return!1;{let M=o.find(o=>o.uuid===C.uuid);return null==M||"finished"!==M.status}}).length)}W.current=_},[_,D,I]);let[K,X]=(0,H.useState)(!1);(0,H.useEffect)(()=>{X((null!=_?_:[]).some(o=>"finished"!==o.status&&"failed"!==o.status))},[_]);let Q=async()=>{let{response:o,isMoreAvailable:C}=await (0,tJ.q$)(R,{skip:_.length});P(C),S([..._,...o])};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(nH.DownloadVideoModal,{isOpen:!!U,onClose:()=>G(void 0),isCentered:!0,videoSrc:null==U?void 0:U.videoSrc,color:"white",bgColor:nU.O9.bg,depthImagesSrc:null==U?void 0:U.depthImagesSrc}),(0,N.jsxs)("div",{className:nD().rendersMenu+" "+(D?nD().collapsed:""),style:{display:o.display?"":"none"},children:[(0,N.jsxs)("div",{className:nD().rendersMenuHeader,onClick:()=>L(!D),children:[D?(0,N.jsx)(eH.g8,{boxSize:25}):(0,N.jsx)(eH.v4,{boxSize:25})," ","Renders",K?(0,N.jsx)(nj.$,{style:{width:"12px",height:"12px"}}):null]}),(0,N.jsxs)("div",{className:nD().rendersList,children:[(null!=_?_:[]).map(o=>(0,N.jsx)(nK,{item:o,setCurrentRender:G},o.uuid)),E&&(0,N.jsx)(nk.M5,{width:"100px",height:"100px",children:(0,N.jsx)(nG.Z,{onClick:Q,children:"more"})})]})]})]})});function nK(o){var C,M,_,S,E,P;let D=null===(M=o.item.artifacts)||void 0===M?void 0:null===(C=M.find(o=>"video_preview"==o.type))||void 0===C?void 0:C.url,L=null===(S=o.item.artifacts)||void 0===S?void 0:null===(_=S.find(o=>"video"==o.type))||void 0===_?void 0:_.url,I=null===(P=o.item.artifacts)||void 0===P?void 0:null===(E=P.find(o=>"video_depth_images"===o.type))||void 0===E?void 0:E.url;return(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(nB,{setCurrentVideo:()=>o.setCurrentRender({videoSrc:L,videoPreviewSrc:D,depthImagesSrc:I}),image:{href:L,imageSrc:D,name:o.item.status,video:L,status:o.item.status}})})}function nX(o){let[C,M]=(0,H.useState)(o.playing);return(0,H.useEffect)(()=>o.onPlayChange(C),[C]),(0,H.useEffect)(()=>{let _=_=>{" "===_.key?(_.preventDefault(),_.stopPropagation(),M(!C)):"Escape"===_.key&&(_.preventDefault(),_.stopPropagation(),o.onExit())};return window.addEventListener("keydown",_),()=>window.removeEventListener("keydown",_)},[C]),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(nf,{children:[(0,N.jsx)(ny,{className:"play_pause",onClick:()=>M(!C),children:C?(0,N.jsx)(eU.fpf,{width:24,height:24}):(0,N.jsx)(eU.o1U,{width:24,height:24})}),(0,N.jsx)(ny,{className:"cancel",onClick:o.onExit,children:(0,N.jsx)(eH.Tw,{})})]}),(0,N.jsx)(ns,{ref:o.scrubBarRef,onScrub:o.onScrub,smoothnessMultiplier:1,duration_s:-1})]})}var nQ=M(76464),nZ=M(38592);!function(o){o[o.Start=0]="Start",o[o.PerFrameMode=1]="PerFrameMode",o[o.CurveMode=2]="CurveMode"}(V||(V={}));let nY=(0,H.forwardRef)((o,C)=>{let M=(0,H.useRef)(null),[_,S]=(0,H.useState)(2),E=(0,H.useRef)((0,H.useMemo)(()=>new eO,[])),I=(0,H.useRef)(E.current.animationMixer),T=(0,H.useRef)((0,H.useMemo)(()=>{let C=new eD.N,M=eI.Or.getKeyframeFromLumaCamera(0,20);return C.setFromKeyframe(M),C.fov=o.camera.fov,C.updateMatrix(),C},[])),V=(0,H.useRef)(null),F=(0,H.useRef)(!0),O=(0,H.useRef)((0,H.useMemo)(()=>new U.Object3D,[])).current,Q=(0,H.useRef)((0,H.useMemo)(()=>new U.Object3D,[])).current,Z=(0,H.useRef)(!1),J=(0,H.useRef)(()=>{}),$=(0,H.useRef)(()=>{}),[ee,et]=(0,H.useState)(!1),er=(0,H.useRef)(null),ei=(0,H.useRef)(null),ea=(0,H.useRef)(null),eo=(0,H.useRef)(null),[es,eu]=(0,H.useState)({fps:30,width:1280,height:720,fov:60,bgColor:{r:window.luma.options.background_color[0],g:window.luma.options.background_color[1],b:window.luma.options.background_color[2],a:window.luma.options.background_color[3]},motionMode:P.Freeform,interpolation:D.Spline,tension:0,loop:!1,transparentBackground:!1,depthMaps:!1,segmentation:eE.A6.getValue(),fovXOverride_deg:NaN,fovXMultiplier:1}),ec=o.camera;(0,H.useMemo)(()=>O.add(E.current),[]),(0,H.useMemo)(()=>{let o=eI.Or.getKeyframeFromLumaCamera(0,0);ec.setFromKeyframe(o,!1)},[]),(0,H.useEffect)(()=>{let o=(0,eE.FO)().then(o=>({rgba0:{r:window.luma.options.background_color[0],g:window.luma.options.background_color[1],b:window.luma.options.background_color[2],a:window.luma.options.background_color[3]},luma:o}));return()=>{o.then(o=>{o.luma.options.background_color=[o.rgba0.r,o.rgba0.g,o.rgba0.b,o.rgba0.a]})}},[]),(0,H.useEffect)(()=>{let o=(0,eE.FO)().then(o=>{let C=o.options.enable_momentum;return o.options.enable_momentum=!1,{luma:o,previous_enable_momentum:C}});return()=>{o.then(o=>o.luma.options.enable_momentum=o.previous_enable_momentum)}},[]),(0,H.useEffect)(()=>()=>{window.luma.camera.up_world_aligned=!0},[]);let ed=(0,H.useRef)(_);(0,H.useEffect)(()=>{ed.current=_},[_]);let eh=(0,H.useRef)(es);(0,H.useEffect)(()=>{eh.current=es},[es]);let[em,ef]=(0,H.useState)(-1),[eg,ev]=(0,H.useState)(-1);(0,H.useImperativeHandle)(C,()=>({beforeFrame:()=>J.current(),renderFrame:()=>$.current()}),[]);let ey=o.interactionManager,ex=1;function ew(){for(let o of(O.scale.setScalar(1),O.position.set(0,0,0),O.rotation.set(0,0,0),O.remove(...O.children),Q.children))o instanceof G.Ys&&(o.dispose(),Q.remove(o)),o instanceof U.CameraHelper&&(o.dispose(),Q.remove(o))}function eb(o,C){let M,_;ew(),V.current=null,o.traverse(o=>o.visible=!1);let S=(function(o){let C=[];return o.traverse(o=>{o instanceof U.Camera&&C.push(o)}),C})(o).filter(o=>o instanceof U.PerspectiveCamera).map(o=>{var C,M;let _=new eD.N().copy(o);return _.name=o.name,null===(C=o.parent)||void 0===C||C.add(_),null===(M=o.parent)||void 0===M||M.remove(o),_.far=10,_.updateProjectionMatrix(),_.visible=!0,_});for(let C of(o.visible=!0,o.animations)){let o=1/0;for(let M of C.tracks)o=Math.min(o,M.times[0]);if(0!==o)for(let M of C.tracks)for(let C=0;C<M.times.length;C++)M.times[C]-=o}for(let C of o.animations){let o=-1/0;for(let M of C.tracks)o=Math.max(o,M.times[M.times.length-1]);C.duration=o}if(null==C&&(C=!window.confirm("Import raw rotations?")),C){for(let C of o.animations)for(let o of C.tracks)if(o.name.endsWith(".quaternion"))for(let C=0;C<o.values.length;C+=4){let M=new U.Quaternion(o.values[C],o.values[C+1],o.values[C+2],o.values[C+3]),_=new U.Matrix4().makeRotationFromQuaternion(M);(0,eR.nU)(_,_),M.setFromRotationMatrix(_),o.values[C]=M.x,o.values[C+1]=M.y,o.values[C+2]=M.z,o.values[C+3]=M.w}}let L=o.animations,R=new U.AnimationMixer(o);for(let o of(I.current=R,L)){let C=R.clipAction(o);C._updateTime=o=>C.time+=o,C.play()}for(let o of S){let C=new U.CameraHelper(o);Q.add(C)}let F=new U.AnimationMixer(o),N=0,H=new U.Box3,Y=1/60;for(let o of L)F.clipAction(o).play(),N=Math.max(N,o.duration);for(let C of S){let M=[],_=[],S=new U.Color,E=new U.Color(11352595),P=new U.Color(15261342);F.setTime(0);for(let o=0;o<N-Y;o+=Y){let D=o/N;F.setTime(o),C.updateMatrixWorld(!0);let L=C.getWorldPosition(new U.Vector3);M.push(L.x,L.y,L.z),S.lerpColors(E,P,D),_.push(S.r,S.g,S.b),H.expandByPoint(L)}let D=new K.L;D.setPositions(M),D.setColors(_);let L=new X.Y({color:16777215,worldUnits:!0,linewidth:.002,vertexColors:!0,dashed:!1}),I=new W.w(D,L);o.add(I),F.setTime(0);let T=Math.min(1,N/10);for(let M=0;M<=N-T;M+=T){F.setTime(M),C.updateMatrixWorld(!0);let _=C.clone();_.remove(),_.matrixAutoUpdate=!1,_.matrixWorldNeedsUpdate=!1,_.matrixWorld=C.matrixWorld.clone();let S=new U.CameraHelper(_);S.material.transparent=!0,S.material.opacity=.4,o.add(S)}}O.add(o),H.getSize(new U.Vector3),H.getCenter(new U.Vector3);let J=new G.Ys(ec,ey.el);J.attach(O),J.addEventListener("dragging-changed",function(o){let C=o.value;Z.current=C}),Q.add(J),T.current=S[0];let $=T.current.aspect,ee=eE.h5.fov;$>1?_=Math.round((M=1920)/$):M=Math.round((_=1920)*$);let et=N;eu({fov:Math.round(10*ee)/10,fps:30,width:M,height:_,bgColor:{r:0,g:0,b:0,a:0},motionMode:P.Freeform,interpolation:D.Linear,tension:0,loop:!1,depthMaps:!1,transparentBackground:!1,segmentation:eE.A6.getValue(),fovXOverride_deg:NaN,fovXMultiplier:1}),ef(et),ev(et),E.current=o,E.current.animationCamera=S[0],E.current.animationMixer=R}function eC(C){null==C&&(0,eE.sv)(o.camera),V.current=null!=C?C:null}function eM(o){eC(o),I.current.setTime(0),et(null!=V.current),null!=o&&(F.current=!0)}(0,H.useEffect)(()=>{let C=new U.WebGLRenderer({canvas:M.current,alpha:!0,antialias:!0,powerPreference:"high-performance",precision:"lowp"});C.toneMapping=U.NoToneMapping,C.toneMappingExposure=1;let _=new U.Scene,S=new eL.Z(ey,_,ec,ex);_.add(O),_.add(Q);let P=new U.AxesHelper;P.scale.setScalar(.25),Q.add(P);let D=new eD.N,L=NaN;J.current=()=>{var o,_,S;let P=performance.now()/1e3,R=isFinite(L)?P-L:1/60;L=P;let O=T.current,N=I.current,H=E.current.animationCamera,U=M.current,G=window.devicePixelRatio||1,W=Math.round(U.clientWidth*G),K=Math.round(U.clientHeight*G);(U.width!==W||U.height!==K)&&C.setSize(W,K,!1);let X=eh.current.width/eh.current.height;H.aspect=X,null!=O&&(O.aspect=X);{let o=null!==(S=null===(_=ei.current)||void 0===_?void 0:_.isScrubbing)&&void 0!==S&&S,C=0;for(let o of E.current.animations)C=Math.max(C,o.duration);let M=C;if(!o&&F.current){let o=N.time;o=isFinite(o=ek(o+R,M))?o:0,N.setTime(o)}let P=Math.max(Math.min(N.time,M),0);N.setTime(P),null==ei.current||o||ei.current.setPosition(N.time/M||0),!H.isEqual(D)&&M>0&&(O.copy(H),D.copy(H)),O.animationTick()}let Z=ec.fov;if(null!=V.current){V.current.updateWorldMatrix(!0,!1),ec.matrix.copy(V.current.matrixWorld),ec.matrix.decompose(ec.position,ec.quaternion,ec.scale);let o=V.current.aspect>ec.aspect,C=V.current.fov*eh.current.fovXMultiplier;if(o){let o=2*Math.atan(Math.tan(2*Math.atan(Math.tan(C*Math.PI/360)*V.current.aspect)*180/Math.PI*Math.PI/360)/ec.aspect)*180/Math.PI;ec.fov=o}else ec.fov=C;if(eh.current.fovXOverride_deg&&isFinite(eh.current.fovXOverride_deg)){let o=2*Math.atan(Math.tan(eh.current.fovXOverride_deg*Math.PI/360)/ec.aspect)*180/Math.PI;ec.fov=o}ec.animator.removeAll(),ec.matrixWorldNeedsUpdate=!0}else(0,eE.Uw)(window.luma.camera,"world_up",[0,-1,0]);Z!==ec.fov&&ec.updateProjectionMatrix(),Q.visible=null==V.current,(0,eE.Uw)(window.luma.camera,"up_world_aligned",null==V.current),null===(o=ea.current)||void 0===o||o.call(ea)},$.current=()=>{C.render(_,ec)};let R=[ey.events.pointerDown.addListener(o=>{(Z.current||F.current&&null!=V.current)&&(o.stopPropagation(),o.preventDefault())},ex+1),ey.events.pointerMove.addListener(o=>{(Z.current||F.current&&null!=V.current)&&(o.stopPropagation(),o.preventDefault())},ex+1),ey.events.keyUp.addListener(C=>{if("Escape"===C.key&&(o.onCancel(),C.preventDefault(),C.stopPropagation()),null==V.current){if("g"===C.key)for(let o of Q.children)o instanceof G.Ys&&o.setMode("translate");if("r"===C.key)for(let o of Q.children)o instanceof G.Ys&&o.setMode("rotate");if("e"===C.key)for(let o of Q.children)o instanceof G.Ys&&o.setMode("scale")}},ex)];return()=>{for(let o of(C.dispose(),S.dispose(),R))o.remove()}},[]),(0,H.useEffect)(()=>{let o={azimuth_bounds_max:window.luma.camera.azimuth_bounds_max,azimuth_bounds_min:window.luma.camera.azimuth_bounds_min,radius_bounds_max:window.luma.camera.radius_bounds_max,radius_bounds_min:window.luma.camera.radius_bounds_min,elevation_bounds_max:window.luma.camera.elevation_bounds_max,elevation_bounds_min:window.luma.camera.elevation_bounds_min};return window.luma.camera.azimuth_bounds_max=1/0,window.luma.camera.azimuth_bounds_min=-1/0,window.luma.camera.radius_bounds_max=1/0,window.luma.camera.radius_bounds_min=-1/0,window.luma.camera.elevation_bounds_max=1/0,window.luma.camera.elevation_bounds_min=-1/0,()=>{window.luma.camera.azimuth_bounds_max=o.azimuth_bounds_max,window.luma.camera.azimuth_bounds_min=o.azimuth_bounds_min,window.luma.camera.radius_bounds_max=o.radius_bounds_max,window.luma.camera.radius_bounds_min=o.radius_bounds_min,window.luma.camera.elevation_bounds_max=o.elevation_bounds_max,window.luma.camera.elevation_bounds_min=o.elevation_bounds_min}},[]);let[eS,ez]=(0,H.useState)([]),eT=(0,H.useContext)(eP.pn),eA=(0,H.useMemo)(()=>{var o;return L.readLocalStorage(null!==(o=eT.slug)&&void 0!==o?o:null)},[]);async function eV(o){if("application/json"===o.type){var C,M,_,E,P=new FileReader;P.onload=function(o){{var C;let M=L.deserializeState(JSON.parse(o.target.result));null===(C=eo.current)||void 0===C||C.setInitialState(M,R.AppendHistory),S(2)}},P.readAsText(o)}else{let P,D=await o.arrayBuffer(),L=new Y().parse(D,""),I=!1,T=!1,R=null===(E=L.fbxTree)||void 0===E?void 0:null===(_=E.FBXHeaderExtension)||void 0===_?void 0:null===(M=_.SceneInfo)||void 0===M?void 0:null===(C=M["Original|ApplicationName"])||void 0===C?void 0:C.value;console.log("Importing FBX"),console.log("fbxTree",L.fbxTree),console.log("originalApplicationName",R),(null==R?void 0:R.toLowerCase().startsWith("unreal"))&&(P=!0,I=!0,T=!0),(null==R?void 0:R.toLowerCase().startsWith("blender"))&&(T=!0,P=!0),eb(L.sceneGraph,P),I&&(O.rotation.x=-Math.PI/2,O.rotation.z=Math.PI),T&&O.scale.setScalar(.01),S(1)}}function eF(o){let C=Q.children.find(o=>o instanceof G.Ys);null==C||C.setMode(o)}return(0,H.useEffect)(()=>{var o,C;try{null!=eA?(console.log("restoring state from local storage",eA,eo.current),null===(o=eo.current)||void 0===o||o.setInitialState(eA,R.ReplaceHistory)):console.log("no state to restore from local storage")}catch(o){console.error("error restoring state from local storage",o),L.clearLocalStorage(null!==(C=eT.slug)&&void 0!==C?C:null)}},[]),(0,H.useEffect)(()=>{function o(){var o;null===(o=er.current)||void 0===o||o.collapse()}return window.addEventListener("lumaCameraChange",o),()=>window.removeEventListener("lumaCameraChange",o)},[]),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:ej().topLeft,children:(0,N.jsx)(nQ.Z,{className:ej().icon,children:(0,N.jsx)(nZ.Z,{onClick:()=>{o.onCancel()}})})}),(0,N.jsx)("canvas",{ref:M,className:e_().slfEditorCanvas,onContextMenu:o=>o.preventDefault(),style:{pointerEvents:"none",userSelect:"none",touchAction:"none"}}),1===_?(0,N.jsx)(nS,{showUI:!ee,onImportFile:eV,root:O,onSelectTransformMode:eF,animationScene:E.current,settings:es,onSettingsChange:eu,onPreview:()=>eM(E.current.animationCamera),onQueueJob:()=>{var o;return null===(o=er.current)||void 0===o?void 0:o.expand()},onJobQueued:()=>{var o;return null===(o=er.current)||void 0===o?void 0:o.expand()},duration:eg,durationMax:em,durationTrim:eg,onDurationChange:ev,durationDisableEdit:!0}):null,2===_?(0,N.jsx)(nx,{ref:eo,interactionManager:ey,eventPriority:ex+1,keyframes:eS,onKeyframesChange:o=>{ez(o)},settings:es,onSettingsChange:eu,captureName:o.capturedName,onImportFile:eV,animationPlayingRef:F,scrubBarRef:ei,editorCamera:o.camera,overrideCameraRef:V,showUI:!ee,animationScene:E.current,firstPersonCamera:T.current,onQueueJob:()=>{},onJobQueued:()=>{var o;return null===(o=er.current)||void 0===o?void 0:o.expand()},beforeRenderRef:ea}):null,ee?(0,N.jsx)(nX,{scrubBarRef:ei,playing:F.current,onPlayChange:o=>{F.current=o},onScrub:o=>{let C=0;for(let o of E.current.animations)C=Math.max(C,o.duration);let M=Math.min(C,eg);I.current.setTime(o*M)},onExit:()=>{eM(null),F.current=!0}}):null,(0,N.jsx)(nq,{ref:er,display:!ee,collapsed:!0,uuid:eT.uuid})]})});var nJ=M(81068);class n$ extends U.Color{clone(){return new n$(this.darkMode,this.lightMode)}constructor(o,C){if(super(o),this.darkMode=o,this.lightMode=C,window.matchMedia){let o=window.matchMedia("(prefers-color-scheme: dark)");this.set(o.matches?this.darkMode:this.lightMode),o.addEventListener("change",o=>{this.set(o.matches?this.darkMode:this.lightMode)})}}}var n0=M(36882),n1=M.n(n0);let n3=eJ.A.Exponential(.05);!function(o){o[o.ModelDefault=0]="ModelDefault",o[o.Front=1]="Front",o[o.Top=2]="Top",o[o.Left=3]="Left",o[o.Free=4]="Free"}(F||(F={}));let n2=(0,H.forwardRef)((o,C)=>{let M=(0,H.useRef)(null),[_,S]=(0,H.useState)(0),E=(0,H.useRef)(o.box.clone()),P=(0,H.useRef)(()=>{}),D=(0,H.useRef)(()=>{});(0,H.useImperativeHandle)(C,()=>({beforeFrame:()=>P.current(),renderFrame:()=>D.current()}),[_]);let L=o.interactionManager,I=o.camera,T=2;(0,H.useEffect)(()=>{let C=new U.WebGLRenderer({canvas:M.current,alpha:!0,antialias:!0,powerPreference:"high-performance",precision:"lowp"});C.toneMapping=U.NoToneMapping,C.toneMappingExposure=1;let _=new U.Scene,S=new eL.Z(L,_,I,T),P=new eY.L,R=new U.Object3D;(0,eE.Dv)().decompose(R.position,R.quaternion,R.scale);let V=new e$.Mu(R,{rotation:!0,translation:!0,viewIndependentSize:.3});function F(o,C){o.animator.onBeforeStep.addListener(()=>{o.material.opacity=1;let M=I.position.clone().negate().normalize();for(let _ of C){let C=Math.min(Math.max(1-Math.pow(Math.abs(M.dot(_))+.05,4),0),1);o.material.opacity*=C}o.material.transparent=o.material.opacity<1,o.material.depthWrite=o.material.opacity>.1,o.material.opacity>.1?o.layers.enable(nJ.m.Interactive):o.layers.disable(nJ.m.Interactive)})}V.onChange=o=>{o.updateMatrix(),(0,eE.NQ)(o.matrix)},V.xAxis.userData.sortPriority=1,V.yAxis.userData.sortPriority=1,V.zAxis.userData.sortPriority=1,V.xyArc.userData.sortPriority=1,V.xzArc.userData.sortPriority=1,V.yzArc.userData.sortPriority=1,F(V.xAxis,[new U.Vector3(1,0,0)]),F(V.yAxis,[new U.Vector3(0,1,0)]),F(V.zAxis,[new U.Vector3(0,0,1)]),F(V.yzArc,[new U.Vector3(0,1,1)]),F(V.xzArc,[new U.Vector3(1,0,1)]),F(V.xyArc,[new U.Vector3(1,1,0)]),_.add(V);let O=E.current;O.min.x=isFinite(O.min.x)?O.min.x:-1e6,O.min.y=isFinite(O.min.y)?O.min.y:-1e6,O.min.z=isFinite(O.min.z)?O.min.z:-1e6,O.max.x=isFinite(O.max.x)?O.max.x:1e6,O.max.y=isFinite(O.max.y)?O.max.y:1e6,O.max.z=isFinite(O.max.z)?O.max.z:1e6;let N=new n5(E.current,P,S);_.add(N);let H=NaN;D.current=()=>{let o=performance.now()/1e3,S=isFinite(H)?o-H:1/60;H=o;let E=M.current,D=window.devicePixelRatio||1,L=Math.round(E.clientWidth*D),T=Math.round(E.clientHeight*D);(E.width!==L||E.height!==T)&&C.setSize(L,T,!1),P.step(S),N.update(o),C.render(_,I)};let G=C=>{"Escape"===C.key&&o.onCancel()};return window.addEventListener("keydown",G),()=>{C.dispose(),S.dispose(),window.removeEventListener("keydown",G)}},[]),(0,H.useEffect)(()=>{let o=(0,eE.FO)().then(o=>{let C=o.options.enable_momentum;return o.options.enable_momentum=!1,{luma:o,previous_enable_momentum:C}});return()=>{o.then(o=>o.luma.options.enable_momentum=o.previous_enable_momentum)}},[]),(0,H.useEffect)(()=>()=>{I.userData.panEnabled=!0,I.userData.zoomEnabled=!0,I.userData.rotateEnabled=!0},[]);let R=(0,H.useRef)(null);function V(o,C){let M,_,E;if(!window.luma)return;S(o);let P=window.luma.camera.center,D=Math.sqrt(P[0]*P[0]+P[1]*P[1]+P[2]*P[2]),L=4,T=isFinite(D)?Math.max(D,.1):L;switch(o){case 0:window.luma.camera.resetToModel(),M=!0,_=!0,E=!0;case 4:window.luma.camera.azimuth_bounds_max=1/0,window.luma.camera.azimuth_bounds_min=-1/0,window.luma.camera.radius_bounds_max=1/0,window.luma.camera.radius_bounds_min=-1/0,window.luma.camera.elevation_bounds_max=1/0,window.luma.camera.elevation_bounds_min=-1/0,M=!0,_=!0,E=!0,R.current&&(window.luma.camera.MV=R.current);break;case 2:case 3:case 1:{let S=3==o?-T:0,P=2==o?-T:0,D=1==o?-T:0;4===C&&(R.current=window.luma.camera.MV.slice(0)),window.luma.camera.center=[S,P,D],window.luma.camera.lookAt([0,0,2==o?.001:0]),(0,eE.qf)(),M=!0,_=!0,E=!1}}I.userData.panEnabled=M,I.userData.zoomEnabled=_,I.userData.rotateEnabled=E,window.dispatchEvent(new Event("lumaCameraChange"))}return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("canvas",{ref:M,className:n1().slfEditorCanvas,onContextMenu:o=>o.preventDefault(),style:{pointerEvents:"none",userSelect:"none",touchAction:"none"}}),(0,N.jsx)(n4,{box:E.current,interactionManager:o.interactionManager,onSetCameraView:V,onCancel:o.onCancel,onSave:()=>o.onSave(E.current,(0,eE.Dv)()),onResetCrop:o.onResetCrop})]})});function n4(o){let[C,M]=(0,H.useState)(0);function _(_){o.onSetCameraView(_,C),M(_)}return(0,H.useEffect)(()=>_(4),[]),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(nh,{children:[(0,N.jsx)("div",{className:3===C?n1().active:"",onClick:()=>_(3),children:"Left"}),(0,N.jsx)("div",{className:2===C?n1().active:"",onClick:()=>_(2),children:"Top"}),(0,N.jsx)("div",{className:1===C?n1().active:"",onClick:()=>_(1),children:"Front"}),(0,N.jsx)("div",{className:4===C?n1().active:"",onClick:()=>_(4),children:"Free"})]}),(0,N.jsxs)(nf,{children:[(0,N.jsx)(ny,{className:"cancel",onClick:o.onCancel,children:(0,N.jsx)(eH.Tw,{})}),(0,N.jsx)(ny,{className:"save",onClick:o.onResetCrop,children:(0,N.jsx)(eH.pJ,{})}),(0,N.jsx)(ny,{className:"save",onClick:o.onSave,children:(0,N.jsx)(eH.nQ,{})})]})]})}class n5 extends U.Object3D{update(o){this.box.equals(this._boxLastUpdate)||(this.onBoxChanged(),this._boxLastUpdate.copy(this.box))}onBoxChanged(){let o=this.box,C=this.box.getSize(this._boxSize),M=this.box.getCenter(this._boxCenter);(0,eE._y)(o),this.cornerHandle_pxpypz.position.copy(o.max),this.cornerHandle_nxpypz.position.set(o.min.x,o.max.y,o.max.z),this.cornerHandle_pxnypz.position.set(o.max.x,o.min.y,o.max.z),this.cornerHandle_pxpynz.position.set(o.max.x,o.max.y,o.min.z),this.cornerHandle_nxnypz.position.set(o.min.x,o.min.y,o.max.z),this.cornerHandle_pxnynz.position.set(o.max.x,o.min.y,o.min.z),this.cornerHandle_nxpynz.position.set(o.min.x,o.max.y,o.min.z),this.cornerHandle_nxnynz.position.copy(o.min),this.lineSegmentsGeometry.setPositions([o.min.x,o.min.y,o.min.z,o.max.x,o.min.y,o.min.z,o.min.x,o.min.y,o.min.z,o.min.x,o.max.y,o.min.z,o.min.x,o.min.y,o.min.z,o.min.x,o.min.y,o.max.z,o.max.x,o.max.y,o.max.z,o.min.x,o.max.y,o.max.z,o.max.x,o.max.y,o.max.z,o.max.x,o.min.y,o.max.z,o.max.x,o.max.y,o.max.z,o.max.x,o.max.y,o.min.z,o.max.x,o.min.y,o.min.z,o.max.x,o.max.y,o.min.z,o.max.x,o.max.y,o.min.z,o.min.x,o.max.y,o.min.z,o.min.x,o.min.y,o.max.z,o.min.x,o.max.y,o.max.z,o.min.x,o.max.y,o.max.z,o.min.x,o.max.y,o.min.z,o.max.x,o.min.y,o.max.z,o.min.x,o.min.y,o.max.z,o.max.x,o.min.y,o.max.z,o.max.x,o.min.y,o.min.z]);let _=this.planeDelta;this.planeHandle_px.obj.position.set(o.max.x+_,M.y,M.z),this.planeHandle_nx.obj.position.set(o.min.x-_,M.y,M.z),this.planeHandle_py.obj.position.set(M.x,o.max.y+_,M.z),this.planeHandle_ny.obj.position.set(M.x,o.min.y-_,M.z),this.planeHandle_pz.obj.position.set(M.x,M.y,o.max.z+_),this.planeHandle_nz.obj.position.set(M.x,M.y,o.min.z-_);let S=this.planeScale;this.planeHandle_px.plane.scale.set(C.z*S,C.y*S,1),this.planeHandle_nx.plane.scale.set(C.z*S,C.y*S,1),this.planeHandle_py.plane.scale.set(C.x*S,C.z*S,1),this.planeHandle_ny.plane.scale.set(C.x*S,C.z*S,1),this.planeHandle_pz.plane.scale.set(C.x*S,C.y*S,1),this.planeHandle_nz.plane.scale.set(C.x*S,C.y*S,1),this.innerCube.scale.copy(C),this.innerCube.scale.multiplyScalar(.995),this.innerCube.position.copy(M)}createPlaneHandle(o){let C={hoverOpacity:.5,activeOpacity:.7,restOpacity:.1},M=0>o.dot(new U.Vector3(1,1,1))?-1:1,_=M>0?this.box.max:this.box.min,S=M>0?this.box.min:this.box.max,E=Math.abs(o.x)>0?0:Math.abs(o.y)>0?1:2,P=()=>_.getComponent(E),D=o=>_.setComponent(E,o),L=()=>S.getComponent(E),I=new U.Object3D,T=new U.Mesh(this.planeGeometry,new U.MeshBasicMaterial({opacity:C.restOpacity,transparent:!0,depthWrite:!1,depthTest:!0}));T.material.color=this.color.clone(),T.layers.enable(nJ.m.Interactive);let R=(o,C)=>{let M=o.direction.clone().cross(C.direction),_=o.direction.clone().cross(M).normalize(),S=C.direction.clone().normalize();return o.origin.clone().sub(C.origin).dot(_)/S.dot(_)},V=NaN,F=P(),O={opacity:T.material.opacity},N=()=>{let C=this.box.getCenter(this._boxCenter);return this.interaction.camera.getWorldPosition(this._cameraWorldPosition),Math.min(Math.max(1-Math.pow(Math.abs(C.clone().sub(this._cameraWorldPosition).normalize().dot(o))+.05,4),0),1)};T.onBeforeRender=()=>{let o=N();T.material.opacity=o*O.opacity;let C=o>0;T.userData.cursor=C?1==E?"ns-resize":"ew-resize":"",C?T.layers.enable(nJ.m.Interactive):T.layers.disable(nJ.m.Interactive)};let H=null;T.userData={cursor:1==E?"ns-resize":"ew-resize",onPointerDown:C=>{if(1!==C.buttons||(C.preventDefault(),C.stopPropagation(),null!==H))return!1;H=C.pointerId;let M=this.interaction.prepareRaycastWithPointer(C),_=this.box.getCenter(this._boxCenter);return V=R(M.ray,new U.Ray(_,o)),F=P(),this.animator.springTo(T.material,"opacity",.7,n3),!0},onPointerMove:(_,S)=>{if(1===_.buttons&&S&&_.pointerId===H){_.preventDefault(),_.stopPropagation();let S=this.interaction.prepareRaycastWithPointer(_),I=this.box.getCenter(this._boxCenter),T=S.ray,H=new U.Ray(I,o),G=R(T,H),W=G-V;if(isFinite(W*=Math.min(Math.max(1-Math.pow(Math.abs(T.direction.dot(H.direction))+.001,16),0),1)*N())){let C=F+W*o.getComponent(E);D(C=M>0?Math.max(C,L()):Math.min(C,L())),V=G,F=P()}this.animator.springTo(O,"opacity",C.activeOpacity,n3)}},onPointerUp:(o,M)=>{M&&o.pointerId===H&&(o.preventDefault(),o.stopPropagation(),H=null),o.pointerId===H&&(H=null),this.animator.springTo(O,"opacity",C.restOpacity,n3)},onPointerOver:(o,M)=>{0===Object.keys(this.interaction.capturedPointers).length&&this.animator.springTo(O,"opacity",C.hoverOpacity,n3)},onPointerOut:(o,M)=>{this.animator.springTo(O,"opacity",C.restOpacity,n3)},capturePointer:!0,occludePointerEvents:!1};{let o=new U.MeshBasicMaterial({color:1044480,transparent:!0,opacity:.7}),C=new U.Mesh(new U.ConeGeometry(.06,.1,10,1),o);C.position.z=.05,C.material.color=T.material.color,C.rotateX(Math.PI/2),C.layers.enable(nJ.m.Interactive),C.userData=T.userData,C.onBeforeRender=()=>{let o=N();C.material.opacity=o*O.opacity*7;let M=o>0;C.userData.cursor=M?1==E?"ns-resize":"ew-resize":"",M?C.layers.enable(nJ.m.Interactive):C.layers.disable(nJ.m.Interactive)},I.add(C)}return I.add(T),I.lookAt(o),this.add(I),{obj:I,plane:T}}createCornerHandle(o){let C=new U.Mesh(this.cornerHandleGeometry,new U.MeshBasicMaterial({opacity:.8,transparent:!0,depthWrite:!1,depthTest:!1}));C.material.color=this.color.clone();let M=new U.Mesh(this.cornerGrabGeometry,new U.MeshNormalMaterial({wireframe:!0,visible:!1}));C.add(M),M.layers.enable(nJ.m.Interactive);let _=[o.x>0?new U.Vector3(1,0,0):new U.Vector3(-1,0,0),o.y>0?new U.Vector3(0,1,0):new U.Vector3(0,-1,0),o.z>0?new U.Vector3(0,0,1):new U.Vector3(0,0,-1)];function S(o,C,M){let _=0;for(let S of C)_=Math.max(_,Math.pow(Math.max(-o.dot(S),0),M));return _}return C.onBeforeRender=()=>{let o=this.box.getCenter(this._boxCenter);this.interaction.camera.getWorldPosition(this._cameraWorldPosition);let E=Math.max(S(o.clone().sub(this._cameraWorldPosition).normalize(),_,30)-.05,0),P=E>0;C.material.opacity=E,P?M.layers.enable(nJ.m.Interactive):M.layers.disable(nJ.m.Interactive)},M.userData={cursor:"move",onPointerDown:(o,C)=>1===o.buttons&&(o.preventDefault(),o.stopPropagation(),!0),onPointerMove:(C,M)=>{if(M){C.preventDefault(),C.stopPropagation();let M=this.box.getCenter(this._boxCenter);this.interaction.camera.getWorldPosition(this._cameraWorldPosition);let _=M.clone().sub(this._cameraWorldPosition).normalize(),S=Math.max(Math.abs(_.x),Math.abs(_.y),Math.abs(_.z)),E=new U.Vector3(Math.abs(_.x)==S?1:0,Math.abs(_.y)==S?1:0,Math.abs(_.z)==S?1:0),P=Math.abs(E.x)>0?0:Math.abs(E.y)>0?1:2,D=(o.getComponent(P)>0?this.box.max:this.box.min).getComponent(P),L=new U.Plane(E,-D),I=this.interaction.prepareRaycastWithPointer(C).ray.intersectPlane(L,new U.Vector3);I&&(o.getComponent(0)>0?this.box.max.x=Math.max(I.x,this.box.min.x):this.box.min.x=Math.min(I.x,this.box.max.x),o.getComponent(1)>0?this.box.max.y=Math.max(I.y,this.box.min.y):this.box.min.y=Math.min(I.y,this.box.max.y),o.getComponent(2)>0?this.box.max.z=Math.max(I.z,this.box.min.z):this.box.min.z=Math.min(I.z,this.box.max.z))}},onPointerUp:(o,C,M)=>{C&&(o.preventDefault(),o.stopPropagation())}},this.add(C),C}constructor(o,C,M){super(),this.box=o,this.animator=C,this.interaction=M,this.planeDelta=.01,this.planeScale=.9,this.color=new n$(16777215,0),this.unitBox=new U.BoxGeometry(1,1,1),this._boxSize=new U.Vector3,this._boxCenter=new U.Vector3,this._boxLastUpdate=new U.Box3(new U.Vector3(NaN,NaN,NaN),new U.Vector3(NaN,NaN,NaN)),this._cameraWorldPosition=new U.Vector3,this.planeGeometry=new U.PlaneGeometry(1,1),this.cornerHandleGeometry=new U.SphereGeometry(.03,16,8),this.cornerGrabGeometry=new U.SphereGeometry(.09,16,8),this.innerCube=new U.Mesh(this.unitBox,new U.MeshNormalMaterial({side:U.BackSide,transparent:!1,opacity:0,colorWrite:!1})),this.add(this.innerCube),this.cornerHandle_pxpypz=this.createCornerHandle(new U.Vector3(1,1,1)),this.cornerHandle_nxpypz=this.createCornerHandle(new U.Vector3(-1,1,1)),this.cornerHandle_pxnypz=this.createCornerHandle(new U.Vector3(1,-1,1)),this.cornerHandle_pxpynz=this.createCornerHandle(new U.Vector3(1,1,-1)),this.cornerHandle_nxnypz=this.createCornerHandle(new U.Vector3(-1,-1,1)),this.cornerHandle_pxnynz=this.createCornerHandle(new U.Vector3(1,-1,-1)),this.cornerHandle_nxpynz=this.createCornerHandle(new U.Vector3(-1,1,-1)),this.cornerHandle_nxnynz=this.createCornerHandle(new U.Vector3(-1,-1,-1)),this.planeHandle_px=this.createPlaneHandle(new U.Vector3(1,0,0)),this.planeHandle_nx=this.createPlaneHandle(new U.Vector3(-1,0,0)),this.planeHandle_py=this.createPlaneHandle(new U.Vector3(0,1,0)),this.planeHandle_ny=this.createPlaneHandle(new U.Vector3(0,-1,0)),this.planeHandle_pz=this.createPlaneHandle(new U.Vector3(0,0,1)),this.planeHandle_nz=this.createPlaneHandle(new U.Vector3(0,0,-1)),this.lineMaterial=new X.Y({linewidth:.003,opacity:.35,worldUnits:!1,transparent:!0}),this.lineMaterial.color=this.color.clone(),this.lineSegmentsGeometry=new tw.z;let _=new tx.w(this.lineSegmentsGeometry,this.lineMaterial);this.add(_)}}!function(o){o[o.View=0]="View",o[o.Crop=1]="Crop",o[o.CameraPaths=2]="CameraPaths"}(O||(O={}));let n6=(0,H.forwardRef)((o,C)=>{let M=(0,H.useRef)(null);switch((0,H.useImperativeHandle)(C,()=>({beforeFrame:()=>{var o;return null===(o=M.current)||void 0===o?void 0:o.beforeFrame()},renderFrame:()=>{var o;return null===(o=M.current)||void 0===o?void 0:o.renderFrame()}})),o.editMode){case 0:return(0,N.jsx)(N.Fragment,{});case 2:return(0,N.jsx)(nY,{capturedName:o.captureName,ref:M,interactionManager:o.interactionManager,camera:o.camera,onCancel:o.onCancel});case 1:return(0,N.jsx)(n2,{ref:M,box:o.cropBox,onCancel:o.onCropCancel,onSave:o.onCropSave,onResetCrop:o.onResetCrop,camera:o.camera,interactionManager:o.interactionManager})}});var n7=n6},21228:function(o,C,M){"use strict";M.d(C,{Or:function(){return L},yX:function(){return _}});var _,S=M(9781),E=M(12837),P=M(39405);let D=1;!function(o){o[o.Normal=0]="Normal",o[o.Loop=1]="Loop"}(_||(_={}));class L{updateOrbitFromCartesian(){(0,P.Zy)({position:this.position,quaternion:this.quaternion},S.Object3D.DEFAULT_UP,this)}updateCartesianFromOrbit(){(0,P.Q6)(this,S.Object3D.DEFAULT_UP,{position:this.position,quaternion:this.quaternion})}clone(){let o=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return new L({t_s:0,focalLength:0,position:new S.Vector3,quaternion:new S.Quaternion,target:new S.Vector3,smoothness:1},this.keyframeType).copy(this,o)}copy(o){let C=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return C&&(this.id=o.id),this.t_s=o.t_s,this.focalLength=o.focalLength,this.position.copy(o.position),this.quaternion.copy(o.quaternion),this.target.copy(o.target),this.lookAtRelativeQuaternion.copy(o.lookAtRelativeQuaternion),this.azimuth=o.azimuth,this.elevation=o.elevation,this.radius=o.radius,this.smoothness=o.smoothness,this}constructor(o,C){this.isKeyframe=!0,this.azimuth=0,this.elevation=0,this.radius=0,this.lookAtRelativeQuaternion=new S.Quaternion,this.smoothness=1,this.keyframeType=C,this.id=D++,this.t_s=o.t_s,this.position=o.position,this.quaternion=o.quaternion,this.target=o.target,this.focalLength=o.focalLength,this.smoothness=o.smoothness,(0,P.Zy)({position:this.position,quaternion:this.quaternion},S.Object3D.DEFAULT_UP,this)}}!function(o){function C(C,M){var _,E;let L=M&&C.length>1,I=.01,T=0;for(let o=0;o<C.length;o++){let M=C[o];1!==M.keyframeType&&(T=Math.max(T,M.t_s))}let R=null;for(let o=C.length-1;o>=0;o--){let M=C[o];1===M.keyframeType&&(L?null!=R?C.splice(o,1):R=M:C.splice(o,1))}if(null!=R&&R.t_s<T&&(R.t_s=T+.2),C.sort((o,C)=>o.t_s-C.t_s),L){if(null==R){let M=o.averageDt(C);R=new o({t_s:T+(M||2),focalLength:1,position:new S.Vector3,quaternion:new S.Quaternion,target:new S.Vector3,smoothness:1},1),C.push(R)}let M=C[0],_=C[C.length-2];R.focalLength=M.focalLength,R.position.copy(M.position),R.quaternion.copy(M.quaternion),R.target.copy(M.target),R.lookAtRelativeQuaternion.copy(M.lookAtRelativeQuaternion),R.azimuth=(0,P.SI)(M.azimuth,_.azimuth),R.elevation=(0,P.SI)(M.elevation,_.elevation),R.radius=M.radius,R.smoothness=M.smoothness}let V=0;for(let o of C)V=Math.max(V,o.id);let F=new Set;for(let o of C)F.has(o.id)&&(o.id=++V),F.add(o.id);D=V+1;let O=null!==(E=null===(_=C[0])||void 0===_?void 0:_.t_s)&&void 0!==E?E:0;for(let o of C)o.t_s-=O;for(;;){let o=!1;for(let M=0;M<C.length-1;M++){let _=C[M],S=C[M+1];Math.abs(S.t_s-_.t_s)<I&&(S.t_s=S.t_s+I,o=!0)}if(!o)break}return C}function M(C,M,_,S,E){return new o({t_s:C,position:M.clone(),quaternion:_.clone(),target:S.clone(),focalLength:E,smoothness:1},0)}function _(o,C){let M=(0,E.i6)(window.luma.camera.origin,R);return L((0,E.mG)(T),o,M,C)}function L(C,M,_,E){let P=new S.Vector3,D=new S.Quaternion;C.decompose(P,D,V);let L=T.lookAt(P,_,O),I=F.setFromRotationMatrix(L);return D.clone().premultiply(I.invert()),new o({t_s:M,position:P,quaternion:D,target:_,focalLength:E,smoothness:1},0)}function I(o){let C=0;for(let M=1;M<o.length;M++)C+=o[M].t_s-o[M-1].t_s;return C/(o.length-1)}o.processKeyframes=C,o.createKeyframe=M,o.getKeyframeFromLumaCamera=_,o.getKeyframeFromTransform=L,o.averageDt=I;let T=new S.Matrix4;new S.Vector3;let R=new S.Vector3,V=new S.Vector3;new S.Quaternion;let F=new S.Quaternion;new S.Quaternion;let O=new S.Vector3(0,1,0)}(L||(L={}))},39405:function(o,C,M){"use strict";M.d(C,{Es:function(){return et},Ft:function(){return P},HY:function(){return D},Q6:function(){return H},SI:function(){return J},Zy:function(){return W},aL:function(){return U},al:function(){return K},iQ:function(){return Z},n2:function(){return Q},nU:function(){return L},pg:function(){return G},t7:function(){return $},tE:function(){return er},tr:function(){return ee},xG:function(){return X}});var _=M(9781),S=M(12837),E=M(56764);function P(o,C,M,E,P){let D=Q(o,C),L=(0,S.Dv)().clone().invert();D.aspect=M;let I=new _.AnimationMixer(o),T=0,R=1/P;for(let C of o.animations){let o=I.clipAction(C);o._updateTime=C=>o.time+=C,o.play(),T=Math.max(T,C.duration)}T=Math.min(T,E);let F=[],O=[],N=[];for(let o=0;o<T;o+=R){I.setTime(Math.min(o,T)),D.updateMatrixWorld(!0);let C=D.matrixWorld.clone().premultiply(L);F.push(C),O.push(D.getFocalLength()),N.push(D.fov)}let H=F.map(o=>{let C=(0,S.Mv)(V(o));return[[C[0],-C[4],C[8],C[12]],[C[1],-C[5],C[9],C[13]],[C[2],-C[6],C[10],C[14]]]});return Z(o,C,D),{c2w:H,focalLength:O,fovVertical:N}}function D(){let o=(0,S.Dv)().clone().invert(),C=(0,S.i6)(window.luma.options.crop_min),M=(0,S.i6)(window.luma.options.crop_max),E=new _.Vector3,P=new _.Quaternion,D=new _.Vector3;o.decompose(E,P,D);let L=E.clone().applyQuaternion(P.clone().invert()),I=C.clone().multiply(D).add(L),T=M.clone().multiply(D).add(L),R=(0,S.gr)(I),V=(0,S.gr)(T),F=[R[0],R[1],R[2],V[0],V[1],V[2]],O=new _.Matrix4().makeRotationFromQuaternion(P),N=(0,S.Mv)(O),H=[N[0],-N[4],N[8],N[1],-N[5],N[9],N[2],-N[6],N[10]],U=F.every(o=>isFinite(o)&&null!=o);return{aabb:U?F:null,aabb_rotation:U?H:null}}function L(o,C){let M=o.elements;return C.set(M[8],M[4],-M[0],M[12],M[9],M[5],-M[1],M[13],M[10],M[6],-M[2],M[14],M[11],M[7],-M[3],M[15]),C}let I=new _.Vector3,T=new _.Vector3,R=new _.Vector3;function V(o){return o.extractBasis(I,T,R),I.normalize(),T.normalize(),R.normalize(),o.elements[0]=I.x,o.elements[1]=I.y,o.elements[2]=I.z,o.elements[4]=T.x,o.elements[5]=T.y,o.elements[6]=T.z,o.elements[8]=R.x,o.elements[9]=R.y,o.elements[10]=R.z,o}let F=new _.Matrix4,O=new _.Quaternion,N=new _.Vector3;function H(o,C,M){let _=F;return _.identity(),M.position.set(o.radius*Math.cos(o.azimuth)*Math.cos(o.elevation)+o.target.x,o.radius*Math.sin(o.elevation)+o.target.y,o.radius*Math.sin(o.azimuth)*Math.cos(o.elevation)+o.target.z),_.setPosition(M.position),_.lookAt(M.position,o.target,C),M.quaternion.setFromRotationMatrix(_),M.quaternion.multiply(o.lookAtRelativeQuaternion),M}function U(o){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{azimuth:0,elevation:0,radius:0},M=o;return C.radius=Math.sqrt(M.x*M.x+M.y*M.y+M.z*M.z),C.azimuth=Math.atan2(M.z,M.x),C.elevation=Math.atan2(M.y,Math.sqrt(M.x*M.x+M.z*M.z)),C}function G(o,C){return C||(C={x:0,y:0,z:0}),C.x=o.radius*Math.cos(o.azimuth)*Math.cos(o.elevation),C.y=o.radius*Math.sin(o.elevation),C.z=o.radius*Math.sin(o.azimuth)*Math.cos(o.elevation),C}function W(o,C,M){let _=N.copy(o.position).sub(M.target);M.azimuth=Math.atan2(_.z,_.x),M.elevation=Math.atan2(_.y,Math.sqrt(_.x*_.x+_.z*_.z)),M.radius=_.length();let S=F.lookAt(o.position,M.target,C),E=O.setFromRotationMatrix(S);return M.lookAtRelativeQuaternion.copy(o.quaternion).premultiply(E.invert()),M}function K(o){return(null==o?void 0:o.isKeyframe)===!0}function X(o){return o instanceof E.N}function Q(o,C){var M;let _=null!==(M=C.parent)&&void 0!==M?M:o;C.removeFromParent();let S=C.clone();return S.name=C.name,_.add(S),S}function Z(o,C,M){var _;let S=null!==(_=M.parent)&&void 0!==_?_:o;M.removeFromParent(),S.add(C)}function Y(o){return o-Math.floor(o)}function J(o,C){let M;let _=2*Math.PI,S=o/_+.5-Y(C/_+.5);if(.5>Math.abs(S))M=C+S*_;else{let o=1-Math.abs(S);M=C+-Math.sign(S)*o*_}return M}function $(o,C,M){return o+(C-o)*M}function ee(o){return ei(o,new _.Vector3(0,1,0),new _.Vector3(0,0,-1))}function et(o){return ei(o,new _.Vector3(0,0,-1),new _.Vector3(1,0,0))}function er(o){return ei(o,new _.Vector3(1,0,0),new _.Vector3(0,1,0))}function ei(o,C,M){let _=C.clone().applyQuaternion(o),S=M.clone().applyQuaternion(o),E=_.projectOnPlane(S),P=C.clone().projectOnPlane(S);return P.angleTo(E)*Math.sign(P.cross(E).dot(S))}},29416:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{R:function(){return InputNumber}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5833),_radix_ui_react_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(57224),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(53961),_Input_module_scss__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(28049),_Input_module_scss__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_Input_module_scss__WEBPACK_IMPORTED_MODULE_3__);function InputNumber(props){var _props_type,_props_showLabel,_props_showDot,_props_label;let toDisplay,fromDisplay;let onChangeRef=(0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(props.onChange),onChangeEndRef=(0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(props.onChangeEnd);function setValueFromString(str,userInput){let displayValue;try{let evaluated=eval(str);displayValue="number"==typeof evaluated?"int"===type?Math.round(evaluated):evaluated:("int"===type?parseInt(str):parseFloat(str))||0}catch(e){displayValue=("int"===type?parseInt(str):parseFloat(str))||0}void 0!==props.min&&(displayValue=Math.max(displayValue,props.min)),void 0!==props.max&&(displayValue=Math.min(displayValue,props.max));let v=fromDisplay(displayValue),changed=props.obj[props.field]!==v;if(userInput&&changed){var _onChangeRef_current;props.obj[props.field]=v,null===(_onChangeRef_current=onChangeRef.current)||void 0===_onChangeRef_current||_onChangeRef_current.call(onChangeRef,v,props.obj,props.field)}}function getDisplayValue(){let o=props.obj[props.field];return null!=props.conversion?toDisplay(o):o}function getObjectValueString(){let o=getDisplayValue();return"int"===type?Math.round(o).toString():o.toFixed(3)}(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{onChangeRef.current=props.onChange,onChangeEndRef.current=props.onChangeEnd},[props.onChange,props.onChangeEnd]),"radiansToDegrees"===props.conversion?(toDisplay=o=>180*o/Math.PI,fromDisplay=o=>o*Math.PI/180):props.conversion?(toDisplay=props.conversion.toDisplay,fromDisplay=props.conversion.fromDisplay):(toDisplay=o=>o,fromDisplay=o=>o);let id=props.field+"-InputNumber",type=null!==(_props_type=props.type)&&void 0!==_props_type?_props_type:"float",showLabel=null===(_props_showLabel=props.showLabel)||void 0===_props_showLabel||_props_showLabel,showDot=null!==(_props_showDot=props.showDot)&&void 0!==_props_showDot&&_props_showDot,[objectValueAsStr,setObjectValueAsString]=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(getObjectValueString()),[editing,setEditing]=(0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1),labelRef=(0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null),inputRef=(0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{let o=setInterval(()=>{if(editing)return;let o=getObjectValueString();o!==objectValueAsStr&&setObjectValueAsString(o+"")},1e3/60);return()=>clearInterval(o)},[objectValueAsStr,props.obj,props.field,editing]),(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{let o,C;if(props.disabled)return;let M=labelRef.current,_=M=>{o=getDisplayValue(),C=M.clientX,document.addEventListener("mousemove",S),document.addEventListener("mouseup",E)},S=M=>{var _;if(0===M.buttons){E(M);return}let S=M.clientX-C,P=null!==(_=props.changeDelta)&&void 0!==_?_:Math.abs(o)+1,D=o+S*("int"===type?1:.0075*P);void 0!==props.min&&(D=Math.max(D,props.min)),void 0!==props.max&&(D=Math.min(D,props.max)),setObjectValueAsString(D+""),setValueFromString(D+"",!0)},E=o=>{var C;document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",E),null===(C=onChangeEndRef.current)||void 0===C||C.call(onChangeEndRef,props.obj[props.field],props.obj,props.field)};return M.addEventListener("mousedown",_),()=>{M.removeEventListener("mousedown",_),document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",E)}},[props.obj,props.field,type,props.min,props.max,props.disabled,props.changeDelta]),(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{var o;let C=o=>{if("Enter"===o.key){var C;null===(C=inputRef.current)||void 0===C||C.blur()}o.stopPropagation()};return null===(o=inputRef.current)||void 0===o||o.addEventListener("keydown",C),()=>{var o;return null===(o=inputRef.current)||void 0===o?void 0:o.removeEventListener("keydown",C)}},[props.obj,props.field]);let valueFloat=parseFloat(objectValueAsStr),valueDisplay="int"===type?valueFloat.toFixed(0):valueFloat.toFixed(2);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_Input_module_scss__WEBPACK_IMPORTED_MODULE_3___default().inputNumber+" "+(props.disabled?_Input_module_scss__WEBPACK_IMPORTED_MODULE_3___default().disabled:"")+" InputNumber",style:props.style,onMouseEnter:()=>{var o;return null===(o=props.onHoverStart)||void 0===o?void 0:o.call(props,props.obj,props.field)},onMouseLeave:()=>{var o;return null===(o=props.onHoverEnd)||void 0===o?void 0:o.call(props,props.obj,props.field)},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("label",{ref:labelRef,className:_Input_module_scss__WEBPACK_IMPORTED_MODULE_3___default().inlineLabel+" ",htmlFor:id,title:props.title,style:{cursor:"ew-resize"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{style:{display:showLabel?"":"none"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("b",{children:null!==(_props_label=props.label)&&void 0!==_props_label?_props_label:props.field})}),showDot&&!props.disabled&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_radix_ui_react_icons__WEBPACK_IMPORTED_MODULE_1__.jXb,{style:{verticalAlign:"middle"}})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{ref:inputRef,contentEditable:!props.disabled,suppressContentEditableWarning:!0,spellCheck:!1,id:id,className:_Input_module_scss__WEBPACK_IMPORTED_MODULE_3___default().numberInput,onInput:o=>{setValueFromString(o.currentTarget.innerText,!0)},onFocus:()=>{var o;setEditing(!0),null===(o=props.onFocus)||void 0===o||o.call(props,props.obj,props.field)},onBlur:()=>{var o,C;setEditing(!1),setObjectValueAsString(getObjectValueString()),null===(o=onChangeEndRef.current)||void 0===o||o.call(onChangeEndRef,props.obj[props.field],props.obj,props.field),null===(C=props.onBlur)||void 0===C||C.call(props,props.obj,props.field)},title:props.title,children:editing?objectValueAsStr:valueDisplay}),props.units&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:_Input_module_scss__WEBPACK_IMPORTED_MODULE_3___default().units,children:props.units})]})}},27367:function(o,C,M){"use strict";M.d(C,{v:function(){return _}});class _{addListener(o){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,M={priority:C,listener:o,remove:()=>this.removeListener(o)};return null!==o&&this.listeners.push(M),M}removeListener(o){let C=0;for(;C<this.listeners.length&&this.listeners[C].listener!==o;C++);this.listeners.splice(C,1)}once(o){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,M=C=>{o(C),this.removeListener(M)};return this.addListener(M,C)}dispatch(o,C){if(0!==this.listeners.length)return this.dispatchWithExistingEvent(o,C)}dispatchWithExistingEvent(o){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(0===this.listeners.length)return;let M=this.patchPayload(o);this.sortPriorityDescending();for(let o=0;o<this.listeners.length;o++)if(!(this.listeners[o].priority>C)&&(this.listeners[o].listener(M),"object"==typeof M&&M.propagationStopped))return}hasListeners(){return this.listeners.length>0}sortPriorityDescending(){this.listeners.sort((o,C)=>C.priority-o.priority)}patchPayload(o){return o instanceof Event&&void 0===o.propagationStopped&&(o.propagationStopped=!1,o._stopPropagation=o.stopPropagation,o.stopPropagation=S),o}constructor(){this.listeners=[]}}function S(){this.propagationStopped=!0,this._stopPropagation()}},81068:function(o,C,M){"use strict";var _;M.d(C,{m:function(){return _}}),function(o){o[o.Base=0]="Base",o[o.Interactive=1]="Interactive",o[o.UserInterface=2]="UserInterface",o[o.Developer=3]="Developer"}(_||(_={}))},68623:function(o,C,M){"use strict";M.d(C,{L:function(){return E}});var _=M(27367),S=M(30125);class E{springTo(o,C,M){let _=arguments.length>3&&void 0!==arguments[3]?arguments[3]:S.A.Exponential(.5);if(null!=_){if(o[C]===M)return;let S=this.getSpringOrCreate(o,C);S.target=M,S.params=_}else this.setTo(o,C,M)}setTo(o,C,M){this.remove(o,C),o[C]=M}step(o){this.onBeforeStep.hasListeners()&&this.onBeforeStep.dispatch({dt_s:o});let C=this._springState;this.springs.forEach((M,_)=>{M.forEach((E,P)=>{C.x=_[P],C.targetX=E.target,C.v=E.velocity,null!=E.params?S.A.stepSpring(o,C,E.params):(C.x=C.targetX,C.v=0),_[P]=C.x,E.velocity=C.v,1e-4>Math.abs(C.x-C.targetX)&&1e-4>Math.abs(C.v)&&(_[P]=E.target,M.delete(P))}),0==M.size&&this.springs.delete(_)}),this.onAfterStep.hasListeners()&&this.onAfterStep.dispatch({dt_s:o})}tick(){let o=performance.now()/1e3,C=this.t_last>=0?o-this.t_last:1/60;return this.t_last=o,this.step(C),C}remove(o,C){let M=this.springs.get(o);null!=M&&M.delete(C),null!=M&&0==M.size&&this.springs.delete(o)}removeObject(o){this.springs.delete(o)}removeAll(){this.springs.clear()}getVelocity(o,C){var M;let _=this.getObjectSprings(o).get(C);return null!==(M=null==_?void 0:_.velocity)&&void 0!==M?M:0}getObjectSprings(o){let C=this.springs.get(o);return null==C&&(C=new Map,this.springs.set(o,C)),C}getSpringOrCreate(o,C){let M=this.getObjectSprings(o),_=M.get(C);return null==_&&(_={target:0,params:null,velocity:0},M.set(C,_)),_}constructor(o,C){this.onBeforeStep=new _.v,this.onAfterStep=new _.v,this.springs=new Map,this._springState={x:0,targetX:0,v:0},this.t_last=-1,o&&this.onBeforeStep.addListener(C=>o(C.dt_s)),C&&this.onAfterStep.addListener(o=>C(o.dt_s))}}},30125:function(o,C,M){"use strict";var _;M.d(C,{A:function(){return _}}),function(o){function C(o){let C=3.356694/o,M=C*C/4;return{damping:C,strength:M}}function M(o,C){let M=2*Math.log(2)/o,_=M*M+C;return{damping:M,strength:_}}function _(o,C,M){let _=M.strength,S=M.damping,E=o,P=C.v,D=C.x-C.targetX;if(0===D&&0===P||0===o)return;let L=4*_-S*S;if(L>0){let o=.5*Math.sqrt(L),M=D,_=(S*D*.5+P)/o,I=Math.exp(-(.5*S)*E),T=Math.cos(o*E),R=Math.sin(o*E),V=I*(M*T+_*R),F=I*((_*o-.5*M*S)*T+(-M*o-.5*S*_)*R);C.v=F,C.x=V+C.targetX}else if(L<0){let o=.5*Math.sqrt(-L),M=-.5*S+o,_=-.5*S-o,I=-(_*D-P)/(2*o),T=D-I,R=Math.exp(M*E),V=Math.exp(_*E),F=T*V+I*R,O=T*_*V+I*M*R;C.v=O,C.x=F+C.targetX}else{let o=Math.sqrt(_),M=D,S=P+o*D,L=Math.exp(-o*E),I=(M+S*E)*L,T=(S-o*(M+S*E))*L;C.v=T,C.x=I+C.targetX}return .5*_*C.x*C.x}o.Exponential=C,o.Underdamped=M,o.stepSpring=_}(_||(_={}))},9449:function(o,C,M){"use strict";M.d(C,{I:function(){return D},h:function(){return _}});var _,S=M(9781),E=M(68623),P=M(30125);!function(o){o[o.DirectionRollCartesian=0]="DirectionRollCartesian",o[o.YawPitchRoll=1]="YawPitchRoll"}(_||(_={}));class D{springTo(o,C,M){let _=arguments.length>3&&void 0!==arguments[3]?arguments[3]:P.A.Exponential(.5),E=arguments.length>4?arguments[4]:void 0;if(M instanceof S.Vector4){let S=o[C];this.animator.springTo(S,"x",M.x,_),this.animator.springTo(S,"y",M.y,_),this.animator.springTo(S,"z",M.z,_),this.animator.springTo(S,"w",M.w,_)}else if(M instanceof S.Vector3){let S=o[C];this.animator.springTo(S,"x",M.x,_),this.animator.springTo(S,"y",M.y,_),this.animator.springTo(S,"z",M.z,_)}else if(M instanceof S.Vector2){let S=o[C];this.animator.springTo(S,"x",M.x,_),this.animator.springTo(S,"y",M.y,_)}else if(M instanceof S.Quaternion){let S=o[C],P=this.getQuaternionSpring(S);P.target.copy(M).normalize(),P.params=_,P.mode=null!=E?E:0}else if(M instanceof S.Euler){let S=o[C];this.animator.springTo(S,"x",M.x,_),this.animator.springTo(S,"y",M.y,_),this.animator.springTo(S,"z",M.z,_),S.order=M.order}else this.animator.springTo(o,C,M,_)}step(o){this.animator.step(o)}tick(){this.animator.tick()}removeAll(){this.animator.removeAll(),this.quaternionSprings.clear()}getVelocity(o,C,M){let _=o[C];if(_ instanceof S.Vector4){let o=null!=M?M:new S.Vector4;return o.x=this.animator.getVelocity(_,"x"),o.y=this.animator.getVelocity(_,"y"),o.z=this.animator.getVelocity(_,"z"),o.w=this.animator.getVelocity(_,"w"),o}if(_ instanceof S.Vector3){let o=null!=M?M:new S.Vector3;return o.x=this.animator.getVelocity(_,"x"),o.y=this.animator.getVelocity(_,"y"),o.z=this.animator.getVelocity(_,"z"),o}if(_ instanceof S.Vector2){let o=null!=M?M:new S.Vector2;return o.x=this.animator.getVelocity(_,"x"),o.y=this.animator.getVelocity(_,"y"),o}if(_ instanceof S.Quaternion){var E,P;let o=this.quaternionSprings.get(_);return{directionVelocity:null!==(E=null==o?void 0:o.directionVelocity)&&void 0!==E?E:new S.Vector3,rollVelocity:null!==(P=null==o?void 0:o.rollVelocity)&&void 0!==P?P:0}}{if(!(_ instanceof S.Euler))return this.animator.getVelocity(o,C);let E=null!=M?M:new S.Euler;return E.x=this.animator.getVelocity(_,"x"),E.y=this.animator.getVelocity(_,"y"),E.z=this.animator.getVelocity(_,"z"),E.order=_.order,E}}stepQuaternionSprings(o){this.quaternionSprings.forEach((C,M)=>{C.params?0===C.mode?O(o,C,C.params):N(o,C,C.params):(M.copy(C.target),C.directionVelocity.set(0,0,0),C.rollVelocity=0),Math.abs(M.dot(C.target))>.999&&1e-4>C.directionVelocity.lengthSq()&&1e-4>Math.abs(C.rollVelocity)&&this.quaternionSprings.delete(M)})}getQuaternionSpring(o){let C=this.quaternionSprings.get(o);if(!C){L.makeRotationFromQuaternion(o);let M=new S.Vector3;L.extractBasis(new S.Vector3,new S.Vector3,M),C={q:o,target:new S.Quaternion,direction:M,directionVelocity:new S.Vector3,rollVelocity:0,params:null,mode:0},this.quaternionSprings.set(o,C)}return C}constructor(){this.animator=new E.L(this.stepQuaternionSprings.bind(this)),this.onAfterStep=this.animator.onAfterStep,this.onBeforeStep=this.animator.onBeforeStep,this.quaternionSprings=new Map}}let L=new S.Matrix4,I=new S.Vector3,T=new S.Vector3,R=new S.Vector3,V=new S.Matrix4,F={x:0,v:0,targetX:0};function O(o,C,M){let _=new S.Vector3,E=new S.Vector3;L.makeRotationFromQuaternion(C.target),L.extractBasis(I,E,_);let D=C.direction.clone();F.x=C.direction.x,F.v=C.directionVelocity.x,F.targetX=_.x,P.A.stepSpring(o,F,M),C.direction.x=F.x,C.directionVelocity.x=F.v,F.x=C.direction.y,F.v=C.directionVelocity.y,F.targetX=_.y,P.A.stepSpring(o,F,M),C.direction.y=F.x,C.directionVelocity.y=F.v,F.x=C.direction.z,F.v=C.directionVelocity.z,F.targetX=_.z,P.A.stepSpring(o,F,M),C.direction.z=F.x,C.directionVelocity.z=F.v;let O=new S.Quaternion().setFromUnitVectors(I.copy(D).normalize(),T.copy(C.direction).normalize());C.q.premultiply(O),W(C.q,C.direction,V);let N=new S.Quaternion().setFromUnitVectors(C.direction.clone().normalize(),_);L.makeRotationFromQuaternion(C.q),L.extractBasis(I,T,R);let H=T.applyQuaternion(N).clone(),U=2*Math.acos(Math.min(1,Math.max(-1,new S.Quaternion().setFromUnitVectors(H,E).w)));U=-(0>I.crossVectors(H,E).dot(_)?-1:1)*U,F.x=U,F.v=C.rollVelocity,F.targetX=0,P.A.stepSpring(o,F,M),C.rollVelocity=F.v;let G=F.x-U,K=new S.Quaternion().setFromAxisAngle(C.direction.clone().normalize(),G);C.q.premultiply(K),C.q.normalize()}function N(o,C,M){let _=C.directionVelocity.x,E=C.directionVelocity.y,D=H(C.q),L=H(C.target);F.x=D.x,F.v=E,F.targetX=K(L.x,D.x),P.A.stepSpring(o,F,M),E=F.v;let I=F.x;F.x=D.y,F.v=_,F.targetX=K(L.y,D.y),P.A.stepSpring(o,F,M),_=F.v;let T=F.x;C.directionVelocity.x=_,C.directionVelocity.y=E;let R=new S.Vector3(Math.cos(T)*Math.cos(I),Math.sin(I),Math.sin(T)*Math.cos(I)).normalize();F.x=D.z,F.v=C.rollVelocity,F.targetX=K(L.z,D.z),P.A.stepSpring(o,F,M),C.rollVelocity=F.v;let O=F.x;W(C.q,R,V),U(C.q,O)}function H(o){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S.Vector3;L.makeRotationFromQuaternion(o),L.extractBasis(I,T,R);let M=Math.atan2(R.z,R.x),_=Math.atan2(R.y,Math.sqrt(R.x*R.x+R.z*R.z)),E=Q(o);return C.set(_,M,E),C}function U(o,C){let M=C-Q(o),_=new S.Vector3(0,0,-1).applyQuaternion(o),E=new S.Quaternion().setFromAxisAngle(_,M);o.premultiply(E)}let G=new S.Vector3;function W(o,C){let M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new S.Matrix4;return M.makeRotationFromQuaternion(o),M.extractBasis(I,T,R),G.copy(C).normalize(),I.crossVectors(T,G).normalize(),T.crossVectors(G,I).normalize(),M.makeBasis(I,T,G),o.setFromRotationMatrix(M),M}function K(o,C){let M;let _=2*Math.PI,S=o/_+.5-X(C/_+.5);if(.5>Math.abs(S))M=C+S*_;else{let o=1-Math.abs(S);M=C+-Math.sign(S)*o*_}return M}function X(o){return o-Math.floor(o)}function Q(o){return Z(o,new S.Vector3(0,1,0),new S.Vector3(0,0,-1))}function Z(o,C,M){let _=C.clone().applyQuaternion(o),S=M.clone().applyQuaternion(o),E=_.projectOnPlane(S),P=C.clone().projectOnPlane(S);return P.angleTo(E)*Math.sign(P.cross(E).dot(S))}},24994:function(o,C,M){"use strict";M.d(C,{Z:function(){return S}});var _=M(27367);class S{attachEventListeners(){this.attached||(this.el.addEventListener("gesturestart",this.cancelEvent,!1),this.el.addEventListener("gesturechange",this.cancelEvent,!1),this.el.addEventListener("pointerdown",this.handlePointerDown,{passive:!1}),this.el.addEventListener("pointermove",this.handlePointerMove,{passive:!1}),this.el.addEventListener("pointerup",this.handlePointerUp,{passive:!1}),this.el.addEventListener("pointercancel",this.handlePointerCancel,{passive:!1}),this.el.addEventListener("wheel",this.handleWheel,{passive:!1}),this.el.addEventListener("contextmenu",this.handleContextMenu,{passive:!1}),window.addEventListener("pointerup",this.handleGlobalPointerUp,{capture:!0}),window.addEventListener("pointercancel",this.handleGlobalPointerUp,{capture:!0}),window.addEventListener("pointermove",this.handleGlobalPointerMove,{capture:!0}),window.addEventListener("keydown",this.handleKeyDown,{passive:!1}),window.addEventListener("keyup",this.handleKeyUp,{passive:!1}),this.attached=!0)}removeEventListeners(){this.el.removeEventListener("gesturestart",this.cancelEvent,!1),this.el.removeEventListener("gesturechange",this.cancelEvent,!1),this.el.removeEventListener("pointerdown",this.handlePointerDown),this.el.removeEventListener("pointermove",this.handlePointerMove),this.el.removeEventListener("pointerup",this.handlePointerUp),this.el.removeEventListener("pointercancel",this.handlePointerCancel),this.el.removeEventListener("wheel",this.handleWheel),window.removeEventListener("pointerup",this.handleGlobalPointerUp,{capture:!0}),window.removeEventListener("pointercancel",this.handleGlobalPointerUp,{capture:!0}),window.removeEventListener("pointermove",this.handleGlobalPointerMove,{capture:!0}),window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),this.el.removeEventListener("touchstart",this.cancelEvent),this.attached=!1}clearDefaultBehavior(){this.el.style.touchAction="",this.el.style.userSelect="",this.el.style.webkitUserSelect="",this.el.removeAttribute("touch-action"),this.el.removeEventListener("touchstart",this.cancelEvent)}constructor(o,C={}){this.events={pointerDown:new _.v,pointerMove:new _.v,pointerUp:new _.v,pointerCancel:new _.v,globalPointerUp:new _.v,wheel:new _.v,contextMenu:new _.v,keyDown:new _.v,keyUp:new _.v},this.attached=!1,this.activePointers={},this.activeButtons={},this.cancelEvent=o=>{o.preventDefault(),o.stopPropagation()},this.handlePointerDown=o=>{this.activePointers[o.pointerId]=o,this.activeButtons[o.pointerId]=o.buttons,this.events.pointerDown.dispatchWithExistingEvent(o)},this.handlePointerMove=o=>{this.activePointers[o.pointerId]=o,this.events.pointerMove.dispatchWithExistingEvent(o),this.autoCapturePointer&&o.buttons>0&&!this.el.hasPointerCapture(o.pointerId)&&this.el.setPointerCapture(o.pointerId)},this.commonPointerUp=o=>{0===o.buttons?(delete this.activePointers[o.pointerId],delete this.activeButtons[o.pointerId]):this.activeButtons[o.pointerId]=o.buttons},this.handlePointerUp=o=>{this.commonPointerUp(o),this.events.pointerUp.dispatchWithExistingEvent(o)},this.handlePointerCancel=o=>{this.commonPointerUp(o),this.events.pointerCancel.dispatchWithExistingEvent(o)},this.handleGlobalPointerUp=o=>{this.commonPointerUp(o),this.events.globalPointerUp.dispatchWithExistingEvent(o)},this.handleGlobalPointerMove=o=>{let C=this.activeButtons[o.pointerId],M=o.buttons,_=C&~M;if(_>0){for(let C=0;C<32;C++)if(_&1<<C){let C=new PointerEvent("pointerup",o);this.el.hasPointerCapture(o.pointerId)||C.target===this.el?this.events.pointerUp.dispatchWithExistingEvent(C):this.events.globalPointerUp.dispatchWithExistingEvent(C)}}this.activeButtons[o.pointerId]=M},this.handleWheel=o=>{this.events.wheel.dispatchWithExistingEvent(o)},this.handleContextMenu=o=>{this.events.contextMenu.dispatchWithExistingEvent(o)},this.handleKeyDown=o=>{this.events.keyDown.dispatchWithExistingEvent(o)},this.handleKeyUp=o=>{this.events.keyUp.dispatchWithExistingEvent(o)};let M={disableDefaultBehavior:!0,autoCapturePointer:!0,...C};this.el=o,this.pointerEventsSupported=void 0!==window.PointerEvent,this.attachEventListeners(),this.autoCapturePointer=M.autoCapturePointer,M.disableDefaultBehavior&&(this.el.style.touchAction="none",this.el.style.userSelect="none",this.el.style.webkitUserSelect="none",this.el.setAttribute("touch-action","none"),this.el.addEventListener("touchstart",this.cancelEvent))}}},16147:function(o,C,M){"use strict";M.d(C,{Z:function(){return E},x:function(){return P}});var _=M(9781),S=M(81068);class E{dispose(){for(let o of this.listeners)o.remove()}prepareRaycastWithPointer(o){let C=this.clientToClipSpace(o);return this.raycaster.setFromCamera(new _.Vector2(C.x,C.y),this.camera),this.raycaster}intersectSceneClipSpace(o){this.raycaster.setFromCamera(new _.Vector2(o.x,o.y),this.camera);let C=this.raycaster.intersectObjects(this.scene.children,!0),M=[];for(let o of C)(!0===o.object.userData.interactiveWhenInvisible||this.isVisible(o.object))&&M.push(o);M.sort((o,C)=>{var M,_;let S=null!==(M=o.object.userData.sortPriority)&&void 0!==M?M:0,E=null!==(_=C.object.userData.sortPriority)&&void 0!==_?_:0;return S!==E?E-S:o.distance-C.distance});for(let o=0;o<M.length;o++)if(!0===M[o].object.userData.occludePointerEvents){M.splice(o+1);break}return M}intersectSceneWithPointer(o){return this.intersectSceneClipSpace(this.clientToClipSpace(o))}clientToClipSpace(o){return{x:o.clientX/this.interactionManager.el.clientWidth*2-1,y:-(o.clientY/this.interactionManager.el.clientHeight*2)+1}}setCursor(o){this.interactionManager.el.style.cursor=o}isVisible(o){let C=!0,M=o;for(;null!=M;){if(!1===M.visible){C=!1;break}M=M.parent}return C}constructor(o,C,M,E=1){this.raycaster=new _.Raycaster,this.capturedPointers={},this.hoveredObjects={},this.onPointerDown=o=>{for(let _ of this.intersectSceneWithPointer(o)){var C,M;let S;let E=_.object;if(null!=E.userData.onPointerDown){let C=E.userData.onPointerDown(o,this.raycaster,_);null!=C&&(S=C)}if((null===(C=E.userData.capturePointer)||void 0===C||C)&&!1!==S){this.interactionManager.el.setPointerCapture(o.pointerId);let C=null!==(M=this.capturedPointers[o.pointerId])&&void 0!==M?M:[];C.push(E),this.capturedPointers[o.pointerId]=C}if(o.propagationStopped)return}},this.onPointerMove=o=>{var C;let M=null,_=this.capturedPointers[o.pointerId];if(null!=_)for(let C=_.length-1;C>=0;C--){let S=_[C];null!=S.userData.onPointerMove&&S.userData.onPointerMove(o,!0,this.raycaster,void 0),M=S.userData.cursor}let S=this.intersectSceneWithPointer(o),E=null!==(C=this.hoveredObjects[o.pointerId])&&void 0!==C?C:[];for(let C of(this.hoveredObjects[o.pointerId]=E,E)){let M=!1;for(let o of S)if(o.object===C){M=!0;break}if(!M){if(null!=C.userData.onPointerOut){let M=(null==_?void 0:_.indexOf(C))!==-1;C.userData.onPointerOut(o,M,this.raycaster)}E.splice(E.indexOf(C),1)}}for(let C of S){let S=C.object,P=(null==_?void 0:_.indexOf(S))!==-1;if(P||null==S.userData.onPointerMove||S.userData.onPointerMove(o,!1,this.raycaster,C),null==M&&null!=S.userData.cursor&&(M=S.userData.cursor),-1===E.indexOf(S)&&(E.push(S),null!=S.userData.onPointerOver&&S.userData.onPointerOver(o,P,this.raycaster,C)),o.propagationStopped)return}this.setCursor(null!=M?M:"")},this.onPointerUp=o=>{let C=this.capturedPointers[o.pointerId];if(delete this.capturedPointers[o.pointerId],delete this.hoveredObjects[o.pointerId],this.interactionManager.el.releasePointerCapture(o.pointerId),null!=C)for(let M=C.length-1;M>=0;M--){let _=C[M];null!=_.userData.onPointerUp&&_.userData.onPointerUp(o,!0,this.raycaster)}for(let M of this.intersectSceneWithPointer(o)){let _=M.object;if((null==C?void 0:C.indexOf(_))===-1&&(null!=_.userData.onPointerUp&&_.userData.onPointerUp(o,!1,this.raycaster,M),o.propagationStopped))return}},this.interactionManager=o,this.scene=C,this.camera=M,this.raycaster.layers.set(S.m.Interactive),this.listeners=[o.events.pointerDown.addListener(this.onPointerDown,E),o.events.pointerMove.addListener(this.onPointerMove,E),o.events.pointerUp.addListener(this.onPointerUp,E),o.events.pointerCancel.addListener(this.onPointerUp,E)]}}function P(o,C){return o.layers.enable(S.m.Interactive),o.userData=C,o}},47555:function(o,C,M){"use strict";M.d(C,{Mu:function(){return R}});var _,S=M(9781),E=M(8670),P=M(68623),D=M(27367),L=M(30125),I=M(16147);let T=L.A.Exponential(.05);!function(o){o[o.Translate=0]="Translate",o[o.Rotate=1]="Rotate",o[o.Scale=2]="Scale"}(_||(_={}));class R extends S.Mesh{constructor(o,C={}){super(),this.events={changeStart:new D.v,change:new D.v,changeEnd:new D.v},this.onChangeStart=()=>{},this.onChange=()=>{},this.onChangeEnd=()=>{};let M={...R.defaultOptions,...C};this.xAxis=new F(M.xAxisColor,new S.Vector3(1,0,0),"translateX",M.interactionPriority),this.yAxis=new F(M.yAxisColor,new S.Vector3(0,1,0),"translateY",M.interactionPriority),this.zAxis=new F(M.zAxisColor,new S.Vector3(0,0,1),"translateZ",M.interactionPriority),this.yzArc=new O(M.xAxisColor,new S.Vector3(1,0,0),"rotateX",M.interactionPriority),this.xzArc=new O(M.yAxisColor,new S.Vector3(0,1,0),"rotateY",M.interactionPriority),this.xyArc=new O(M.zAxisColor,new S.Vector3(0,0,1),"rotateZ",M.interactionPriority),this.xAxis.material.depthTest=M.depthTest,this.yAxis.material.depthTest=M.depthTest,this.zAxis.material.depthTest=M.depthTest,this.yzArc.material.depthTest=M.depthTest,this.xzArc.material.depthTest=M.depthTest,this.xyArc.material.depthTest=M.depthTest;let{xAxis:_,yAxis:E,zAxis:P}=this,{xyArc:L,xzArc:I,yzArc:T}=this;I.rotateZ(Math.PI),L.rotateZ(-(.5*Math.PI)),M.translation&&(M.translationX&&this.add(_),M.translationY&&this.add(E),M.translationZ&&this.add(P)),M.rotation&&(M.rotationX&&this.add(T),M.rotationY&&this.add(I),M.rotationZ&&this.add(L));let V=new S.Vector3;_.onDragStart=E.onDragStart=P.onDragStart=C=>{V.copy(o.position),_.visible=C===_,E.visible=C===E,P.visible=C===P,L.visible=!1,I.visible=!1,T.visible=!1,this.events.changeStart.dispatch({targetObject:o,transform:{name:C.transformName,kind:0,axisWorldSpace:C.worldSpaceAxisRay.direction,magnitude:0}})},_.onDragUpdate=E.onDragUpdate=P.onDragUpdate=(C,M)=>{var _;let E;o.position.copy(V);let P=null===(_=o.parent)||void 0===_?void 0:_.getWorldQuaternion(new S.Quaternion).invert();E=P?M.clone().applyQuaternion(P):M,o.position.add(E),o.updateMatrix(),this.events.change.dispatch({targetObject:o,transform:{name:C.transformName,kind:0,axisWorldSpace:C.worldSpaceAxisRay.direction,magnitude:M.length()}})},_.onDragEnd=E.onDragEnd=P.onDragEnd=(C,M)=>{_.visible=!0,E.visible=!0,P.visible=!0,L.visible=!0,I.visible=!0,T.visible=!0,this.events.changeEnd.dispatch({targetObject:o,transform:{name:C.transformName,kind:0,axisWorldSpace:C.worldSpaceAxisRay.direction,magnitude:M.length()}})};let N=new S.Quaternion;L.onDragStart=I.onDragStart=T.onDragStart=C=>{V.copy(o.position),N.copy(o.quaternion),L.visible=C===L,I.visible=C===I,T.visible=C===T,_.visible=!1,E.visible=!1,P.visible=!1,this.events.changeStart.dispatch({targetObject:o,transform:{name:C.transformName,kind:1,axisWorldSpace:C.rotationPlaneWorldSpace.normal,magnitude:0}})},L.onDragUpdate=I.onDragUpdate=T.onDragUpdate=(C,_)=>{if(o.position.copy(V),o.quaternion.copy(N),M.pivotAroundGizmo){let C=o.getWorldPosition(new S.Vector3),M=this.getWorldPosition(new S.Vector3),E=C.clone().sub(M).applyQuaternion(_).add(M);o.parent?o.position.copy(o.parent.worldToLocal(E)):o.position.copy(E)}if(o.parent){let C=o.getWorldQuaternion(new S.Quaternion).clone().premultiply(_),M=o.parent.getWorldQuaternion(new S.Quaternion).invert();o.quaternion.copy(C).premultiply(M)}else o.quaternion.premultiply(_);o.updateMatrix(),this.events.change.dispatch({targetObject:o,transform:{name:C.transformName,kind:1,axisWorldSpace:C.rotationPlaneWorldSpace.normal,magnitude:2*Math.acos(_.w)}})},L.onDragEnd=I.onDragEnd=T.onDragEnd=(C,M)=>{L.visible=!0,I.visible=!0,T.visible=!0,_.visible=!0,E.visible=!0,P.visible=!0,this.events.changeEnd.dispatch({targetObject:o,transform:{name:C.transformName,kind:1,axisWorldSpace:C.rotationPlaneWorldSpace.normal,magnitude:2*Math.acos(M.w)}})},this.events.change.addListener(o=>this.onChange(o.targetObject,o.transform)),this.events.changeStart.addListener(o=>this.onChangeStart(o.targetObject,o.transform)),this.events.changeEnd.addListener(o=>this.onChangeEnd(o.targetObject,o.transform));let H=M.viewIndependentSize;if(null!=H&&!1!==H){this.frustumCulled=!1,this.renderOrder=-1/0;let o=new S.Vector3,C=new S.Vector3;this.onBeforeRender=(M,_,S)=>{o.setFromMatrixPosition(S.matrixWorld),C.setFromMatrixPosition(this.matrixWorld);let E=o.distanceTo(C);this.scale.setScalar(.4*H*E),this.updateWorldMatrix(!1,!0)}}}}R.defaultOptions={pivotAroundGizmo:!0,viewIndependentSize:void 0,rotation:!0,rotationX:!0,rotationY:!0,rotationZ:!0,translation:!0,translationX:!0,translationY:!0,translationZ:!0,xAxisColor:16719968,yAxisColor:2154368,zAxisColor:2130175,depthTest:!0,interactionPriority:10};class V extends S.Mesh{get selected(){return this._selected}set selected(o){o&&!this._selected?this.events.onSelectStart.dispatch(void 0):!o&&this._selected&&this.events.onSelectEnd.dispatch(void 0),this._selected=o}get hovered(){return this._hovered}set hovered(o){o&&!this._hovered?this.events.onHoverStart.dispatch(void 0):!o&&this._hovered&&this.events.onHoverEnd.dispatch(void 0),this._hovered=o}handleDragStart(o){}handleDragUpdate(o){}handleDragEnd(o){}constructor(o,C,M,_){super(C,new S.MeshBasicMaterial({color:o})),this.animator=new P.L,this.baseColor=new S.Color,this._selected=!1,this._hovered=!1,this.events={onHoverStart:new D.v,onHoverEnd:new D.v,onSelectStart:new D.v,onSelectEnd:new D.v},this.selectionLerp=0,this.onBeforeRender=(o,C,M)=>{let _=this.hovered||this.selected?1:0;this.animator.springTo(this,"selectionLerp",_,T),this.animator.tick(),this.material.color.lerpColors(this.baseColor,this.hoverColor,this.selectionLerp),this.outline.material.opacity=this.selectionLerp},this.outline=new S.Mesh(M,new S.MeshBasicMaterial({color:new S.Color(o).offsetHSL(0,0,0),transparent:!0,opacity:0,depthTest:!0,depthWrite:!1,side:S.BackSide})),this.add(this.outline),this.baseColor.set(o),this.hoverColor=new S.Color(o).offsetHSL(0,.1,.35).multiplyScalar(4),(0,I.x)(this,{sortPriority:_,cursor:"pointer",occludePointerEvents:!0,capturePointer:!0,onPointerOver:()=>this.hovered=!0,onPointerOut:()=>this.hovered=!1,onPointerDown:(o,C)=>1===o.buttons&&(o.preventDefault(),o.stopPropagation(),this.selected=!0,this.handleDragStart(C),!0),onPointerMove:(o,C,M)=>{C&&(o.preventDefault(),o.stopPropagation(),this.handleDragUpdate(M))},onPointerUp:(o,C,M)=>{C&&(o.preventDefault(),o.stopPropagation(),this.selected=!1,this.handleDragEnd(M))}})}}class F extends V{handleDragStart(o){this.updateWorldMatrix(!0,!1),this.worldSpaceAxisRay.origin.setFromMatrixPosition(this.matrixWorld),this.worldSpaceAxisRay.direction.setFromMatrixColumn(this.matrixWorld,0),this.pDragStart=W(o.ray,this.worldSpaceAxisRay),this.onDragStart(this)}handleDragUpdate(o){this.onDragUpdate(this,this.getDragDelta(o))}handleDragEnd(o){this.onDragEnd(this,this.getDragDelta(o))}getDragDelta(o){let C=W(o.ray,this.worldSpaceAxisRay)-this.pDragStart;return this.worldSpaceAxisRay.direction.clone().multiplyScalar(C)}constructor(o,C=new S.Vector3(1,0,0),M,_){let E=.035,P=.07,D=1;super(o,X("arrowGeometry",()=>Q(E,P,D)),X("arrowOutlineGeometry",()=>Q(E+.01,P+.01,D+.1)),_),this.onDragStart=()=>{},this.onDragUpdate=()=>{},this.onDragEnd=()=>{},this.transformKind=0,this.pDragStart=NaN,this.worldSpaceAxisRay=new S.Ray,this.transformName=M,this.quaternion.setFromUnitVectors(new S.Vector3(1,0,0),C)}}class O extends V{handleDragStart(o){this.updateWorldMatrix(!0,!1),this.inverseWorldMatrixStart.copy(this.matrixWorld).invert(),this.worldPosition.setFromMatrixPosition(this.matrixWorld),this.rotationPlaneWorldSpace.set(new S.Vector3(0,0,1),0).applyMatrix4(this.matrixWorld),o.ray.intersectPlane(this.rotationPlaneWorldSpace,this.pDragStart),this.pDragStart.sub(this.worldPosition),this.pDragStart.normalize(),this.onDragStart(this)}handleDragUpdate(o){this.onDragUpdate(this,this.getDragDelta(o))}handleDragEnd(o){this.onDragEnd(this,this.getDragDelta(o))}getDragDelta(o){return o.ray.intersectPlane(this.rotationPlaneWorldSpace,this.pDrag),this.pDrag.sub(this.worldPosition),this.pDrag.normalize(),new S.Quaternion().setFromUnitVectors(this.pDragStart,this.pDrag)}constructor(o,C=new S.Vector3(1,0,0),M,_){let E=1,P=1.2;super(o,X("arcGeometry",()=>{let o=new S.TorusGeometry(E,.09,32,32,.5*Math.PI-P);return o.rotateZ(.5*P),o.rotateZ(.5*Math.PI),o.scale(1,1,.05),o}),X("arcOutlineGeometry",()=>new S.TorusGeometry(E,(.035+.01)*.2,32,128,2*Math.PI)),_),this.onDragStart=()=>{},this.onDragUpdate=()=>{},this.onDragEnd=()=>{},this.rotationPlaneWorldSpace=new S.Plane,this.pDragStart=new S.Vector3,this.worldPosition=new S.Vector3,this.inverseWorldMatrixStart=new S.Matrix4,this.pDrag=new S.Vector3,this.transformName=M,this.axis=C,this.quaternion.setFromUnitVectors(new S.Vector3(0,0,1),C)}}let N=new S.Vector3,H=new S.Vector3,U=new S.Vector3,G=new S.Vector3,W=(o,C)=>{let M=N.copy(o.direction).cross(C.direction),_=H.copy(o.direction).cross(M).normalize(),S=U.copy(C.direction).normalize();return G.copy(o.origin).sub(C.origin).dot(_)/S.dot(_)},K={};function X(o,C){return void 0===K[o]&&(K[o]=C()),K[o]}function Q(o,C,M){let _=.15*M,P=new S.CylinderGeometry(o,o,M,32);P.translate(0,.5,0);let D=new S.ConeGeometry(C,_,32);D.translate(0,1+.5*_,0);let L=(0,E.n4)([P,D]);return L.rotateZ(-Math.PI/2),L}},61555:function(o,C,M){"use strict";var _,S,E;M.d(C,{IJ:function(){return E},XG:function(){return _}}),M(53961),function(o){o.VIDEO="video",o.SLF="slf",o.LF="lf",o.SPLATS="sparkles"}(_||(_={})),function(o){o.VIDEO="video",o.SLF="slf",o.LF="lf",o.SLF_BG="slf-bg",o.SPLATS="sparkles"}(S||(S={})),function(o){o.select="select",o.metadata="metadata",o.uploading="uploading",o.error="error"}(E||(E={}))},62704:function(o,C,M){"use strict";M.d(C,{pn:function(){return S}}),M(5833),M(57224),M(17253);var _=M(53961);M(42066),M(76464),M(35770),M(56764),M(13485),M(21228),M(61555),M(81423),M(76961),M(16034),M(38386),M(54925),M(97961),M(95145),M(67430),M(94770),M(12837);let S=(0,_.createContext)({uuid:""})},97961:function(o,C,M){"use strict";var _=M(5833),S=M(56581);let E=o=>(0,_.jsx)(S.zx,{height:"34px",width:"fit-content",rounded:"full",px:4,py:2,fontSize:"16px",fontWeight:"normal",...o});C.Z=E},46941:function(o,C,M){"use strict";M.r(C),M.d(C,{DownloadVideoModal:function(){return Y},default:function(){return J}});var _=M(5833),S=M(27486),E=M(31552),P=M(37139),D=M(73159),L=M(62020),I=M(56581),T=M(57224),R=M(17794),V=M.n(R),F=M(15835),O=M.n(F),N=M(53961),H=M(81423),U=M(10007),G=M(38386),W=o=>{let{poster:C,video:M,style:S}=o,[E,P]=(0,N.useState)(!1),D=(0,N.useRef)(null);return(0,N.useEffect)(()=>{!(0,G.G6)()&&D.current&&(E?D.current.play():(D.current.currentTime=0,D.current.pause()))},[E,D.current]),(0,_.jsx)("video",{ref:D,loop:!0,muted:!0,playsInline:!0,poster:C,src:M,style:S,height:"auto",width:"auto",onMouseEnter:()=>P(!0),onMouseLeave:()=>P(!1)})},K=M(54925),X=M(97961),Q=M(49599),Z=M(63722);function Y(o){let{videoSrc:C,depthImagesSrc:M,color:E,bgColor:D,poster:R,slug:F,...N}=o;return(0,_.jsxs)(L.u_,{...N,size:"6xl",motionPreset:"scale",children:[(0,_.jsx)(L.ZA,{}),(0,_.jsxs)(L.hz,{border:"1px solid rgba(255,255,255,0.2)",rounded:"8px",color:E,bgColor:D,children:[(0,_.jsx)(L.xB,{textAlign:"center",children:"preview"}),(0,_.jsx)(L.ol,{}),(0,_.jsx)(L.fe,{children:(0,_.jsx)(P.M5,{width:"auto",height:"auto",children:(0,_.jsx)("video",{style:{width:"auto",maxWidth:"100%",height:"auto",maxHeight:"70vh",objectFit:"contain",borderRadius:8},src:C,autoPlay:!0,playsInline:!0,loop:!0,muted:!0,controls:!0,poster:R})})}),(0,_.jsx)(L.mz,{justifyContent:"center",children:(0,_.jsxs)(P.Ug,{children:[(0,_.jsx)(I.zx,{leftIcon:(0,_.jsx)(T._8t,{}),rounded:"full",onClick:()=>{(0,G.Sv)(C)},children:"video"}),null!=M&&(0,_.jsx)(I.zx,{leftIcon:(0,_.jsx)(T._8t,{}),rounded:"full",onClick:()=>{(0,G.Sv)(M)},children:"depth images"}),!V()(F)&&(0,_.jsx)(O(),{href:"/editor/".concat(F),target:"_blank",rel:"noreferrer",children:(0,_.jsx)(I.zx,{leftIcon:(0,_.jsx)(S.dY,{}),rounded:"full",children:"editor"})})]})})]})]})}var J=o=>{let{uuid:C,onClick:M,defaultCinematicVideo:S,defaultCinematicVideoPreiview:L}=o,[I,R]=(0,N.useState)([]),[V,F]=(0,N.useState)(!1),[O,J]=(0,N.useState)(!1);(0,N.useEffect)(()=>{try{(async()=>{if(J(!0),!C){J(!1);return}let{response:o,isMoreAvailable:M}=await (0,K.q$)(C);if(!o||"boolean"!=typeof M)throw"Could not get renders for capture ".concat(C);S&&L&&(o=[{uuid:(0,Q.Z)(),type:U.KM.video,status:U.CA.finished,date:"",capture:{uuid:""},user:{uuid:"",username:""},artifacts:[{type:"video",url:S},{type:"video_preview",url:L}]},...o]),R(o),F(M),J(!1)})()}catch(o){J(!1),console.error(o)}},[]);let[$,ee]=(0,N.useState)(void 0),[et,er]=(0,N.useState)(void 0),{isOpen:ei,onOpen:ea,onClose:eo}=(0,E.qY)(),es=I.filter(o=>"dispatched"===o.status),eu="white",ec="black",ed="white",eh="black",em=!!M;return(0,_.jsxs)(_.Fragment,{children:[!em&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(P.xv,{fontSize:"20px",children:[(0,_.jsx)("b",{children:"Video Renders"})," ",(0,_.jsx)(P.xv,{fontSize:"16px",display:"inline",children:0!==es.length?"(".concat(es.length," in queue)"):""})]}),(0,_.jsx)(P.iz,{mt:H.gc/4})]}),(0,_.jsx)(P.xu,{width:"100%",overflowX:"scroll",whiteSpace:"nowrap",py:em?H.gc/4:H.gc/2,children:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(P.xu,{rounded:"8px",mr:H.gc/2,display:em?"none":"inline-block",width:"140px",height:"200px",background:"linear-gradient(180deg, #AB47BC, #7B1FA2)",position:"relative",transform:"auto",translateY:0,overflow:"hidden",cursor:"pointer",onClick:()=>{window.open("/capture/".concat(C,"?mode=slf&reshoot=true"),"_blank")},children:(0,_.jsxs)(P.M5,{width:"100%",height:"100%",flexDirection:"column",children:[(0,_.jsx)(Z.Z,{size:"28px"}),(0,_.jsx)(P.xv,{children:" new render"})]})}),I.map((o,C)=>{var S;let E=null!==(S=null==o?void 0:o.artifacts)&&void 0!==S?S:[],D=(0,G.gk)("video_preview",E),L=(0,G.gk)("video",E),I=(0,G.gk)("video_depth_images",E),R=!!D&&!!L;return R?(0,_.jsx)(P.xu,{rounded:"8px",mr:H.gc/2,display:"inline-block",width:em?150:"auto",height:em?150:"auto",position:"relative",transform:"auto",translateY:0,overflow:"hidden",cursor:"zoom-in",onClick:()=>{em?M(L):(ea(),ee(L),er(I))},children:R&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(W,{poster:D,video:L,style:em?{width:"100%",height:"100%",objectFit:"cover"}:{maxWidth:250,maxHeight:200}},String(C+D+L+"video")),!em&&(0,_.jsxs)(P.Ug,{position:"absolute",left:2,bottom:2,spacing:2.5,children:[(0,_.jsx)(P.M5,{onClick:o=>{o.preventDefault(),o.stopPropagation(),(0,G.Sv)(L)},cursor:"pointer",color:eu,bgColor:ec,rounded:"16px",children:(0,_.jsx)(T.Odl,{style:{backdropFilter:"blur(5px)",margin:"8px"}})}),I&&(0,_.jsx)(P.M5,{onClick:o=>{o.preventDefault(),o.stopPropagation(),(0,G.Sv)(I)},cursor:"pointer",color:eu,bgColor:ec,rounded:"16px",children:(0,_.jsx)(T.XBm,{style:{backdropFilter:"blur(5px)",margin:"8px"}})})]})]})},String(C+D+L+I)):(0,_.jsx)(_.Fragment,{})}),0===I.length&&O&&(0,_.jsx)(P.xu,{rounded:"8px",mr:H.gc/2,display:em?"none":"inline-block",width:"140px",height:"200px",background:"#111111",position:"relative",transform:"auto",translateY:0,overflow:"hidden",children:(0,_.jsx)(P.M5,{width:"100%",height:"100%",flexDirection:"column",children:(0,_.jsx)(D.$,{m:H.gc/2})})}),V&&(0,_.jsx)(P.xu,{rounded:"8px",mr:H.gc/2,display:"inline-block",width:em?150:"auto",height:em?150:"auto",position:"relative",transform:"auto",translateY:0,overflow:"hidden",cursor:"zoom-in",onClick:()=>{try{(async()=>{if(J(!0),!C){J(!1);return}let{response:o,isMoreAvailable:M}=await (0,K.q$)(C,{skip:I.length});if(!o||"boolean"!=typeof M)throw"Could not get renders for capture ".concat(C);R([...I,...o]),F(M),J(!1)})()}catch(o){J(!1),console.error(o)}},children:(0,_.jsxs)(X.Z,{disabled:O,children:["show more",O&&(0,_.jsx)(D.$,{ml:H.gc/4,size:"sm"})]})})]})}),(0,_.jsx)(Y,{onClose:()=>{eo(),er(void 0),ee(void 0)},isOpen:ei&&!!$,isCentered:!0,color:ed,bgColor:eh,videoSrc:$,depthImagesSrc:et})]})}},75799:function(o,C,M){"use strict";var _;M(5833),M(57224),M(81423),M(76961),M(97961),M(53961),M(61555),M(10007),M(54925),function(o){o.bottomLeft="bottomLeft",o.bottomRight="bottomRight",o.topRight="topRight",o.topLeft="topLeft",o.center="center"}(_||(_={})),M(17794),M(38386),M(42066),new AbortController},81423:function(o,C,M){"use strict";M.d(C,{$1:function(){return U},$o:function(){return K},DF:function(){return G},EK:function(){return N},FH:function(){return _},HU:function(){return Q},Jw:function(){return W},N0:function(){return V},NE:function(){return F},O9:function(){return S},OJ:function(){return L},U_:function(){return I},Xs:function(){return R},fg:function(){return H},gc:function(){return E},mQ:function(){return P},nD:function(){return X},pS:function(){return D},uJ:function(){return T},xz:function(){return O}});let _="https://lumalabs.ai",S={bg:"#0a0a0a",text:"white",bgHalfWhite:"rgba(255,255,255,0.9)",bgHalfBlack:"rgba(0,0,0,0.9)",bgFor3d:"lightblue"},E=8,P="lumalabsai-internal-user",D="captures.lumalabs.ai-authStore",L="captures.lumalabs.ai-authStore-time-stamp",I="captures.lumalabs.ai-authStore-return-to-url",T="https://webapp.engineeringlumalabs.com",R=1,V="captures.lumalabs.ai-open-tutorial-3d",F=3,O=30,N="https://apps.apple.com/us/app/luma-flythroughs/id6450376609?ppid=da350f7c-5f2d-4e96-a41b-b9b05c14f303",H="mailto:hello+flythroughs@lumalabs.ai",U={src:"https://cdn-luma.com/public/lumalabs.ai/flythroughs/14-aug/new%20hero.mp4",poster:"https://cdn-luma.com/public/lumalabs.ai/flythroughs/14-aug/new%20hero%20optimized.png"},G="https://cdn-luma.com/public/lumalabs.ai/flythroughs/14-aug/dark-plain.png",W={boxShadow:"1px 4px 10px rgba(0, 0, 0, 0.25)"},K="https://cdn-luma.com/public/captures.lumalabs.ai/images/logo.svg",X="LUMA_AI_GENIE_PROMPT",Q="https://apps.apple.com/in/app/luma-ai/id1615849914"},10007:function(o,C,M){"use strict";var _,S,E,P,D,L,I,T,R,V,F,O,N,H,U,G,W;M.d(C,{CA:function(){return G},KM:function(){return R},cB:function(){return V},mS:function(){return S}}),function(o){o.OPENCV="OPENCV",o.OPENCV_FISHEYE="OPENCV_FISHEYE",o.PINHOLE="PINHOLE",o.SIMPLE_PINHOLE="SIMPLE_PINHOLE",o.RADIAL="RADIAL",o.SIMPLE_RADIAL="SIMPLE_RADIAL",o.EQUIRECTANGULAR="EQUIRECTANGULAR"}(_||(_={})),function(o){o.Uploaded="uploaded",o.GuidedObjectLoop="GuidedObjectLoop",o.Freeform="Freeform",o.Flythrough="Flythrough",o.UploadedMobileiOS="UploadedMobileiOS",o.UploadedExternal="UploadedExternal",o.Generation="generation",o.DataCollectionApp="DataCollectionApp"}(S||(S={})),function(o){o.imagine3d="imagine3d",o.captures="captures"}(E||(E={})),function(o){o.sfm="Preprocessing",o.sfm_done="Preprocessing Complete",o.nerf="Training NeRF",o.discretize_samples="Generating",o.mesh="Generating Meshes",o.render="Rendering Video",o.failed="Failed",o.done="Done",o.partial_failure="Partial Failure"}(P||(P={})),function(o){o.open="open",o.public="public",o.unlisted="unlisted",o.private="private"}(D||(D={})),function(o){o.new="new",o.uploadingData="uploading",o.complete="complete"}(L||(L={})),function(o){o.dispatched="dispatched",o.new="new",o.failed="failed",o.finished="finished"}(I||(I={})),function(o){o.ASCENDING="ASC",o.DESCENDING="DESC"}(T||(T={})),function(o){o.video="video",o.PhotoStudioSixAxis="ps-six-axis"}(R||(R={})),function(o){o.capture="capture",o.render="render"}(V||(V={})),function(o){o.success="success",o.error="error"}(F||(F={})),function(o){o.uploading="Uploading",o.upload_complete="Upload Complete",o.upload_failed="Upload failed",o.queued="Queued",o.sfm="Preprocessing",o.sfm_done="Preprocessing Complete",o.nerf="Training NeRF",o.discretize_samples="Generating",o.mesh="Generating Meshes",o.render="Rendering Video",o.failed="Failed",o.done="Finished",o.partial_failure="Partial Failure"}(O||(O={})),function(o){o.normal="normal",o.fisheye="fisheye",o.equirectangular="equirectangular"}(N||(N={})),function(o){o.OrbitSpline="OrbitSpline",o.Spline="Spline",o.Linear="Linear"}(H||(H={})),function(o){o.Cinematic="cinematic",o.Drone="drone",o.Handheld="handheld",o.Orbit="orbit",o.Oscillate="oscillate",o.DollyZoom="dollyZoom",o.Recorded="recorded"}(U||(U={})),function(o){o.dispatched="dispatched",o.new="new",o.failed="failed",o.finished="finished"}(G||(G={})),function(o){o.captureDate="captureDate",o.uploadedDate="creationDate"}(W||(W={}))},76961:function(o,C,M){"use strict";M.d(C,{Mz:function(){return V},d8:function(){return T},store:function(){return I}});var _=M(24064);let S=[{title:"Create",code:"import requests\n\ncapture_title = \"My Capture Title Here\"\nauth_headers = {'Authorization': 'luma-api-key={key}'}\n\nresponse = requests.post(\"https://webapp.engineeringlumalabs.com/api/v2/capture\",\n                         headers=auth_headers,\n                         data={'title': capture_title})\ncapture_data = response.json()\nupload_url = capture_data['signedUrls']['source']\nslug = capture_data['capture']['slug']\n\nprint(capture_data)\nprint(\"Upload URL:\", upload_url)\nprint(\"Capture slug:\", slug)",content:"The first step is to create a capture. Be sure to pass a title. This will return a slug that you can use to upload your files. It will also return a storage bucket that you can use to upload your files & the capture object."},{title:"Upload",code:"with open(\"my_video_or_zip\", \"rb\") as f:\n    payload = f.read()\n\n# upload_url from step (1)\nresponse = requests.put(upload_url, headers={'Content-Type': 'text/plain'}, data=payload)\n\n# Note: the payload should be bytes containing the file contents (as shown above)!\n# A common pitfall is uploading the file name as the file contents\n\nprint(response.text)",content:"Once you have created a capture, you can upload your files. You will need to upload the files to the storage bucket that is returned in the create step. You can upload video or images zip. Note: One can upload a max size of 5GB."},{title:"Trigger",code:"# slug from Capture step\n\nauth_headers = {'Authorization': 'luma-api-key={key}'}\nresponse = requests.post(f\"https://webapp.engineeringlumalabs.com/api/v2/capture/{slug}\",\n                         headers=auth_headers)\n\nprint(response.text)",content:"Once you have uploaded your files, you can trigger the capture to be processed. It will return true if the capture was successfully triggered."},{title:"Check and Download",code:"# slug from Capture step\n\nauth_headers = {'Authorization': 'luma-api-key={key}'}\nresponse = requests.get(f\"https://webapp.engineeringlumalabs.com/api/v2/capture/{slug}\",\n                        headers=auth_headers)\n\nprint(response.text)",content:"You can check the status of your capture by calling the capture endpoint. You can also download the capture by calling the download endpoint."}];var E=M(81423),P=M(10007),D=M(61555);let L={capture:void 0,userLimits:void 0,featuredCapturesGallery:[],featuredCapturesGalleryHasRemaining:!1,featuredCapturesGalleryLoading:!1,userCapturesGallery:[],userCapturesGalleryHasRemaining:!1,userCapturesGalleryLoading:!1,userSearchCapturesGallery:[],userSearchCapturesGalleryHasRemaining:!1,searchText:"",currentSearchText:"",userRendersGallery:[],userRendersGalleryHasRemaining:!1,userRendersGalleryLoading:!1,userSearchRendersGallery:[],userSearchRendersGalleryHasRemaining:!1,userRendersSearchText:"",userRendersSearchTextCurrent:"",internalUser:null,captures:[],capturesRemainging:0,searchCaptures:[],searchCapturesRemainging:0,capturesLoading:!1,searchCapturesLoading:!1,uploads:[],uploadProgress:0,authStatus:void 0,showWelcomeScreen:void 0,current3dModel:void 0,current3dModelHovered:void 0,generatePrompt:"",generatePromptProcessing:!1,latestGallery:[],featuredGallery:[],userGallery:[],searchGallery:[],isTouchDevice:!1,currentTime:new Date,autoCheckRunning:!1,userGalleryRemaining:0,featuredGalleryRemaining:0,latestGalleryRemaining:0,searchGalleryRemaining:0,generationLimits:void 0,globalCanGenerateFromDB:void 0,shareMode:!1,shareModalData:void 0,shareModalUrl:"",initialMode:void 0,isOwn:!1,thumb:void 0,showImagineAuth:!1,renderRuns:[],renderRunsRemainging:0,renderRunsLoading:!1,renderRunsSearch:[],renderRunsSearchText:"",renderRunsSearchLoading:!1,renderRunsSearchRemainging:0,captureGridMode:P.cB.capture},I=(0,_.sj)(L),T={background:"#ffffff",color:"#000000",showTitle:!0,loadBg:!0,logoPosition:"bottom-left",infoPosition:"bottom-right",showMenu:!1},R={loggedIn:void 0,user:void 0},V=(0,_.sj)(R),F={credits:{remaining:0,used:0,total:0,singleCreditValueInUSD:E.Xs},keys:[],remainingKeys:0,purchases:[],purchasesRemainging:0,loading:!0,error:void 0,alpha:!1,currentCode:S[0]};(0,_.sj)(F);let O={phase:D.IJ.select,error:void 0,options:void 0,uploadingCaptureUuid:void 0,fileBlobUrl:void 0,progress:{percentage:0}};(0,_.sj)(O);let N={uuid:void 0,options:void 0};(0,_.sj)(N)},16034:function(o,C,M){"use strict";M.d(C,{hP:function(){return V},w7:function(){return R},x4:function(){return T}});var _,S,E=M(19646),P=M(81423),D=M(76961),L=M(38386);M(93867);var I=M(56531);M(17794),E.Z.defaults.baseURL=P.uJ,function(o){o.authenticated="authenticated",o.waitlisted="waitlisted",o.addedToWaitlist="addedToWaitlist",o.inviteCodeRequired="inviteCodeRequired",o.inviteCodeUsed="inviteCodeUsed",o.inviteCodeInvalid="inviteCodeInvalid",o.blocked="blocked",o.deleted="deleted",o.serverError="serverError"}(_||(_={})),function(o){o.NotOnWaitlist="not_on_waitlist",o.OnWaitlist="on_waitlist",o.OnAllowlist="on_allowlist",o.ExistingUser="existing_user",o.OnDenylist="on_denylist"}(S||(S={}));let T=o=>{(0,L.Cv)("Auth: login");let C=window.location.pathname.toString();(0,L.pj)(P.U_,C),new URL(window.location.href).searchParams.has("startTutorial")&&(0,L.pj)(P.N0,!0);let M=window.location.origin.includes("lumalabs.art")?"&destination=art":"";"apple"===o?window.open("https://webapp.engineeringlumalabs.com"+"/api/v2/auth/apple?client=web".concat(M),"_self"):"google"===o?window.open("https://webapp.engineeringlumalabs.com"+"/api/v2/auth/google?client=web".concat(M),"_self"):"discord"===o&&window.open("https://webapp.engineeringlumalabs.com"+"/api/v2/auth/discord?client=web".concat(M),"_self")},R=async()=>{D.store.internalUser=null,(0,L.pj)(P.mQ,void 0),(0,L.pj)(P.pS,void 0),(0,L.pj)(P.OJ,void 0),(0,I.kT)("accessToken"),(0,I.kT)("refreshToken")},V=async o=>new Promise((C,M)=>{navigator.locks.request("getAccessToken",{mode:"exclusive"},async()=>{try{(0,L.Cv)("Acquiring access token lock");let M=await F(o);(0,L.Cv)("Released access token lock"),C(M)}catch(o){M(o)}})}),F=async o=>{try{let C=(0,I.ej)("accessToken");if(C)return"Bearer ".concat(C);{let C=(0,I.ej)("refreshToken");if(C){let{accessToken:o}=await (0,I.Ov)(C);return"Bearer ".concat(o)}if(!0!==o)throw await R(),"Please log in again"}}catch(o){console.error("Error getting access token")}if(!0!==o)throw await R(),"Please log in again";return""}},56531:function(o,C,M){"use strict";M.d(C,{Ov:function(){return I},d8:function(){return P},ej:function(){return D},jl:function(){return R},kT:function(){return L}});var _=M(19646),S=M(16034),E=M(38386);function P(o,C){let M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_="".concat(encodeURIComponent(o),"=").concat(encodeURIComponent(C));if(M.expires){let o=M.expires instanceof Date?M.expires.toUTCString():M.expires;_+="; Expires=".concat(o)}M.path&&(_+="; Path=".concat(M.path)),M.domain&&(_+="; Domain=".concat(M.domain)),M.secure&&(_+="; Secure"),document.cookie=_}function D(o){for(let C of document.cookie.split(";")){let[M,_]=C.trim().split("=");if(decodeURIComponent(M)===o)return decodeURIComponent(_)}}function L(o){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};C.expires=new Date(0).toUTCString(),C.path="/",P(o,"",C)}let I=async o=>new Promise((C,M)=>{navigator.locks.request("exchangeToken",{mode:"exclusive"},async()=>{try{(0,E.Cv)("Acquiring token exchange lock");let M=await T(o);(0,E.Cv)("Released token exchange lock"),C(M)}catch(o){M(o)}})}),T=async o=>{try{let C=(await _.Z.post("/api/v2/auth/refresh",{refreshToken:o})).data,M=C.accessToken,S=C.refreshToken,E=C.accessTokenLifetimeDuration,D=C.refreshTokenLifetimeDuration,L=new Date(Date.now()),I=L.getTime()+1e3*E-5e3;L.setTime(I),P("accessToken",M,{expires:L.toUTCString(),secure:!0,path:"/"});let T=new Date(Date.now()),R=T.getTime()+1e3*D;return T.setTime(R),P("refreshToken",S,{expires:T.toUTCString(),secure:!0,path:"/"}),{accessToken:M,refreshToken:S}}catch(o){throw console.error("Error refreshing tokens"),console.error(o),await (0,S.w7)(),"Please log in again"}},R=()=>{let o=D("refreshToken");return!!o&&"string"==typeof o&&""!==o}},95145:function(o,C,M){"use strict";M.d(C,{b6:function(){return D},pt:function(){return P}});var _=M(19646);M(17794),M(23195),M(65237);var S=M(81423);M(10007),M(76961);var E=M(16034);M(38386),_.Z.defaults.baseURL=S.uJ;let P=async o=>{try{let{isAvaialble:C}=(await _.Z.get("/api/v2/users/username/".concat(o),{headers:{Authorization:await (0,E.hP)()}})).data;return C}catch(o){throw o}},D=async o=>(await _.Z.post("/api/v2/users/username/",{username:o},{headers:{Authorization:await (0,E.hP)()}})).data},38386:function(o,C,M){"use strict";M.d(C,{Iv:function(){return N},Cv:function(){return H},Sv:function(){return D},ac:function(){return X},Hy:function(){return L},gk:function(){return K},fp:function(){return I},ad:function(){return O},G6:function(){return V},b1:function(){return R},t:function(){return W},wY:function(){return U},pj:function(){return T},_v:function(){return P}}),M(17794);var _=M(19459);M(5833),M(83591),M(42066),M(53961),M(76464),M(20117),M(35770),M(76961),M(61555),M(12095),M(61572),M(67430),M(62704),M(65979);var S=M(81423);M(15835),S.HU,M(57224),M(95145),M(16034),M(75799),M(97961),M(10007),M(13485),M(46941),M(93867),M(54925),M(91863),S.gc,S.gc,S.gc,M(1082),new Date().toJSON().slice(0,10);var E=M(14446);let P=o=>new Promise(C=>{setTimeout(()=>{C()},o)}),D=o=>{try{window.open(o,"_self")}catch(o){throw"Error downloading file"}};function L(o,C){var M="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(o)),_=document.createElement("a");_.setAttribute("href",M),_.setAttribute("download",C+".json"),document.body.appendChild(_),_.click(),_.remove()}let I=o=>{try{let C=localStorage.getItem(o);if(C)return JSON.parse(C);return}catch(o){return}},T=(o,C)=>{try{let M=JSON.stringify(C);localStorage.setItem(o,M)}catch(o){throw"error parsing json"}},R=()=>{try{return window&&"ontouchstart"in window&&navigator&&navigator.maxTouchPoints>0}catch(o){return!1}},V=()=>{try{return!!navigator.userAgent&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}catch(o){return!1}},F=()=>!!navigator.userAgent&&/iPhone/.test(navigator.userAgent),O=()=>F()||V(),N=async o=>{try{await navigator.clipboard.writeText(o)}catch(o){console.error(o)}},H=(o,C)=>{"true"===E.env.NEXT_PUBLIC_DEV_LOGS&&console.log("%c%s %s","color: white; background: #0A0A0A; padding: 8px; font-size: 12px; border-radius: 4px;","[Dev Log]",void 0!==C?[o," "+JSON.stringify(C)]:[o])},U=o=>{var C,M,_,S,E,P,D,L,I,T,R,V,F;return"string"!=typeof(o=null!==(F=null!==(V=null!==(R=null!==(T=null!==(I=null!==(L=null!==(D=null==o?void 0:null===(M=o.response)||void 0===M?void 0:null===(C=M.data)||void 0===C?void 0:C.error)&&void 0!==D?D:null==o?void 0:null===(S=o.response)||void 0===S?void 0:null===(_=S.data)||void 0===_?void 0:_.reason)&&void 0!==L?L:null==o?void 0:null===(P=o.response)||void 0===P?void 0:null===(E=P.data)||void 0===E?void 0:E.payload)&&void 0!==I?I:null==o?void 0:o.error)&&void 0!==T?T:null==o?void 0:o.reason)&&void 0!==R?R:null==o?void 0:o.payload)&&void 0!==V?V:null==o?void 0:o.message)&&void 0!==F?F:o)&&(o=JSON.stringify(o)),o},G=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/,W=o=>G.test(o),K=(o,C)=>{var M;return null===(M=C.find(C=>C.type===o))||void 0===M?void 0:M.url},X=async(o,C,M)=>{if(V())window.open(o,"_blank");else try{let o=document.querySelector("model-viewer"),C=await o.exportScene(),_=new File([C],null!=M?M:"model.glb"),S=document.createElement("a");S.download=_.name,S.href=URL.createObjectURL(_),S.style.display="none",document.body.appendChild(S),S.click()}catch(C){window.open(o,"_blank")}(0,_.WA)(C)}},54925:function(o,C,M){"use strict";M.d(C,{BZ:function(){return O},Qc:function(){return L},an:function(){return V},q$:function(){return F}});var _=M(19646),S=M(10007),E=M(16034),P=M(76961),D=M(38386);M(65237),M(61555),M(75799);let L=async()=>{try{let o=await (0,E.hP)(),C=await _.Z.get("/api/v3/users/limits",{headers:{authorization:o}}),M=C.data.error;if(M)throw M;let S=C.data.response;P.store.userLimits=S}catch(o){throw console.error(o),P.store.userLimits=void 0,(0,D.wY)(o)}},I=async o=>{let C=await (0,E.hP)(),M=await _.Z.post("/api/v3/renders/trajectory",o,{headers:{authorization:C}}),S=M.data.error;if(S)throw S;let P=M.data.response;if(!P)throw"Error creating trajectory";return P},T=async(o,C)=>{let M=JSON.stringify(C),S=new TextEncoder().encode(M),E=new Blob([S],{type:"application/json;charset=utf-8"}),P=new File([E],"session.json");await _.Z.put(o,P)},R=async o=>{let C=await (0,E.hP)(),M=await _.Z.post("/api/v3/renders",o,{headers:{authorization:C}}),S=M.data.error;if(S)throw S;let P=M.data.response;if(!P)throw"Error creating render";return P},V=async(o,C)=>{try{let M=await I(o),_=M.url;await T(_,C);let S={uuid:M.uuid,...o};await R(S)}catch(o){throw(0,D.wY)(o)}},F=async(o,C)=>{try{let{skip:M,take:S,isOwner:P,order:D}=null!=C?C:{},L=await (0,E.hP)(),I=await _.Z.get("/api/v3/captures/".concat(o,"/renders"),{params:{skip:M,take:S,isOwner:P,order:D},headers:{authorization:L}}),T=I.data.error;if(T)throw T;if(!I.data.response)throw"Error getting renders";return I.data}catch(o){throw(0,D.wY)(o)}},O=async()=>{var o;let C=await _.Z.get("/api/v3/captures/featured",{params:{includes:S.mS.Flythrough}}),M=null==C?void 0:null===(o=C.data)||void 0===o?void 0:o.response;if(!M)throw"Error getting featured flythroughs";return M}},67430:function(o,C,M){"use strict";M.d(C,{D:function(){return _}});let _=(o,C)=>new Promise((_,S)=>{let E=new Worker(M.tu(new URL(M.p+M.u(8965),M.b))),P=o=>{let M=o.data;"string"==typeof M?(E.removeEventListener("message",P),_(M)):"number"==typeof M?null==C||C(M):"object"==typeof M&&M.error&&S(M.error)};E.addEventListener("message",P),E.postMessage(o)})},94770:function(o,C,M){"use strict";var _;M.d(C,{j:function(){return _},u:function(){return S}}),function(o){o[o.Always=0]="Always",o[o.OnUserChange=1]="OnUserChange"}(_||(_={}));class S{watch(o){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,M=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return this.callbacks.push({callback:o,filter:C}),M&&o(this._value,this._value),{unwatch:()=>this.unwatch(o)}}unwatch(o){let C=0;for(;C<this.callbacks.length&&this.callbacks[C].callback!==o;C++);this.callbacks.splice(C,1)}setValue(o,C){let M=this._value;this._value=o;for(let _=0;_<this.callbacks.length;_++)null!=C&&this.callbacks[_].filter!==C&&0!==this.callbacks[_].filter||this.callbacks[_].callback(o,M)}getValue(){return this._value}constructor(o){this.callbacks=[],this._value=o}}},93867:function(o,C,M){"use strict";var _=M(22179),S=M.n(_);class E{constructor(){this.initPromise=null,this.ensureInitialized=()=>(null==this.initPromise&&(this.initPromise=new Promise((o,C)=>{let M="5605fd5eb4a607ba5b575d93b8d63527";if("string"!=typeof M){o();return}S().init(M,{ignore_dnt:!0,autotrack:!0,api_host:"https://capybara.sandbox.labs.lumalabs.ai/",loaded:()=>{o()}})})),this.initPromise),this.identify=async o=>{await this.ensureInitialized(),S().identify(o)},this.ueName="Unreal Engine",this.ueImpression=()=>{try{S().track(this.ueName,{visited:!0})}catch(o){console.error("Error in ueImpression: ",o)}},this.uePlugin=()=>{S().track(this.ueName,{plugin:"download"})},this.ueFieldsFile=o=>{S().track(this.ueName,{fieldFile:o})},this.ueGaussianSplat=o=>{S().track(this.ueName,{splatFile:o})},this.ueFieldsFileReRun=o=>{S().track(this.ueName,{reRun:o})},this.ueLink=o=>{S().track(this.ueName,{slug:o})}}}new E},12837:function(o,C,M){"use strict";M.d(C,{A6:function(){return D},Dv:function(){return W},FO:function(){return I},Mv:function(){return F},NQ:function(){return G},Uw:function(){return X},_y:function(){return U},gr:function(){return V},h5:function(){return P},i6:function(){return R},mG:function(){return T},qf:function(){return H},sv:function(){return N}});var _=M(9781),S=M(21228),E=M(94770);let P={fov:60,near:.01,far:1e3},D=new E.u(!0),L=null,I=()=>L=null!=L?L:new Promise((o,C)=>{let M=setInterval(()=>{var C;(null===(C=window.luma)||void 0===C?void 0:C.options)!=null&&(clearInterval(M),o(window.luma))},5)});function T(o){let C=window.luma.camera.center,M=window.luma.camera.right,_=window.luma.camera.up,S=window.luma.camera.forward;return o.set(M[0],_[0],-S[0],C[0],-M[1],-_[1],S[1],-C[1],-M[2],-_[2],S[2],-C[2],0,0,0,1),o}function R(o){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _.Vector3;return C.set(o[0],-o[1],-o[2]),C}function V(o){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return C[0]=o.x,C[1]=-o.y,C[2]=-o.z,C}function F(o){let C=o.toArray();return C[1]*=-1,C[2]*=-1,C[5]*=-1,C[6]*=-1,C[8]*=-1,C[13]*=-1,C[14]*=-1,C}function O(o){let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _.Matrix4;return o[1]*=-1,o[2]*=-1,o[5]*=-1,o[6]*=-1,o[8]*=-1,o[13]*=-1,o[14]*=-1,C.fromArray(o),C}function N(o){o.fov=P.fov,o.near=P.near,o.far=P.far,o.parent=null,o.updateProjectionMatrix(),window.luma.camera.origin=[0,0,0],window.luma.camera.resetToModel(),H();let C=S.Or.getKeyframeFromLumaCamera(0,0);o.setFromKeyframe(C,!1)}function H(){window.luma.camera.azimuth_bounds_max=1/0,window.luma.camera.azimuth_bounds_min=-1/0,window.luma.camera.radius_bounds_max=1/0,window.luma.camera.radius_bounds_min=-1/0,window.luma.camera.elevation_bounds_max=1/0,window.luma.camera.elevation_bounds_min=-1/0}function U(o){null!=window.luma&&null!=window.luma.options&&(o=null!=o?o:new _.Box3(new _.Vector3(-1/0,-1/0,-1/0),new _.Vector3(1/0,1/0,1/0)),window.luma.options.crop_min=[o.min.x,-o.max.y,-o.max.z],window.luma.options.crop_max=[o.max.x,-o.min.y,-o.min.z])}function G(o){null!=window.luma&&null!=window.luma.options&&(null==o&&(o=new _.Matrix4),window.luma.options.model_transform=F(o.clone().scale(new _.Vector3(1,-1,1))))}function W(){return null==window.luma||null==window.luma.options?new _.Matrix4:O(window.luma.options.model_transform).scale(new _.Vector3(1,-1,1))}function K(o,C){let M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;if(null==o||null==C||o.length!==C.length)return!1;for(let _=0;_<o.length;_++)if(Math.abs(o[_]-C[_])>M)return!1;return!0}function X(o,C,M){Array.isArray(M)?K(M,o[C])||(o[C]=M):o[C]!==M&&(o[C]=M)}},71034:function(o){o.exports={video:"Video_video__m27h9"}},36882:function(o){o.exports={active:"Crop_active__fEwx7",slfEditorCanvas:"Crop_slfEditorCanvas__gHYiU"}},90883:function(o){o.exports={slfEditorCanvas:"CameraPaths_slfEditorCanvas__x2ppz"}},33901:function(o){o.exports={timelineContainer:"CurveMode_timelineContainer__csh5i",timelineAxis:"CurveMode_timelineAxis__V7QDG",axisTick:"CurveMode_axisTick__We8HB",active:"CurveMode_active__OGQas"}},7202:function(o){o.exports={frameGuideContainer:"FrameGuide_frameGuideContainer__b3kXw",frameGuide:"FrameGuide_frameGuide__6GsVC"}},17714:function(o){o.exports={keyframe:"KeyframeComponent_keyframe__liFxh",keyframeShape:"KeyframeComponent_keyframeShape__Bz8Va",selected:"KeyframeComponent_selected__InR95",dragging:"KeyframeComponent_dragging__F4_FO",keyframeIcon:"KeyframeComponent_keyframeIcon__xoBw8"}},45766:function(o){o.exports={bar:"ScrubBar_bar__OiiEz",barFill:"ScrubBar_barFill__j2bGj",handle:"ScrubBar_handle__IQndW",thin:"ScrubBar_thin__9y4A8",dragging:"ScrubBar_dragging__yAsbS",keyframeUI:"ScrubBar_keyframeUI__fsnST",keyframeButtons:"ScrubBar_keyframeButtons__ISYA3",keyframeIcon:"ScrubBar_keyframeIcon__IgYcx",keyboardShortcut:"ScrubBar_keyboardShortcut__1WpQz"}},84940:function(o){o.exports={imageContainer:"RenderThumbnail_imageContainer__Z8fhb",image:"RenderThumbnail_image__Kaahk",imageAnime:"RenderThumbnail_imageAnime__cOaMz",opacityAnimation:"RenderThumbnail_opacityAnimation__5_Iwf",videoContainer:"RenderThumbnail_videoContainer__H5zZv",link:"RenderThumbnail_link__A_i6C",masterContainer:"RenderThumbnail_masterContainer__yG7WC",text:"RenderThumbnail_text__c_qV8",download:"RenderThumbnail_download__uz56m"}},13800:function(o){o.exports={rendersMenu:"RendersMenu_rendersMenu__A9JLV",collapsed:"RendersMenu_collapsed__vnnWM",rendersMenuHeader:"RendersMenu_rendersMenuHeader__f9GbX",rendersList:"RendersMenu_rendersList__kHY5f","render-item":"RendersMenu_render-item__1ui73",videoContainer:"RendersMenu_videoContainer__tVkyn",videoPreview:"RendersMenu_videoPreview__B71jD"}},23363:function(o){o.exports={lockOverlay:"SelectionContextMenu_lockOverlay__QQB8r"}},37262:function(o){o.exports={focusButtons:"FocusButtons_focusButtons__WJea3"}},17886:function(o){o.exports={iconButton:"IconButtonV2_iconButton__ctr3L"}},28049:function(o){o.exports={inputNumber:"Input_inputNumber__dQOiT",numberInput:"Input_numberInput__GXFAx",inputXYZ:"Input_inputXYZ__w7OYr",inlineLabel:"Input_inlineLabel__78oCn",disabled:"Input_disabled___4axx",inputRadio:"Input_inputRadio__qVxR8",selected:"Input_selected__Q6pmD",units:"Input_units__rRE74",iconButtons:"Input_iconButtons__EmeFH",iconButton:"Input_iconButton__jkp9W",icon:"Input_icon__TtEAW",label:"Input_label__DHA13"}},96487:function(o){o.exports={menu:"Menu_menu__tsnW2",collapsed:"Menu_collapsed__EX7oL",sectionContent:"Menu_sectionContent__7TIwz",clearMenu:"Menu_clearMenu__qRama",inputRow:"Menu_inputRow__SkvVt"}},30295:function(o){o.exports={pageTabs:"PageTabs_pageTabs__qku1P"}},33677:function(o){o.exports={icon:"slug_icon__ggbyr",adaptiveWidth:"slug_adaptiveWidth__XcM19",selected:"slug_selected__1xmFd",noFill:"slug_noFill__UoGkA",topRight:"slug_topRight__7s8AW",topLeft:"slug_topLeft__A8QzW",infoView:"slug_infoView__q3KKH",infoViewAlert:"slug_infoViewAlert__NP0wY",menu:"slug_menu__tz_t5",menuIcon:"slug_menuIcon__uoEHt",active:"slug_active__xc1Xl",infoIcon:"slug_infoIcon__3VX3D",infoModal:"slug_infoModal__sPsTP",infoModalFadeIn:"slug_infoModalFadeIn__LyAdt"}}}]);